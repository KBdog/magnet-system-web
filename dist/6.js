((typeof self !== 'undefined' ? self : this)["webpackJsonp"] = (typeof self !== 'undefined' ? self : this)["webpackJsonp"] || []).push([[6],{

/***/ "./node_modules/css-loader/index.js?!./node_modules/postcss-loader/src/index.js?!./node_modules/viewerjs/dist/viewer.css":
/*!***********************************************************************************************************************************************!*\
  !*** ./node_modules/css-loader??ref--6-oneOf-3-1!./node_modules/postcss-loader/src??ref--6-oneOf-3-2!./node_modules/viewerjs/dist/viewer.css ***!
  \***********************************************************************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("exports = module.exports = __webpack_require__(/*! ../../css-loader/lib/css-base.js */ \"./node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.i, \"/*!\\n * Viewer.js v1.9.0\\n * https://fengyuanchen.github.io/viewerjs\\n *\\n * Copyright 2015-present Chen Fengyuan\\n * Released under the MIT license\\n *\\n * Date: 2020-12-06T11:25:10.724Z\\n */\\n\\n.viewer-zoom-in::before,\\n.viewer-zoom-out::before,\\n.viewer-one-to-one::before,\\n.viewer-reset::before,\\n.viewer-prev::before,\\n.viewer-play::before,\\n.viewer-next::before,\\n.viewer-rotate-left::before,\\n.viewer-rotate-right::before,\\n.viewer-flip-horizontal::before,\\n.viewer-flip-vertical::before,\\n.viewer-fullscreen::before,\\n.viewer-fullscreen-exit::before,\\n.viewer-close::before {\\n  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAARgAAAAUCAYAAABWOyJDAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAABx0RVh0U29mdHdhcmUAQWRvYmUgRmlyZXdvcmtzIENTNui8sowAAAQPSURBVHic7Zs/iFxVFMa/0U2UaJGksUgnIVhYxVhpjDbZCBmLdAYECxsRFBTUamcXUiSNncgKQbSxsxH8gzAP3FU2jY0kKKJNiiiIghFlccnP4p3nPCdv3p9778vsLOcHB2bfveeb7955c3jvvNkBIMdxnD64a94GHMfZu3iBcRynN7zAOI7TG15gHCeeNUkr8zaxG2lbYDYsdgMbktBsP03jdQwljSXdtBhLOmtjowC9Mg9L+knSlcD8TNKpSA9lBpK2JF2VdDSR5n5J64m0qli399hNFMUlpshQii5jbXTbHGviB0nLNeNDSd9VO4A2UdB2fp+x0eCnaXxWXGA2X0au/3HgN9P4LFCjIANOJdrLr0zzZ+BEpNYDwKbpnQMeAw4m8HjQtM6Z9qa917zPQwFr3M5KgA6J5rTJCdFZJj9/lyvGhsDvwFNVuV2MhhjrK6b9bFiE+j1r87eBl4HDwCF7/U/k+ofAX5b/EXBv5JoLMuILzf3Ap6Z3EzgdqHMCuF7hcQf4HDgeoHnccncqdK/TvSDWffFXI/exICY/xZyqc6XLWF1UFZna4gJ7q8BsRvgd2/xXpo6P+D9dfT7PpECtA3cnWPM0GXGFZh/wgWltA+cDNC7X+AP4GzjZQe+k5dRxuYPeiuXU7e1qwLpDz7dFjXKRaSwuMLvAlG8zZlG+YmiK1HoFqT7wP2z+4Q45TfEGcMt01xLoNZEBTwRqD4BLpnMLeC1A41UmVxsXgXeBayV/Wx20rpTyrpnWRft7p6O/FdqzGrDukPNtkaMoMo3FBdBSQMOnYBCReyf05s126fU9ytfX98+mY54Kxnp7S9K3kj6U9KYdG0h6UdLbkh7poFXMfUnSOyVvL0h6VtIXHbS6nOP+s/Zm9mvyXW1uuC9ohZ72E9uDmXWLJOB1GxsH+DxPftsB8B6wlGDN02TAkxG6+4D3TWsbeC5CS8CDFce+AW500LhhOW2020TRjK3b21HEmgti9m0RonxbdMZeVzV+/4tF3cBpP7E9mKHNL5q8h5g0eYsCMQz0epq8gQrwMXAgcs0FGXGFRcB9wCemF9PkbYqM/Bas7fxLwNeJPdTdpo4itQti8lPMqTpXuozVRVXPpbHI3KkNTB1NfkL81j2mvhDp91HgV9MKuRIqrykj3WPq4rHyL+axj8/qGPmTqi6F9YDlHOvJU6oYcTsh/TYSzWmTE6JT19CtLTJt32D6CmHe0eQn1O8z5AXgT4sx4Vcu0/EQecMydB8z0hUWkTd2t4CrwNEePqMBcAR4mrBbwyXLPWJa8zrXmmLEhNBmfpkuY2102xxrih+pb+ieAb6vGhuA97UcJ5KR8gZ77K+99xxeYBzH6Q3/Z0fHcXrDC4zjOL3hBcZxnN74F+zlvXFWXF9PAAAAAElFTkSuQmCC');\\n  background-repeat: no-repeat;\\n  background-size: 280px;\\n  color: transparent;\\n  display: block;\\n  font-size: 0;\\n  height: 20px;\\n  line-height: 0;\\n  width: 20px;\\n}\\n\\n.viewer-zoom-in::before {\\n  background-position: 0 0;\\n  content: 'Zoom In';\\n}\\n\\n.viewer-zoom-out::before {\\n  background-position: -20px 0;\\n  content: 'Zoom Out';\\n}\\n\\n.viewer-one-to-one::before {\\n  background-position: -40px 0;\\n  content: 'One to One';\\n}\\n\\n.viewer-reset::before {\\n  background-position: -60px 0;\\n  content: 'Reset';\\n}\\n\\n.viewer-prev::before {\\n  background-position: -80px 0;\\n  content: 'Previous';\\n}\\n\\n.viewer-play::before {\\n  background-position: -100px 0;\\n  content: 'Play';\\n}\\n\\n.viewer-next::before {\\n  background-position: -120px 0;\\n  content: 'Next';\\n}\\n\\n.viewer-rotate-left::before {\\n  background-position: -140px 0;\\n  content: 'Rotate Left';\\n}\\n\\n.viewer-rotate-right::before {\\n  background-position: -160px 0;\\n  content: 'Rotate Right';\\n}\\n\\n.viewer-flip-horizontal::before {\\n  background-position: -180px 0;\\n  content: 'Flip Horizontal';\\n}\\n\\n.viewer-flip-vertical::before {\\n  background-position: -200px 0;\\n  content: 'Flip Vertical';\\n}\\n\\n.viewer-fullscreen::before {\\n  background-position: -220px 0;\\n  content: 'Enter Full Screen';\\n}\\n\\n.viewer-fullscreen-exit::before {\\n  background-position: -240px 0;\\n  content: 'Exit Full Screen';\\n}\\n\\n.viewer-close::before {\\n  background-position: -260px 0;\\n  content: 'Close';\\n}\\n\\n.viewer-container {\\n  bottom: 0;\\n  direction: ltr;\\n  font-size: 0;\\n  left: 0;\\n  line-height: 0;\\n  overflow: hidden;\\n  position: absolute;\\n  right: 0;\\n  -webkit-tap-highlight-color: transparent;\\n  top: 0;\\n  -ms-touch-action: none;\\n  touch-action: none;\\n  -webkit-touch-callout: none;\\n  -webkit-user-select: none;\\n  -moz-user-select: none;\\n  -ms-user-select: none;\\n  user-select: none;\\n}\\n\\n.viewer-container::-moz-selection,\\n.viewer-container *::-moz-selection {\\n  background-color: transparent;\\n}\\n\\n.viewer-container::-moz-selection, .viewer-container *::-moz-selection {\\n  background-color: transparent;\\n}\\n\\n.viewer-container::selection,\\n.viewer-container *::selection {\\n  background-color: transparent;\\n}\\n\\n.viewer-container:focus {\\n  outline: 0;\\n}\\n\\n.viewer-container img {\\n  display: block;\\n  height: auto;\\n  max-height: none !important;\\n  max-width: none !important;\\n  min-height: 0 !important;\\n  min-width: 0 !important;\\n  width: 100%;\\n}\\n\\n.viewer-canvas {\\n  bottom: 0;\\n  left: 0;\\n  overflow: hidden;\\n  position: absolute;\\n  right: 0;\\n  top: 0;\\n}\\n\\n.viewer-canvas > img {\\n  height: auto;\\n  margin: 15px auto;\\n  max-width: 90% !important;\\n  width: auto;\\n}\\n\\n.viewer-footer {\\n  bottom: 0;\\n  left: 0;\\n  overflow: hidden;\\n  position: absolute;\\n  right: 0;\\n  text-align: center;\\n}\\n\\n.viewer-navbar {\\n  background-color: rgba(0, 0, 0, 0.5);\\n  overflow: hidden;\\n}\\n\\n.viewer-list {\\n  -webkit-box-sizing: content-box;\\n  box-sizing: content-box;\\n  height: 50px;\\n  margin: 0;\\n  overflow: hidden;\\n  padding: 1px 0;\\n}\\n\\n.viewer-list > li {\\n  color: transparent;\\n  cursor: pointer;\\n  float: left;\\n  font-size: 0;\\n  height: 50px;\\n  line-height: 0;\\n  opacity: 0.5;\\n  overflow: hidden;\\n  -webkit-transition: opacity 0.15s;\\n  transition: opacity 0.15s;\\n  width: 30px;\\n}\\n\\n.viewer-list > li:focus,\\n.viewer-list > li:hover {\\n  opacity: 0.75;\\n}\\n\\n.viewer-list > li:focus {\\n  outline: 0;\\n}\\n\\n.viewer-list > li + li {\\n  margin-left: 1px;\\n}\\n\\n.viewer-list > .viewer-loading {\\n  position: relative;\\n}\\n\\n.viewer-list > .viewer-loading::after {\\n  border-width: 2px;\\n  height: 20px;\\n  margin-left: -10px;\\n  margin-top: -10px;\\n  width: 20px;\\n}\\n\\n.viewer-list > .viewer-active,\\n.viewer-list > .viewer-active:focus,\\n.viewer-list > .viewer-active:hover {\\n  opacity: 1;\\n}\\n\\n.viewer-player {\\n  background-color: #000;\\n  bottom: 0;\\n  cursor: none;\\n  display: none;\\n  left: 0;\\n  position: absolute;\\n  right: 0;\\n  top: 0;\\n  z-index: 1;\\n}\\n\\n.viewer-player > img {\\n  left: 0;\\n  position: absolute;\\n  top: 0;\\n}\\n\\n.viewer-toolbar > ul {\\n  display: inline-block;\\n  margin: 0 auto 5px;\\n  overflow: hidden;\\n  padding: 6px 3px;\\n}\\n\\n.viewer-toolbar > ul > li {\\n  background-color: rgba(0, 0, 0, 0.5);\\n  border-radius: 50%;\\n  cursor: pointer;\\n  float: left;\\n  height: 24px;\\n  overflow: hidden;\\n  -webkit-transition: background-color 0.15s;\\n  transition: background-color 0.15s;\\n  width: 24px;\\n}\\n\\n.viewer-toolbar > ul > li:focus,\\n.viewer-toolbar > ul > li:hover {\\n  background-color: rgba(0, 0, 0, 0.8);\\n}\\n\\n.viewer-toolbar > ul > li:focus {\\n  -webkit-box-shadow: 0 0 3px #fff;\\n  box-shadow: 0 0 3px #fff;\\n  outline: 0;\\n  position: relative;\\n  z-index: 1;\\n}\\n\\n.viewer-toolbar > ul > li::before {\\n  margin: 2px;\\n}\\n\\n.viewer-toolbar > ul > li + li {\\n  margin-left: 1px;\\n}\\n\\n.viewer-toolbar > ul > .viewer-small {\\n  height: 18px;\\n  margin-bottom: 3px;\\n  margin-top: 3px;\\n  width: 18px;\\n}\\n\\n.viewer-toolbar > ul > .viewer-small::before {\\n  margin: -1px;\\n}\\n\\n.viewer-toolbar > ul > .viewer-large {\\n  height: 30px;\\n  margin-bottom: -3px;\\n  margin-top: -3px;\\n  width: 30px;\\n}\\n\\n.viewer-toolbar > ul > .viewer-large::before {\\n  margin: 5px;\\n}\\n\\n.viewer-tooltip {\\n  background-color: rgba(0, 0, 0, 0.8);\\n  border-radius: 10px;\\n  color: #fff;\\n  display: none;\\n  font-size: 12px;\\n  height: 20px;\\n  left: 50%;\\n  line-height: 20px;\\n  margin-left: -25px;\\n  margin-top: -10px;\\n  position: absolute;\\n  text-align: center;\\n  top: 50%;\\n  width: 50px;\\n}\\n\\n.viewer-title {\\n  color: #ccc;\\n  display: inline-block;\\n  font-size: 12px;\\n  line-height: 1;\\n  margin: 0 5% 5px;\\n  max-width: 90%;\\n  opacity: 0.8;\\n  overflow: hidden;\\n  text-overflow: ellipsis;\\n  -webkit-transition: opacity 0.15s;\\n  transition: opacity 0.15s;\\n  white-space: nowrap;\\n}\\n\\n.viewer-title:hover {\\n  opacity: 1;\\n}\\n\\n.viewer-button {\\n  background-color: rgba(0, 0, 0, 0.5);\\n  border-radius: 50%;\\n  cursor: pointer;\\n  height: 80px;\\n  overflow: hidden;\\n  position: absolute;\\n  right: -40px;\\n  top: -40px;\\n  -webkit-transition: background-color 0.15s;\\n  transition: background-color 0.15s;\\n  width: 80px;\\n}\\n\\n.viewer-button:focus,\\n.viewer-button:hover {\\n  background-color: rgba(0, 0, 0, 0.8);\\n}\\n\\n.viewer-button:focus {\\n  -webkit-box-shadow: 0 0 3px #fff;\\n  box-shadow: 0 0 3px #fff;\\n  outline: 0;\\n}\\n\\n.viewer-button::before {\\n  bottom: 15px;\\n  left: 15px;\\n  position: absolute;\\n}\\n\\n.viewer-fixed {\\n  position: fixed;\\n}\\n\\n.viewer-open {\\n  overflow: hidden;\\n}\\n\\n.viewer-show {\\n  display: block;\\n}\\n\\n.viewer-hide {\\n  display: none;\\n}\\n\\n.viewer-backdrop {\\n  background-color: rgba(0, 0, 0, 0.5);\\n}\\n\\n.viewer-invisible {\\n  visibility: hidden;\\n}\\n\\n.viewer-move {\\n  cursor: move;\\n  cursor: -webkit-grab;\\n  cursor: grab;\\n}\\n\\n.viewer-fade {\\n  opacity: 0;\\n}\\n\\n.viewer-in {\\n  opacity: 1;\\n}\\n\\n.viewer-transition {\\n  -webkit-transition: all 0.3s;\\n  transition: all 0.3s;\\n}\\n\\n@-webkit-keyframes viewer-spinner {\\n  0% {\\n    -webkit-transform: rotate(0deg);\\n    transform: rotate(0deg);\\n  }\\n\\n  100% {\\n    -webkit-transform: rotate(360deg);\\n    transform: rotate(360deg);\\n  }\\n}\\n\\n@keyframes viewer-spinner {\\n  0% {\\n    -webkit-transform: rotate(0deg);\\n    transform: rotate(0deg);\\n  }\\n\\n  100% {\\n    -webkit-transform: rotate(360deg);\\n    transform: rotate(360deg);\\n  }\\n}\\n\\n.viewer-loading::after {\\n  -webkit-animation: viewer-spinner 1s linear infinite;\\n  animation: viewer-spinner 1s linear infinite;\\n  border: 4px solid rgba(255, 255, 255, 0.1);\\n  border-left-color: rgba(255, 255, 255, 0.5);\\n  border-radius: 50%;\\n  content: '';\\n  display: inline-block;\\n  height: 40px;\\n  left: 50%;\\n  margin-left: -20px;\\n  margin-top: -20px;\\n  position: absolute;\\n  top: 50%;\\n  width: 40px;\\n  z-index: 1;\\n}\\n\\n@media (max-width: 767px) {\\n  .viewer-hide-xs-down {\\n    display: none;\\n  }\\n}\\n\\n@media (max-width: 991px) {\\n  .viewer-hide-sm-down {\\n    display: none;\\n  }\\n}\\n\\n@media (max-width: 1199px) {\\n  .viewer-hide-md-down {\\n    display: none;\\n  }\\n}\\n\", \"\"]);\n\n// exports\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9pbmRleC5qcz8hLi9ub2RlX21vZHVsZXMvcG9zdGNzcy1sb2FkZXIvc3JjL2luZGV4LmpzPyEuL25vZGVfbW9kdWxlcy92aWV3ZXJqcy9kaXN0L3ZpZXdlci5jc3MuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvdmlld2VyanMvZGlzdC92aWV3ZXIuY3NzPzg2ZjIiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0cyA9IG1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcIi4uLy4uL2Nzcy1sb2FkZXIvbGliL2Nzcy1iYXNlLmpzXCIpKGZhbHNlKTtcbi8vIGltcG9ydHNcblxuXG4vLyBtb2R1bGVcbmV4cG9ydHMucHVzaChbbW9kdWxlLmlkLCBcIi8qIVxcbiAqIFZpZXdlci5qcyB2MS45LjBcXG4gKiBodHRwczovL2Zlbmd5dWFuY2hlbi5naXRodWIuaW8vdmlld2VyanNcXG4gKlxcbiAqIENvcHlyaWdodCAyMDE1LXByZXNlbnQgQ2hlbiBGZW5neXVhblxcbiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZVxcbiAqXFxuICogRGF0ZTogMjAyMC0xMi0wNlQxMToyNToxMC43MjRaXFxuICovXFxuXFxuLnZpZXdlci16b29tLWluOjpiZWZvcmUsXFxuLnZpZXdlci16b29tLW91dDo6YmVmb3JlLFxcbi52aWV3ZXItb25lLXRvLW9uZTo6YmVmb3JlLFxcbi52aWV3ZXItcmVzZXQ6OmJlZm9yZSxcXG4udmlld2VyLXByZXY6OmJlZm9yZSxcXG4udmlld2VyLXBsYXk6OmJlZm9yZSxcXG4udmlld2VyLW5leHQ6OmJlZm9yZSxcXG4udmlld2VyLXJvdGF0ZS1sZWZ0OjpiZWZvcmUsXFxuLnZpZXdlci1yb3RhdGUtcmlnaHQ6OmJlZm9yZSxcXG4udmlld2VyLWZsaXAtaG9yaXpvbnRhbDo6YmVmb3JlLFxcbi52aWV3ZXItZmxpcC12ZXJ0aWNhbDo6YmVmb3JlLFxcbi52aWV3ZXItZnVsbHNjcmVlbjo6YmVmb3JlLFxcbi52aWV3ZXItZnVsbHNjcmVlbi1leGl0OjpiZWZvcmUsXFxuLnZpZXdlci1jbG9zZTo6YmVmb3JlIHtcXG4gIGJhY2tncm91bmQtaW1hZ2U6IHVybCgnZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFSZ0FBQUFVQ0FZQUFBQldPeUpEQUFBQUJITkNTVlFJQ0FnSWZBaGtpQUFBQUFsd1NGbHpBQUFMRWdBQUN4SUIwdDErL0FBQUFCeDBSVmgwVTI5bWRIZGhjbVVBUVdSdlltVWdSbWx5WlhkdmNtdHpJRU5UTnVpOHNvd0FBQVFQU1VSQlZIaWM3WnMvaUZ4VkZNYS8wVTJVYUpHa3NVZ25JVmhZeFZocGpEYlpDQm1MZEFZRUN4c1JGQlRVYW1jWFVpU05uY2dLUWJTeHN4SDhnekFQM0ZVMmpZMGtLS0pOaWlpSWdoRmxjY25QNHAzblBDZHYzcDk3Nzh2c0xPY0hCMmJmdmVlYjc5NTVjM2p2dk5rQklNZHhuRDY0YTk0R0hNZlp1M2lCY1J5bk43ekFPSTdURzE1Z0hDZWVOVWtyOHpheEcybGJZRFlzZGdNYmt0QnNQMDNqZFF3bGpTWGR0QmhMT210am93QzlNZzlMK2tuU2xjRDhUTktwU0E5bEJwSzJKRjJWZERTUjVuNUo2NG0wcWxpMzk5aE5GTVVscHNoUWlpNWpiWFRiSEd2aUIwbkxOZU5EU2Q5Vk80QTJVZEIyZnAreDBlQ25hWHhXWEdBMlgwYXUvM0hnTjlQNExGQ2pJQU5PSmRyTHIwenpaK0JFcE5ZRHdLYnBuUU1lQXc0bThIalF0TTZaOXFhOTE3elBRd0ZyM001S2dBNko1clRKQ2RGWkpqOS9seXZHaHNEdndGTlZ1VjJNaGhqcks2YjliRmlFK2oxcjg3ZUJsNEhEd0NGNy9VL2srb2ZBWDViL0VYQnY1Sm9MTXVJTHpmM0FwNlozRXpnZHFITUN1RjdoY1FmNEhEZ2VvSG5jY25jcWRLL1R2U0RXZmZGWEkvZXhJQ1kveFp5cWM2WExXRjFVRlpuYTRnSjdxOEJzUnZnZDIveFhwbzZQK0Q5ZGZUN1BwRUN0QTNjbldQTTBHWEdGWmgvd2dXbHRBK2NETkM3WCtBUDRHempaUWUrazVkUnh1WVBlaXVYVTdlMXF3THBEejdkRmpYS1JhU3d1TUx2QWxHOHpabEcrWW1pSzFIb0ZxVDd3UDJ6KzRRNDVUZkVHY010MDF4TG9OWkVCVHdScUQ0Qkxwbk1MZUMxQTQxVW1WeHNYZ1hlQmF5Vi9XeDIwcnBUeXJwbldSZnQ3cDZPL0ZkcXpHckR1a1BOdGthTW9NbzNGQmRCU1FNT25ZQkNSZXlmMDVzMTI2ZlU5eXRmWDk4K21ZNTRLeG5wN1M5SzNrajZVOUtZZEcwaDZVZExia2g3cG9GWE1mVW5TT3lWdkwwaDZWdElYSGJTNm5PUCtzL1ptOW12eVhXMXV1QzlvaFo3MkU5dURtWFdMSk9CMUd4c0grRHhQZnRzQjhCNndsR0ROMDJUQWt4RzYrNEQzVFdzYmVDNUNTOENERmNlK0FXNTAwTGhoT1cyMDIwVFJqSzNiMjFIRW1ndGk5bTBSb254YmRNWmVWelYrLzR0RjNjQnBQN0U5bUtITkw1cThoNWcwZVlzQ01RejBlcHE4Z1Fyd01YQWdjczBGR1hHRlJjQjl3Q2VtRjlQa2JZcU0vQmFzN2Z4THdOZUpQZFRkcG80aXRRdGk4bFBNcVRwWHVvelZSVlhQcGJISTNLa05UQjFOZmtMODFqMm12aERwOTFIZ1Y5TUt1UklxcnlrajNXUHE0ckh5TCtheGo4L3FHUG1UcWk2RjlZRGxIT3ZKVTZvWWNUc2gvVFlTeldtVEU2SlQxOUN0TFRKdDMyRDZDbUhlMGVRbjFPOHo1QVhnVDRzeDRWY3UwL0VRZWNNeWRCOHowaFVXa1RkMnQ0Q3J3TkVlUHFNQmNBUjRtckJid3lYTFBXSmE4enJYbW1MRWhOQm1mcGt1WTIxMDJ4eHJpaCtwYitpZUFiNnZHaHVBOTdVY0o1S1I4Z1o3N0srOTl4eGVZQnpINlEzL1owZkhjWHJEQzR6ak9MM2hCY1p4bk43NEYremx2WEZXWEY5UEFBQUFBRWxGVGtTdVFtQ0MnKTtcXG4gIGJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQ7XFxuICBiYWNrZ3JvdW5kLXNpemU6IDI4MHB4O1xcbiAgY29sb3I6IHRyYW5zcGFyZW50O1xcbiAgZGlzcGxheTogYmxvY2s7XFxuICBmb250LXNpemU6IDA7XFxuICBoZWlnaHQ6IDIwcHg7XFxuICBsaW5lLWhlaWdodDogMDtcXG4gIHdpZHRoOiAyMHB4O1xcbn1cXG5cXG4udmlld2VyLXpvb20taW46OmJlZm9yZSB7XFxuICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAwIDA7XFxuICBjb250ZW50OiAnWm9vbSBJbic7XFxufVxcblxcbi52aWV3ZXItem9vbS1vdXQ6OmJlZm9yZSB7XFxuICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtMjBweCAwO1xcbiAgY29udGVudDogJ1pvb20gT3V0JztcXG59XFxuXFxuLnZpZXdlci1vbmUtdG8tb25lOjpiZWZvcmUge1xcbiAgYmFja2dyb3VuZC1wb3NpdGlvbjogLTQwcHggMDtcXG4gIGNvbnRlbnQ6ICdPbmUgdG8gT25lJztcXG59XFxuXFxuLnZpZXdlci1yZXNldDo6YmVmb3JlIHtcXG4gIGJhY2tncm91bmQtcG9zaXRpb246IC02MHB4IDA7XFxuICBjb250ZW50OiAnUmVzZXQnO1xcbn1cXG5cXG4udmlld2VyLXByZXY6OmJlZm9yZSB7XFxuICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtODBweCAwO1xcbiAgY29udGVudDogJ1ByZXZpb3VzJztcXG59XFxuXFxuLnZpZXdlci1wbGF5OjpiZWZvcmUge1xcbiAgYmFja2dyb3VuZC1wb3NpdGlvbjogLTEwMHB4IDA7XFxuICBjb250ZW50OiAnUGxheSc7XFxufVxcblxcbi52aWV3ZXItbmV4dDo6YmVmb3JlIHtcXG4gIGJhY2tncm91bmQtcG9zaXRpb246IC0xMjBweCAwO1xcbiAgY29udGVudDogJ05leHQnO1xcbn1cXG5cXG4udmlld2VyLXJvdGF0ZS1sZWZ0OjpiZWZvcmUge1xcbiAgYmFja2dyb3VuZC1wb3NpdGlvbjogLTE0MHB4IDA7XFxuICBjb250ZW50OiAnUm90YXRlIExlZnQnO1xcbn1cXG5cXG4udmlld2VyLXJvdGF0ZS1yaWdodDo6YmVmb3JlIHtcXG4gIGJhY2tncm91bmQtcG9zaXRpb246IC0xNjBweCAwO1xcbiAgY29udGVudDogJ1JvdGF0ZSBSaWdodCc7XFxufVxcblxcbi52aWV3ZXItZmxpcC1ob3Jpem9udGFsOjpiZWZvcmUge1xcbiAgYmFja2dyb3VuZC1wb3NpdGlvbjogLTE4MHB4IDA7XFxuICBjb250ZW50OiAnRmxpcCBIb3Jpem9udGFsJztcXG59XFxuXFxuLnZpZXdlci1mbGlwLXZlcnRpY2FsOjpiZWZvcmUge1xcbiAgYmFja2dyb3VuZC1wb3NpdGlvbjogLTIwMHB4IDA7XFxuICBjb250ZW50OiAnRmxpcCBWZXJ0aWNhbCc7XFxufVxcblxcbi52aWV3ZXItZnVsbHNjcmVlbjo6YmVmb3JlIHtcXG4gIGJhY2tncm91bmQtcG9zaXRpb246IC0yMjBweCAwO1xcbiAgY29udGVudDogJ0VudGVyIEZ1bGwgU2NyZWVuJztcXG59XFxuXFxuLnZpZXdlci1mdWxsc2NyZWVuLWV4aXQ6OmJlZm9yZSB7XFxuICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiAtMjQwcHggMDtcXG4gIGNvbnRlbnQ6ICdFeGl0IEZ1bGwgU2NyZWVuJztcXG59XFxuXFxuLnZpZXdlci1jbG9zZTo6YmVmb3JlIHtcXG4gIGJhY2tncm91bmQtcG9zaXRpb246IC0yNjBweCAwO1xcbiAgY29udGVudDogJ0Nsb3NlJztcXG59XFxuXFxuLnZpZXdlci1jb250YWluZXIge1xcbiAgYm90dG9tOiAwO1xcbiAgZGlyZWN0aW9uOiBsdHI7XFxuICBmb250LXNpemU6IDA7XFxuICBsZWZ0OiAwO1xcbiAgbGluZS1oZWlnaHQ6IDA7XFxuICBvdmVyZmxvdzogaGlkZGVuO1xcbiAgcG9zaXRpb246IGFic29sdXRlO1xcbiAgcmlnaHQ6IDA7XFxuICAtd2Via2l0LXRhcC1oaWdobGlnaHQtY29sb3I6IHRyYW5zcGFyZW50O1xcbiAgdG9wOiAwO1xcbiAgLW1zLXRvdWNoLWFjdGlvbjogbm9uZTtcXG4gIHRvdWNoLWFjdGlvbjogbm9uZTtcXG4gIC13ZWJraXQtdG91Y2gtY2FsbG91dDogbm9uZTtcXG4gIC13ZWJraXQtdXNlci1zZWxlY3Q6IG5vbmU7XFxuICAtbW96LXVzZXItc2VsZWN0OiBub25lO1xcbiAgLW1zLXVzZXItc2VsZWN0OiBub25lO1xcbiAgdXNlci1zZWxlY3Q6IG5vbmU7XFxufVxcblxcbi52aWV3ZXItY29udGFpbmVyOjotbW96LXNlbGVjdGlvbixcXG4udmlld2VyLWNvbnRhaW5lciAqOjotbW96LXNlbGVjdGlvbiB7XFxuICBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDtcXG59XFxuXFxuLnZpZXdlci1jb250YWluZXI6Oi1tb3otc2VsZWN0aW9uLCAudmlld2VyLWNvbnRhaW5lciAqOjotbW96LXNlbGVjdGlvbiB7XFxuICBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDtcXG59XFxuXFxuLnZpZXdlci1jb250YWluZXI6OnNlbGVjdGlvbixcXG4udmlld2VyLWNvbnRhaW5lciAqOjpzZWxlY3Rpb24ge1xcbiAgYmFja2dyb3VuZC1jb2xvcjogdHJhbnNwYXJlbnQ7XFxufVxcblxcbi52aWV3ZXItY29udGFpbmVyOmZvY3VzIHtcXG4gIG91dGxpbmU6IDA7XFxufVxcblxcbi52aWV3ZXItY29udGFpbmVyIGltZyB7XFxuICBkaXNwbGF5OiBibG9jaztcXG4gIGhlaWdodDogYXV0bztcXG4gIG1heC1oZWlnaHQ6IG5vbmUgIWltcG9ydGFudDtcXG4gIG1heC13aWR0aDogbm9uZSAhaW1wb3J0YW50O1xcbiAgbWluLWhlaWdodDogMCAhaW1wb3J0YW50O1xcbiAgbWluLXdpZHRoOiAwICFpbXBvcnRhbnQ7XFxuICB3aWR0aDogMTAwJTtcXG59XFxuXFxuLnZpZXdlci1jYW52YXMge1xcbiAgYm90dG9tOiAwO1xcbiAgbGVmdDogMDtcXG4gIG92ZXJmbG93OiBoaWRkZW47XFxuICBwb3NpdGlvbjogYWJzb2x1dGU7XFxuICByaWdodDogMDtcXG4gIHRvcDogMDtcXG59XFxuXFxuLnZpZXdlci1jYW52YXMgPiBpbWcge1xcbiAgaGVpZ2h0OiBhdXRvO1xcbiAgbWFyZ2luOiAxNXB4IGF1dG87XFxuICBtYXgtd2lkdGg6IDkwJSAhaW1wb3J0YW50O1xcbiAgd2lkdGg6IGF1dG87XFxufVxcblxcbi52aWV3ZXItZm9vdGVyIHtcXG4gIGJvdHRvbTogMDtcXG4gIGxlZnQ6IDA7XFxuICBvdmVyZmxvdzogaGlkZGVuO1xcbiAgcG9zaXRpb246IGFic29sdXRlO1xcbiAgcmlnaHQ6IDA7XFxuICB0ZXh0LWFsaWduOiBjZW50ZXI7XFxufVxcblxcbi52aWV3ZXItbmF2YmFyIHtcXG4gIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMCwgMCwgMCwgMC41KTtcXG4gIG92ZXJmbG93OiBoaWRkZW47XFxufVxcblxcbi52aWV3ZXItbGlzdCB7XFxuICAtd2Via2l0LWJveC1zaXppbmc6IGNvbnRlbnQtYm94O1xcbiAgYm94LXNpemluZzogY29udGVudC1ib3g7XFxuICBoZWlnaHQ6IDUwcHg7XFxuICBtYXJnaW46IDA7XFxuICBvdmVyZmxvdzogaGlkZGVuO1xcbiAgcGFkZGluZzogMXB4IDA7XFxufVxcblxcbi52aWV3ZXItbGlzdCA+IGxpIHtcXG4gIGNvbG9yOiB0cmFuc3BhcmVudDtcXG4gIGN1cnNvcjogcG9pbnRlcjtcXG4gIGZsb2F0OiBsZWZ0O1xcbiAgZm9udC1zaXplOiAwO1xcbiAgaGVpZ2h0OiA1MHB4O1xcbiAgbGluZS1oZWlnaHQ6IDA7XFxuICBvcGFjaXR5OiAwLjU7XFxuICBvdmVyZmxvdzogaGlkZGVuO1xcbiAgLXdlYmtpdC10cmFuc2l0aW9uOiBvcGFjaXR5IDAuMTVzO1xcbiAgdHJhbnNpdGlvbjogb3BhY2l0eSAwLjE1cztcXG4gIHdpZHRoOiAzMHB4O1xcbn1cXG5cXG4udmlld2VyLWxpc3QgPiBsaTpmb2N1cyxcXG4udmlld2VyLWxpc3QgPiBsaTpob3ZlciB7XFxuICBvcGFjaXR5OiAwLjc1O1xcbn1cXG5cXG4udmlld2VyLWxpc3QgPiBsaTpmb2N1cyB7XFxuICBvdXRsaW5lOiAwO1xcbn1cXG5cXG4udmlld2VyLWxpc3QgPiBsaSArIGxpIHtcXG4gIG1hcmdpbi1sZWZ0OiAxcHg7XFxufVxcblxcbi52aWV3ZXItbGlzdCA+IC52aWV3ZXItbG9hZGluZyB7XFxuICBwb3NpdGlvbjogcmVsYXRpdmU7XFxufVxcblxcbi52aWV3ZXItbGlzdCA+IC52aWV3ZXItbG9hZGluZzo6YWZ0ZXIge1xcbiAgYm9yZGVyLXdpZHRoOiAycHg7XFxuICBoZWlnaHQ6IDIwcHg7XFxuICBtYXJnaW4tbGVmdDogLTEwcHg7XFxuICBtYXJnaW4tdG9wOiAtMTBweDtcXG4gIHdpZHRoOiAyMHB4O1xcbn1cXG5cXG4udmlld2VyLWxpc3QgPiAudmlld2VyLWFjdGl2ZSxcXG4udmlld2VyLWxpc3QgPiAudmlld2VyLWFjdGl2ZTpmb2N1cyxcXG4udmlld2VyLWxpc3QgPiAudmlld2VyLWFjdGl2ZTpob3ZlciB7XFxuICBvcGFjaXR5OiAxO1xcbn1cXG5cXG4udmlld2VyLXBsYXllciB7XFxuICBiYWNrZ3JvdW5kLWNvbG9yOiAjMDAwO1xcbiAgYm90dG9tOiAwO1xcbiAgY3Vyc29yOiBub25lO1xcbiAgZGlzcGxheTogbm9uZTtcXG4gIGxlZnQ6IDA7XFxuICBwb3NpdGlvbjogYWJzb2x1dGU7XFxuICByaWdodDogMDtcXG4gIHRvcDogMDtcXG4gIHotaW5kZXg6IDE7XFxufVxcblxcbi52aWV3ZXItcGxheWVyID4gaW1nIHtcXG4gIGxlZnQ6IDA7XFxuICBwb3NpdGlvbjogYWJzb2x1dGU7XFxuICB0b3A6IDA7XFxufVxcblxcbi52aWV3ZXItdG9vbGJhciA+IHVsIHtcXG4gIGRpc3BsYXk6IGlubGluZS1ibG9jaztcXG4gIG1hcmdpbjogMCBhdXRvIDVweDtcXG4gIG92ZXJmbG93OiBoaWRkZW47XFxuICBwYWRkaW5nOiA2cHggM3B4O1xcbn1cXG5cXG4udmlld2VyLXRvb2xiYXIgPiB1bCA+IGxpIHtcXG4gIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMCwgMCwgMCwgMC41KTtcXG4gIGJvcmRlci1yYWRpdXM6IDUwJTtcXG4gIGN1cnNvcjogcG9pbnRlcjtcXG4gIGZsb2F0OiBsZWZ0O1xcbiAgaGVpZ2h0OiAyNHB4O1xcbiAgb3ZlcmZsb3c6IGhpZGRlbjtcXG4gIC13ZWJraXQtdHJhbnNpdGlvbjogYmFja2dyb3VuZC1jb2xvciAwLjE1cztcXG4gIHRyYW5zaXRpb246IGJhY2tncm91bmQtY29sb3IgMC4xNXM7XFxuICB3aWR0aDogMjRweDtcXG59XFxuXFxuLnZpZXdlci10b29sYmFyID4gdWwgPiBsaTpmb2N1cyxcXG4udmlld2VyLXRvb2xiYXIgPiB1bCA+IGxpOmhvdmVyIHtcXG4gIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMCwgMCwgMCwgMC44KTtcXG59XFxuXFxuLnZpZXdlci10b29sYmFyID4gdWwgPiBsaTpmb2N1cyB7XFxuICAtd2Via2l0LWJveC1zaGFkb3c6IDAgMCAzcHggI2ZmZjtcXG4gIGJveC1zaGFkb3c6IDAgMCAzcHggI2ZmZjtcXG4gIG91dGxpbmU6IDA7XFxuICBwb3NpdGlvbjogcmVsYXRpdmU7XFxuICB6LWluZGV4OiAxO1xcbn1cXG5cXG4udmlld2VyLXRvb2xiYXIgPiB1bCA+IGxpOjpiZWZvcmUge1xcbiAgbWFyZ2luOiAycHg7XFxufVxcblxcbi52aWV3ZXItdG9vbGJhciA+IHVsID4gbGkgKyBsaSB7XFxuICBtYXJnaW4tbGVmdDogMXB4O1xcbn1cXG5cXG4udmlld2VyLXRvb2xiYXIgPiB1bCA+IC52aWV3ZXItc21hbGwge1xcbiAgaGVpZ2h0OiAxOHB4O1xcbiAgbWFyZ2luLWJvdHRvbTogM3B4O1xcbiAgbWFyZ2luLXRvcDogM3B4O1xcbiAgd2lkdGg6IDE4cHg7XFxufVxcblxcbi52aWV3ZXItdG9vbGJhciA+IHVsID4gLnZpZXdlci1zbWFsbDo6YmVmb3JlIHtcXG4gIG1hcmdpbjogLTFweDtcXG59XFxuXFxuLnZpZXdlci10b29sYmFyID4gdWwgPiAudmlld2VyLWxhcmdlIHtcXG4gIGhlaWdodDogMzBweDtcXG4gIG1hcmdpbi1ib3R0b206IC0zcHg7XFxuICBtYXJnaW4tdG9wOiAtM3B4O1xcbiAgd2lkdGg6IDMwcHg7XFxufVxcblxcbi52aWV3ZXItdG9vbGJhciA+IHVsID4gLnZpZXdlci1sYXJnZTo6YmVmb3JlIHtcXG4gIG1hcmdpbjogNXB4O1xcbn1cXG5cXG4udmlld2VyLXRvb2x0aXAge1xcbiAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgwLCAwLCAwLCAwLjgpO1xcbiAgYm9yZGVyLXJhZGl1czogMTBweDtcXG4gIGNvbG9yOiAjZmZmO1xcbiAgZGlzcGxheTogbm9uZTtcXG4gIGZvbnQtc2l6ZTogMTJweDtcXG4gIGhlaWdodDogMjBweDtcXG4gIGxlZnQ6IDUwJTtcXG4gIGxpbmUtaGVpZ2h0OiAyMHB4O1xcbiAgbWFyZ2luLWxlZnQ6IC0yNXB4O1xcbiAgbWFyZ2luLXRvcDogLTEwcHg7XFxuICBwb3NpdGlvbjogYWJzb2x1dGU7XFxuICB0ZXh0LWFsaWduOiBjZW50ZXI7XFxuICB0b3A6IDUwJTtcXG4gIHdpZHRoOiA1MHB4O1xcbn1cXG5cXG4udmlld2VyLXRpdGxlIHtcXG4gIGNvbG9yOiAjY2NjO1xcbiAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xcbiAgZm9udC1zaXplOiAxMnB4O1xcbiAgbGluZS1oZWlnaHQ6IDE7XFxuICBtYXJnaW46IDAgNSUgNXB4O1xcbiAgbWF4LXdpZHRoOiA5MCU7XFxuICBvcGFjaXR5OiAwLjg7XFxuICBvdmVyZmxvdzogaGlkZGVuO1xcbiAgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7XFxuICAtd2Via2l0LXRyYW5zaXRpb246IG9wYWNpdHkgMC4xNXM7XFxuICB0cmFuc2l0aW9uOiBvcGFjaXR5IDAuMTVzO1xcbiAgd2hpdGUtc3BhY2U6IG5vd3JhcDtcXG59XFxuXFxuLnZpZXdlci10aXRsZTpob3ZlciB7XFxuICBvcGFjaXR5OiAxO1xcbn1cXG5cXG4udmlld2VyLWJ1dHRvbiB7XFxuICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDAsIDAsIDAsIDAuNSk7XFxuICBib3JkZXItcmFkaXVzOiA1MCU7XFxuICBjdXJzb3I6IHBvaW50ZXI7XFxuICBoZWlnaHQ6IDgwcHg7XFxuICBvdmVyZmxvdzogaGlkZGVuO1xcbiAgcG9zaXRpb246IGFic29sdXRlO1xcbiAgcmlnaHQ6IC00MHB4O1xcbiAgdG9wOiAtNDBweDtcXG4gIC13ZWJraXQtdHJhbnNpdGlvbjogYmFja2dyb3VuZC1jb2xvciAwLjE1cztcXG4gIHRyYW5zaXRpb246IGJhY2tncm91bmQtY29sb3IgMC4xNXM7XFxuICB3aWR0aDogODBweDtcXG59XFxuXFxuLnZpZXdlci1idXR0b246Zm9jdXMsXFxuLnZpZXdlci1idXR0b246aG92ZXIge1xcbiAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgwLCAwLCAwLCAwLjgpO1xcbn1cXG5cXG4udmlld2VyLWJ1dHRvbjpmb2N1cyB7XFxuICAtd2Via2l0LWJveC1zaGFkb3c6IDAgMCAzcHggI2ZmZjtcXG4gIGJveC1zaGFkb3c6IDAgMCAzcHggI2ZmZjtcXG4gIG91dGxpbmU6IDA7XFxufVxcblxcbi52aWV3ZXItYnV0dG9uOjpiZWZvcmUge1xcbiAgYm90dG9tOiAxNXB4O1xcbiAgbGVmdDogMTVweDtcXG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcXG59XFxuXFxuLnZpZXdlci1maXhlZCB7XFxuICBwb3NpdGlvbjogZml4ZWQ7XFxufVxcblxcbi52aWV3ZXItb3BlbiB7XFxuICBvdmVyZmxvdzogaGlkZGVuO1xcbn1cXG5cXG4udmlld2VyLXNob3cge1xcbiAgZGlzcGxheTogYmxvY2s7XFxufVxcblxcbi52aWV3ZXItaGlkZSB7XFxuICBkaXNwbGF5OiBub25lO1xcbn1cXG5cXG4udmlld2VyLWJhY2tkcm9wIHtcXG4gIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMCwgMCwgMCwgMC41KTtcXG59XFxuXFxuLnZpZXdlci1pbnZpc2libGUge1xcbiAgdmlzaWJpbGl0eTogaGlkZGVuO1xcbn1cXG5cXG4udmlld2VyLW1vdmUge1xcbiAgY3Vyc29yOiBtb3ZlO1xcbiAgY3Vyc29yOiAtd2Via2l0LWdyYWI7XFxuICBjdXJzb3I6IGdyYWI7XFxufVxcblxcbi52aWV3ZXItZmFkZSB7XFxuICBvcGFjaXR5OiAwO1xcbn1cXG5cXG4udmlld2VyLWluIHtcXG4gIG9wYWNpdHk6IDE7XFxufVxcblxcbi52aWV3ZXItdHJhbnNpdGlvbiB7XFxuICAtd2Via2l0LXRyYW5zaXRpb246IGFsbCAwLjNzO1xcbiAgdHJhbnNpdGlvbjogYWxsIDAuM3M7XFxufVxcblxcbkAtd2Via2l0LWtleWZyYW1lcyB2aWV3ZXItc3Bpbm5lciB7XFxuICAwJSB7XFxuICAgIC13ZWJraXQtdHJhbnNmb3JtOiByb3RhdGUoMGRlZyk7XFxuICAgIHRyYW5zZm9ybTogcm90YXRlKDBkZWcpO1xcbiAgfVxcblxcbiAgMTAwJSB7XFxuICAgIC13ZWJraXQtdHJhbnNmb3JtOiByb3RhdGUoMzYwZGVnKTtcXG4gICAgdHJhbnNmb3JtOiByb3RhdGUoMzYwZGVnKTtcXG4gIH1cXG59XFxuXFxuQGtleWZyYW1lcyB2aWV3ZXItc3Bpbm5lciB7XFxuICAwJSB7XFxuICAgIC13ZWJraXQtdHJhbnNmb3JtOiByb3RhdGUoMGRlZyk7XFxuICAgIHRyYW5zZm9ybTogcm90YXRlKDBkZWcpO1xcbiAgfVxcblxcbiAgMTAwJSB7XFxuICAgIC13ZWJraXQtdHJhbnNmb3JtOiByb3RhdGUoMzYwZGVnKTtcXG4gICAgdHJhbnNmb3JtOiByb3RhdGUoMzYwZGVnKTtcXG4gIH1cXG59XFxuXFxuLnZpZXdlci1sb2FkaW5nOjphZnRlciB7XFxuICAtd2Via2l0LWFuaW1hdGlvbjogdmlld2VyLXNwaW5uZXIgMXMgbGluZWFyIGluZmluaXRlO1xcbiAgYW5pbWF0aW9uOiB2aWV3ZXItc3Bpbm5lciAxcyBsaW5lYXIgaW5maW5pdGU7XFxuICBib3JkZXI6IDRweCBzb2xpZCByZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMSk7XFxuICBib3JkZXItbGVmdC1jb2xvcjogcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjUpO1xcbiAgYm9yZGVyLXJhZGl1czogNTAlO1xcbiAgY29udGVudDogJyc7XFxuICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XFxuICBoZWlnaHQ6IDQwcHg7XFxuICBsZWZ0OiA1MCU7XFxuICBtYXJnaW4tbGVmdDogLTIwcHg7XFxuICBtYXJnaW4tdG9wOiAtMjBweDtcXG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcXG4gIHRvcDogNTAlO1xcbiAgd2lkdGg6IDQwcHg7XFxuICB6LWluZGV4OiAxO1xcbn1cXG5cXG5AbWVkaWEgKG1heC13aWR0aDogNzY3cHgpIHtcXG4gIC52aWV3ZXItaGlkZS14cy1kb3duIHtcXG4gICAgZGlzcGxheTogbm9uZTtcXG4gIH1cXG59XFxuXFxuQG1lZGlhIChtYXgtd2lkdGg6IDk5MXB4KSB7XFxuICAudmlld2VyLWhpZGUtc20tZG93biB7XFxuICAgIGRpc3BsYXk6IG5vbmU7XFxuICB9XFxufVxcblxcbkBtZWRpYSAobWF4LXdpZHRoOiAxMTk5cHgpIHtcXG4gIC52aWV3ZXItaGlkZS1tZC1kb3duIHtcXG4gICAgZGlzcGxheTogbm9uZTtcXG4gIH1cXG59XFxuXCIsIFwiXCJdKTtcblxuLy8gZXhwb3J0c1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/css-loader/index.js?!./node_modules/postcss-loader/src/index.js?!./node_modules/viewerjs/dist/viewer.css\n");

/***/ }),

/***/ "./node_modules/v-viewer/dist/v-viewer.js":
/*!************************************************!*\
  !*** ./node_modules/v-viewer/dist/v-viewer.js ***!
  \************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("(function webpackUniversalModuleDefinition(root, factory) {\n\tif(true)\n\t\tmodule.exports = factory(__webpack_require__(/*! viewerjs */ \"./node_modules/viewerjs/dist/viewer.js\"));\n\telse {}\n})(this, function(__WEBPACK_EXTERNAL_MODULE_0__) {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmony imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 4);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports) {\n\nmodule.exports = __WEBPACK_EXTERNAL_MODULE_0__;\n\n/***/ }),\n/* 1 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* WEBPACK VAR INJECTION */(function(global) {/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_viewerjs__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_viewerjs___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_viewerjs__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_throttle_debounce__ = __webpack_require__(5);\n\n\n\nvar install = function install(Vue, _ref) {\n  var _ref$name = _ref.name,\n      name = _ref$name === undefined ? 'viewer' : _ref$name,\n      _ref$debug = _ref.debug,\n      debug = _ref$debug === undefined ? false : _ref$debug;\n\n  function createViewer(el, options) {\n    var rebuild = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n\n    Vue.nextTick(function () {\n      if (rebuild || !el['$' + name]) {\n        destroyViewer(el);\n        el['$' + name] = new __WEBPACK_IMPORTED_MODULE_0_viewerjs___default.a(el, options);\n        log('viewer created');\n      } else {\n        el['$' + name].update();\n        log('viewer updated');\n      }\n    });\n  }\n\n  function createObserver(el, options, debouncedCreateViewer, rebuild) {\n    destroyObserver(el);\n    var MutationObserver = global.MutationObserver || global.WebKitMutationObserver || global.MozMutationObserver;\n    if (!MutationObserver) {\n      log('observer not supported');\n      return;\n    }\n    var observer = new MutationObserver(function (mutations) {\n      mutations.forEach(function (mutation) {\n        log('viewer mutation:' + mutation.type);\n        debouncedCreateViewer(el, options, rebuild);\n      });\n    });\n    var config = { attributes: true, childList: true, characterData: true, subtree: true };\n    observer.observe(el, config);\n    el['$viewerMutationObserver'] = observer;\n    log('observer created');\n  }\n\n  function createWatcher(el, _ref2, vnode, debouncedCreateViewer) {\n    var expression = _ref2.expression;\n\n    var simplePathRE = /^[A-Za-z_$][\\w$]*(?:\\.[A-Za-z_$][\\w$]*|\\['[^']*?']|\\[\"[^\"]*?\"]|\\[\\d+]|\\[[A-Za-z_$][\\w$]*])*$/;\n    if (!expression || !simplePathRE.test(expression)) {\n      log('only simple dot-delimited paths can create watcher');\n      return;\n    }\n    el['$viewerUnwatch'] = vnode.context.$watch(expression, function (newVal, oldVal) {\n      log('change detected by watcher: ', expression);\n      debouncedCreateViewer(el, newVal, true);\n    }, {\n      deep: true\n    });\n    log('watcher created, expression: ', expression);\n  }\n\n  function destroyViewer(el) {\n    if (!el['$' + name]) {\n      return;\n    }\n    el['$' + name].destroy();\n    delete el['$' + name];\n    log('viewer destroyed');\n  }\n\n  function destroyObserver(el) {\n    if (!el['$viewerMutationObserver']) {\n      return;\n    }\n    el['$viewerMutationObserver'].disconnect();\n    delete el['$viewerMutationObserver'];\n    log('observer destroyed');\n  }\n\n  function destroyWatcher(el) {\n    if (!el['$viewerUnwatch']) {\n      return;\n    }\n    el['$viewerUnwatch']();\n    delete el['$viewerUnwatch'];\n    log('watcher destroyed');\n  }\n\n  function log() {\n    var _console;\n\n    debug && (_console = console).log.apply(_console, arguments);\n  }\n\n  Vue.directive('viewer', {\n    bind: function bind(el, binding, vnode) {\n      log('viewer bind');\n      var debouncedCreateViewer = __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_1_throttle_debounce__[\"a\" /* debounce */])(50, createViewer);\n      debouncedCreateViewer(el, binding.value);\n\n      createWatcher(el, binding, vnode, debouncedCreateViewer);\n\n      if (!binding.modifiers.static) {\n        createObserver(el, binding.value, debouncedCreateViewer, binding.modifiers.rebuild);\n      }\n    },\n    unbind: function unbind(el, binding) {\n      log('viewer unbind');\n\n      destroyObserver(el);\n\n      destroyWatcher(el);\n\n      destroyViewer(el);\n    }\n  });\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = ({\n  install: install\n});\n/* WEBPACK VAR INJECTION */}.call(__webpack_exports__, __webpack_require__(7)))\n\n/***/ }),\n/* 2 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = extend;\n\nfunction extend() {\n  var extended = {};\n  var deep = false;\n  var i = 0;\n  var length = arguments.length;\n\n  if (Object.prototype.toString.call(arguments[0]) === '[object Boolean]') {\n    deep = arguments[0];\n    i++;\n  }\n\n  function merge(obj) {\n    for (var prop in obj) {\n      if (Object.prototype.hasOwnProperty.call(obj, prop)) {\n        if (deep && Object.prototype.toString.call(obj[prop]) === '[object Object]') {\n          extended[prop] = extend(true, extended[prop], obj[prop]);\n        } else {\n          extended[prop] = obj[prop];\n        }\n      }\n    }\n  }\n\n  for (; i < length; i++) {\n    var obj = arguments[i];\n    merge(obj);\n  }\n\n  return extended;\n}\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar Component = __webpack_require__(8)(\n  /* script */\n  __webpack_require__(6),\n  /* template */\n  __webpack_require__(9),\n  /* scopeId */\n  null,\n  /* cssModules */\n  null\n)\nComponent.options.__file = \"C:\\\\Workspaces\\\\Web\\\\Git\\\\v-viewer\\\\src\\\\component.vue\"\nif (Component.esModule && Object.keys(Component.esModule).some(function (key) {return key !== \"default\" && key !== \"__esModule\"})) {console.error(\"named exports are not supported in *.vue files.\")}\nif (Component.options.functional) {console.error(\"[vue-loader] component.vue: functional components are not supported with templates, they should use render functions.\")}\n\n/* hot reload */\nif (false) {}\n\nmodule.exports = Component.exports\n\n\n/***/ }),\n/* 4 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__utils__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__component_vue__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__component_vue___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1__component_vue__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__directive__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_viewerjs__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_viewerjs___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_viewerjs__);\n\n\n\n\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n  install: function install(Vue) {\n    var _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n        _ref$name = _ref.name,\n        name = _ref$name === undefined ? 'viewer' : _ref$name,\n        _ref$debug = _ref.debug,\n        debug = _ref$debug === undefined ? false : _ref$debug,\n        defaultOptions = _ref.defaultOptions;\n\n    __WEBPACK_IMPORTED_MODULE_3_viewerjs___default.a.setDefaults(defaultOptions);\n\n    Vue.component(name, __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__utils__[\"a\" /* extend */])(__WEBPACK_IMPORTED_MODULE_1__component_vue___default.a, { name: name }));\n    Vue.use(__WEBPACK_IMPORTED_MODULE_2__directive__[\"a\" /* default */], { name: name, debug: debug });\n  },\n  setDefaults: function setDefaults(defaultOptions) {\n    __WEBPACK_IMPORTED_MODULE_3_viewerjs___default.a.setDefaults(defaultOptions);\n  }\n});\n\n/***/ }),\n/* 5 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* unused harmony export throttle */\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return debounce; });\n\nfunction throttle(delay, noTrailing, callback, debounceMode) {\n  var timeoutID;\n  var cancelled = false;\n\n  var lastExec = 0;\n\n  function clearExistingTimeout() {\n    if (timeoutID) {\n      clearTimeout(timeoutID);\n    }\n  }\n\n  function cancel() {\n    clearExistingTimeout();\n    cancelled = true;\n  }\n\n  if (typeof noTrailing !== 'boolean') {\n    debounceMode = callback;\n    callback = noTrailing;\n    noTrailing = undefined;\n  }\n\n\n  function wrapper() {\n    var self = this;\n    var elapsed = Date.now() - lastExec;\n    var args = arguments;\n\n    if (cancelled) {\n      return;\n    }\n\n    function exec() {\n      lastExec = Date.now();\n      callback.apply(self, args);\n    }\n\n\n    function clear() {\n      timeoutID = undefined;\n    }\n\n    if (debounceMode && !timeoutID) {\n      exec();\n    }\n\n    clearExistingTimeout();\n\n    if (debounceMode === undefined && elapsed > delay) {\n      exec();\n    } else if (noTrailing !== true) {\n      timeoutID = setTimeout(debounceMode ? clear : exec, debounceMode === undefined ? delay - elapsed : delay);\n    }\n  }\n\n  wrapper.cancel = cancel;\n\n  return wrapper;\n}\n\nfunction debounce(delay, atBegin, callback) {\n  return callback === undefined ? throttle(delay, atBegin, false) : throttle(delay, callback, atBegin !== false);\n}\n\n\n\n/***/ }),\n/* 6 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_viewerjs__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_viewerjs___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_viewerjs__);\n\n\n\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n  props: {\n    images: {\n      type: Array\n    },\n    rebuild: {\n      type: Boolean,\n      default: false\n    },\n    trigger: {},\n    options: {\n      type: Object\n    }\n  },\n\n  data: function data() {\n    return {};\n  },\n\n\n  computed: {},\n\n  methods: {\n    onChange: function onChange() {\n      if (this.rebuild) {\n        this.rebuildViewer();\n      } else {\n        this.updateViewer();\n      }\n    },\n    rebuildViewer: function rebuildViewer() {\n      this.destroyViewer();\n      this.createViewer();\n    },\n    updateViewer: function updateViewer() {\n      if (this.$viewer) {\n        this.$viewer.update();\n        this.$emit('inited', this.$viewer);\n      } else {\n        this.createViewer();\n      }\n    },\n    destroyViewer: function destroyViewer() {\n      this.$viewer && this.$viewer.destroy();\n    },\n    createViewer: function createViewer() {\n      this.$viewer = new __WEBPACK_IMPORTED_MODULE_0_viewerjs___default.a(this.$el, this.options);\n      this.$emit('inited', this.$viewer);\n    }\n  },\n\n  watch: {\n    images: function images() {\n      var _this = this;\n\n      this.$nextTick(function () {\n        _this.onChange();\n      });\n    },\n\n    trigger: {\n      handler: function handler() {\n        var _this2 = this;\n\n        this.$nextTick(function () {\n          _this2.onChange();\n        });\n      },\n\n      deep: true\n    },\n    options: {\n      handler: function handler() {\n        var _this3 = this;\n\n        this.$nextTick(function () {\n          _this3.rebuildViewer();\n        });\n      },\n\n      deep: true\n    }\n  },\n\n  mounted: function mounted() {\n    this.createViewer();\n  },\n  destroyed: function destroyed() {\n    this.destroyViewer();\n  }\n});\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports) {\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar g;\n\ng = function () {\n\treturn this;\n}();\n\ntry {\n\tg = g || Function(\"return this\")() || (1, eval)(\"this\");\n} catch (e) {\n\tif ((typeof window === \"undefined\" ? \"undefined\" : _typeof(window)) === \"object\") g = window;\n}\n\nmodule.exports = g;\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports) {\n\n// this module is a runtime utility for cleaner component module output and will\n// be included in the final webpack user bundle\n\nmodule.exports = function normalizeComponent (\n  rawScriptExports,\n  compiledTemplate,\n  scopeId,\n  cssModules\n) {\n  var esModule\n  var scriptExports = rawScriptExports = rawScriptExports || {}\n\n  // ES6 modules interop\n  var type = typeof rawScriptExports.default\n  if (type === 'object' || type === 'function') {\n    esModule = rawScriptExports\n    scriptExports = rawScriptExports.default\n  }\n\n  // Vue.extend constructor export interop\n  var options = typeof scriptExports === 'function'\n    ? scriptExports.options\n    : scriptExports\n\n  // render functions\n  if (compiledTemplate) {\n    options.render = compiledTemplate.render\n    options.staticRenderFns = compiledTemplate.staticRenderFns\n  }\n\n  // scopedId\n  if (scopeId) {\n    options._scopeId = scopeId\n  }\n\n  // inject cssModules\n  if (cssModules) {\n    var computed = Object.create(options.computed || null)\n    Object.keys(cssModules).forEach(function (key) {\n      var module = cssModules[key]\n      computed[key] = function () { return module }\n    })\n    options.computed = computed\n  }\n\n  return {\n    esModule: esModule,\n    exports: scriptExports,\n    options: options\n  }\n}\n\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', [_vm._t(\"default\", null, {\n    \"images\": _vm.images,\n    \"options\": _vm.options\n  })], 2)\n},staticRenderFns: []}\nmodule.exports.render._withStripped = true\nif (false) {}\n\n/***/ })\n/******/ ]);\n});//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvdi12aWV3ZXIvZGlzdC92LXZpZXdlci5qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy92LXZpZXdlci9kaXN0L3Ytdmlld2VyLmpzPzY5NDQiXSwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHtcblx0aWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnKVxuXHRcdG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeShyZXF1aXJlKFwidmlld2VyanNcIikpO1xuXHRlbHNlIGlmKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZClcblx0XHRkZWZpbmUoW1widmlld2VyanNcIl0sIGZhY3RvcnkpO1xuXHRlbHNlIGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jylcblx0XHRleHBvcnRzW1wiVnVlVmlld2VyXCJdID0gZmFjdG9yeShyZXF1aXJlKFwidmlld2VyanNcIikpO1xuXHRlbHNlXG5cdFx0cm9vdFtcIlZ1ZVZpZXdlclwiXSA9IGZhY3Rvcnkocm9vdFtcIlZpZXdlclwiXSk7XG59KSh0aGlzLCBmdW5jdGlvbihfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFXzBfXykge1xucmV0dXJuIC8qKioqKiovIChmdW5jdGlvbihtb2R1bGVzKSB7IC8vIHdlYnBhY2tCb290c3RyYXBcbi8qKioqKiovIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbi8qKioqKiovIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbi8qKioqKiovIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuLyoqKioqKi8gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4vKioqKioqLyBcdFx0fVxuLyoqKioqKi8gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4vKioqKioqLyBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuLyoqKioqKi8gXHRcdFx0aTogbW9kdWxlSWQsXG4vKioqKioqLyBcdFx0XHRsOiBmYWxzZSxcbi8qKioqKiovIFx0XHRcdGV4cG9ydHM6IHt9XG4vKioqKioqLyBcdFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4vKioqKioqLyBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbi8qKioqKiovIFx0XHRtb2R1bGUubCA9IHRydWU7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4vKioqKioqLyBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuLyoqKioqKi8gXHR9XG4vKioqKioqL1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBpZGVudGl0eSBmdW5jdGlvbiBmb3IgY2FsbGluZyBoYXJtb255IGltcG9ydHMgd2l0aCB0aGUgY29ycmVjdCBjb250ZXh0XG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uaSA9IGZ1bmN0aW9uKHZhbHVlKSB7IHJldHVybiB2YWx1ZTsgfTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbi8qKioqKiovIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4vKioqKioqLyBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwge1xuLyoqKioqKi8gXHRcdFx0XHRjb25maWd1cmFibGU6IGZhbHNlLFxuLyoqKioqKi8gXHRcdFx0XHRlbnVtZXJhYmxlOiB0cnVlLFxuLyoqKioqKi8gXHRcdFx0XHRnZXQ6IGdldHRlclxuLyoqKioqKi8gXHRcdFx0fSk7XG4vKioqKioqLyBcdFx0fVxuLyoqKioqKi8gXHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4vKioqKioqLyBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4vKioqKioqLyBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuLyoqKioqKi8gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbi8qKioqKiovIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4vKioqKioqLyBcdFx0cmV0dXJuIGdldHRlcjtcbi8qKioqKiovIFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4vKioqKioqLyBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDQpO1xuLyoqKioqKi8gfSlcbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4vKioqKioqLyAoW1xuLyogMCAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5tb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfMF9fO1xuXG4vKioqLyB9KSxcbi8qIDEgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIF9fd2VicGFja19leHBvcnRzX18sIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXCJ1c2Ugc3RyaWN0XCI7XG4vKiBXRUJQQUNLIFZBUiBJTkpFQ1RJT04gKi8oZnVuY3Rpb24oZ2xvYmFsKSB7LyogaGFybW9ueSBpbXBvcnQgKi8gdmFyIF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF92aWV3ZXJqc19fID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcbi8qIGhhcm1vbnkgaW1wb3J0ICovIHZhciBfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfdmlld2VyanNfX19kZWZhdWx0ID0gX193ZWJwYWNrX3JlcXVpcmVfXy5uKF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF92aWV3ZXJqc19fKTtcbi8qIGhhcm1vbnkgaW1wb3J0ICovIHZhciBfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzFfdGhyb3R0bGVfZGVib3VuY2VfXyA9IF9fd2VicGFja19yZXF1aXJlX18oNSk7XG5cblxuXG52YXIgaW5zdGFsbCA9IGZ1bmN0aW9uIGluc3RhbGwoVnVlLCBfcmVmKSB7XG4gIHZhciBfcmVmJG5hbWUgPSBfcmVmLm5hbWUsXG4gICAgICBuYW1lID0gX3JlZiRuYW1lID09PSB1bmRlZmluZWQgPyAndmlld2VyJyA6IF9yZWYkbmFtZSxcbiAgICAgIF9yZWYkZGVidWcgPSBfcmVmLmRlYnVnLFxuICAgICAgZGVidWcgPSBfcmVmJGRlYnVnID09PSB1bmRlZmluZWQgPyBmYWxzZSA6IF9yZWYkZGVidWc7XG5cbiAgZnVuY3Rpb24gY3JlYXRlVmlld2VyKGVsLCBvcHRpb25zKSB7XG4gICAgdmFyIHJlYnVpbGQgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IGZhbHNlO1xuXG4gICAgVnVlLm5leHRUaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmIChyZWJ1aWxkIHx8ICFlbFsnJCcgKyBuYW1lXSkge1xuICAgICAgICBkZXN0cm95Vmlld2VyKGVsKTtcbiAgICAgICAgZWxbJyQnICsgbmFtZV0gPSBuZXcgX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX3ZpZXdlcmpzX19fZGVmYXVsdC5hKGVsLCBvcHRpb25zKTtcbiAgICAgICAgbG9nKCd2aWV3ZXIgY3JlYXRlZCcpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZWxbJyQnICsgbmFtZV0udXBkYXRlKCk7XG4gICAgICAgIGxvZygndmlld2VyIHVwZGF0ZWQnKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGNyZWF0ZU9ic2VydmVyKGVsLCBvcHRpb25zLCBkZWJvdW5jZWRDcmVhdGVWaWV3ZXIsIHJlYnVpbGQpIHtcbiAgICBkZXN0cm95T2JzZXJ2ZXIoZWwpO1xuICAgIHZhciBNdXRhdGlvbk9ic2VydmVyID0gZ2xvYmFsLk11dGF0aW9uT2JzZXJ2ZXIgfHwgZ2xvYmFsLldlYktpdE11dGF0aW9uT2JzZXJ2ZXIgfHwgZ2xvYmFsLk1vek11dGF0aW9uT2JzZXJ2ZXI7XG4gICAgaWYgKCFNdXRhdGlvbk9ic2VydmVyKSB7XG4gICAgICBsb2coJ29ic2VydmVyIG5vdCBzdXBwb3J0ZWQnKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIG9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoZnVuY3Rpb24gKG11dGF0aW9ucykge1xuICAgICAgbXV0YXRpb25zLmZvckVhY2goZnVuY3Rpb24gKG11dGF0aW9uKSB7XG4gICAgICAgIGxvZygndmlld2VyIG11dGF0aW9uOicgKyBtdXRhdGlvbi50eXBlKTtcbiAgICAgICAgZGVib3VuY2VkQ3JlYXRlVmlld2VyKGVsLCBvcHRpb25zLCByZWJ1aWxkKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICAgIHZhciBjb25maWcgPSB7IGF0dHJpYnV0ZXM6IHRydWUsIGNoaWxkTGlzdDogdHJ1ZSwgY2hhcmFjdGVyRGF0YTogdHJ1ZSwgc3VidHJlZTogdHJ1ZSB9O1xuICAgIG9ic2VydmVyLm9ic2VydmUoZWwsIGNvbmZpZyk7XG4gICAgZWxbJyR2aWV3ZXJNdXRhdGlvbk9ic2VydmVyJ10gPSBvYnNlcnZlcjtcbiAgICBsb2coJ29ic2VydmVyIGNyZWF0ZWQnKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGNyZWF0ZVdhdGNoZXIoZWwsIF9yZWYyLCB2bm9kZSwgZGVib3VuY2VkQ3JlYXRlVmlld2VyKSB7XG4gICAgdmFyIGV4cHJlc3Npb24gPSBfcmVmMi5leHByZXNzaW9uO1xuXG4gICAgdmFyIHNpbXBsZVBhdGhSRSA9IC9eW0EtWmEtel8kXVtcXHckXSooPzpcXC5bQS1aYS16XyRdW1xcdyRdKnxcXFsnW14nXSo/J118XFxbXCJbXlwiXSo/XCJdfFxcW1xcZCtdfFxcW1tBLVphLXpfJF1bXFx3JF0qXSkqJC87XG4gICAgaWYgKCFleHByZXNzaW9uIHx8ICFzaW1wbGVQYXRoUkUudGVzdChleHByZXNzaW9uKSkge1xuICAgICAgbG9nKCdvbmx5IHNpbXBsZSBkb3QtZGVsaW1pdGVkIHBhdGhzIGNhbiBjcmVhdGUgd2F0Y2hlcicpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBlbFsnJHZpZXdlclVud2F0Y2gnXSA9IHZub2RlLmNvbnRleHQuJHdhdGNoKGV4cHJlc3Npb24sIGZ1bmN0aW9uIChuZXdWYWwsIG9sZFZhbCkge1xuICAgICAgbG9nKCdjaGFuZ2UgZGV0ZWN0ZWQgYnkgd2F0Y2hlcjogJywgZXhwcmVzc2lvbik7XG4gICAgICBkZWJvdW5jZWRDcmVhdGVWaWV3ZXIoZWwsIG5ld1ZhbCwgdHJ1ZSk7XG4gICAgfSwge1xuICAgICAgZGVlcDogdHJ1ZVxuICAgIH0pO1xuICAgIGxvZygnd2F0Y2hlciBjcmVhdGVkLCBleHByZXNzaW9uOiAnLCBleHByZXNzaW9uKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGRlc3Ryb3lWaWV3ZXIoZWwpIHtcbiAgICBpZiAoIWVsWyckJyArIG5hbWVdKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGVsWyckJyArIG5hbWVdLmRlc3Ryb3koKTtcbiAgICBkZWxldGUgZWxbJyQnICsgbmFtZV07XG4gICAgbG9nKCd2aWV3ZXIgZGVzdHJveWVkJyk7XG4gIH1cblxuICBmdW5jdGlvbiBkZXN0cm95T2JzZXJ2ZXIoZWwpIHtcbiAgICBpZiAoIWVsWyckdmlld2VyTXV0YXRpb25PYnNlcnZlciddKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGVsWyckdmlld2VyTXV0YXRpb25PYnNlcnZlciddLmRpc2Nvbm5lY3QoKTtcbiAgICBkZWxldGUgZWxbJyR2aWV3ZXJNdXRhdGlvbk9ic2VydmVyJ107XG4gICAgbG9nKCdvYnNlcnZlciBkZXN0cm95ZWQnKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGRlc3Ryb3lXYXRjaGVyKGVsKSB7XG4gICAgaWYgKCFlbFsnJHZpZXdlclVud2F0Y2gnXSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBlbFsnJHZpZXdlclVud2F0Y2gnXSgpO1xuICAgIGRlbGV0ZSBlbFsnJHZpZXdlclVud2F0Y2gnXTtcbiAgICBsb2coJ3dhdGNoZXIgZGVzdHJveWVkJyk7XG4gIH1cblxuICBmdW5jdGlvbiBsb2coKSB7XG4gICAgdmFyIF9jb25zb2xlO1xuXG4gICAgZGVidWcgJiYgKF9jb25zb2xlID0gY29uc29sZSkubG9nLmFwcGx5KF9jb25zb2xlLCBhcmd1bWVudHMpO1xuICB9XG5cbiAgVnVlLmRpcmVjdGl2ZSgndmlld2VyJywge1xuICAgIGJpbmQ6IGZ1bmN0aW9uIGJpbmQoZWwsIGJpbmRpbmcsIHZub2RlKSB7XG4gICAgICBsb2coJ3ZpZXdlciBiaW5kJyk7XG4gICAgICB2YXIgZGVib3VuY2VkQ3JlYXRlVmlld2VyID0gX193ZWJwYWNrX3JlcXVpcmVfXy5pKF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMV90aHJvdHRsZV9kZWJvdW5jZV9fW1wiYVwiIC8qIGRlYm91bmNlICovXSkoNTAsIGNyZWF0ZVZpZXdlcik7XG4gICAgICBkZWJvdW5jZWRDcmVhdGVWaWV3ZXIoZWwsIGJpbmRpbmcudmFsdWUpO1xuXG4gICAgICBjcmVhdGVXYXRjaGVyKGVsLCBiaW5kaW5nLCB2bm9kZSwgZGVib3VuY2VkQ3JlYXRlVmlld2VyKTtcblxuICAgICAgaWYgKCFiaW5kaW5nLm1vZGlmaWVycy5zdGF0aWMpIHtcbiAgICAgICAgY3JlYXRlT2JzZXJ2ZXIoZWwsIGJpbmRpbmcudmFsdWUsIGRlYm91bmNlZENyZWF0ZVZpZXdlciwgYmluZGluZy5tb2RpZmllcnMucmVidWlsZCk7XG4gICAgICB9XG4gICAgfSxcbiAgICB1bmJpbmQ6IGZ1bmN0aW9uIHVuYmluZChlbCwgYmluZGluZykge1xuICAgICAgbG9nKCd2aWV3ZXIgdW5iaW5kJyk7XG5cbiAgICAgIGRlc3Ryb3lPYnNlcnZlcihlbCk7XG5cbiAgICAgIGRlc3Ryb3lXYXRjaGVyKGVsKTtcblxuICAgICAgZGVzdHJveVZpZXdlcihlbCk7XG4gICAgfVxuICB9KTtcbn07XG5cbi8qIGhhcm1vbnkgZGVmYXVsdCBleHBvcnQgKi8gX193ZWJwYWNrX2V4cG9ydHNfX1tcImFcIl0gPSAoe1xuICBpbnN0YWxsOiBpbnN0YWxsXG59KTtcbi8qIFdFQlBBQ0sgVkFSIElOSkVDVElPTiAqL30uY2FsbChfX3dlYnBhY2tfZXhwb3J0c19fLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpKSlcblxuLyoqKi8gfSksXG4vKiAyICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBfX3dlYnBhY2tfZXhwb3J0c19fLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblwidXNlIHN0cmljdFwiO1xuLyogaGFybW9ueSBleHBvcnQgKGltbXV0YWJsZSkgKi8gX193ZWJwYWNrX2V4cG9ydHNfX1tcImFcIl0gPSBleHRlbmQ7XG5cbmZ1bmN0aW9uIGV4dGVuZCgpIHtcbiAgdmFyIGV4dGVuZGVkID0ge307XG4gIHZhciBkZWVwID0gZmFsc2U7XG4gIHZhciBpID0gMDtcbiAgdmFyIGxlbmd0aCA9IGFyZ3VtZW50cy5sZW5ndGg7XG5cbiAgaWYgKE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChhcmd1bWVudHNbMF0pID09PSAnW29iamVjdCBCb29sZWFuXScpIHtcbiAgICBkZWVwID0gYXJndW1lbnRzWzBdO1xuICAgIGkrKztcbiAgfVxuXG4gIGZ1bmN0aW9uIG1lcmdlKG9iaikge1xuICAgIGZvciAodmFyIHByb3AgaW4gb2JqKSB7XG4gICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCkpIHtcbiAgICAgICAgaWYgKGRlZXAgJiYgT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG9ialtwcm9wXSkgPT09ICdbb2JqZWN0IE9iamVjdF0nKSB7XG4gICAgICAgICAgZXh0ZW5kZWRbcHJvcF0gPSBleHRlbmQodHJ1ZSwgZXh0ZW5kZWRbcHJvcF0sIG9ialtwcm9wXSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZXh0ZW5kZWRbcHJvcF0gPSBvYmpbcHJvcF07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBmb3IgKDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgdmFyIG9iaiA9IGFyZ3VtZW50c1tpXTtcbiAgICBtZXJnZShvYmopO1xuICB9XG5cbiAgcmV0dXJuIGV4dGVuZGVkO1xufVxuXG4vKioqLyB9KSxcbi8qIDMgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxudmFyIENvbXBvbmVudCA9IF9fd2VicGFja19yZXF1aXJlX18oOCkoXG4gIC8qIHNjcmlwdCAqL1xuICBfX3dlYnBhY2tfcmVxdWlyZV9fKDYpLFxuICAvKiB0ZW1wbGF0ZSAqL1xuICBfX3dlYnBhY2tfcmVxdWlyZV9fKDkpLFxuICAvKiBzY29wZUlkICovXG4gIG51bGwsXG4gIC8qIGNzc01vZHVsZXMgKi9cbiAgbnVsbFxuKVxuQ29tcG9uZW50Lm9wdGlvbnMuX19maWxlID0gXCJDOlxcXFxXb3Jrc3BhY2VzXFxcXFdlYlxcXFxHaXRcXFxcdi12aWV3ZXJcXFxcc3JjXFxcXGNvbXBvbmVudC52dWVcIlxuaWYgKENvbXBvbmVudC5lc01vZHVsZSAmJiBPYmplY3Qua2V5cyhDb21wb25lbnQuZXNNb2R1bGUpLnNvbWUoZnVuY3Rpb24gKGtleSkge3JldHVybiBrZXkgIT09IFwiZGVmYXVsdFwiICYmIGtleSAhPT0gXCJfX2VzTW9kdWxlXCJ9KSkge2NvbnNvbGUuZXJyb3IoXCJuYW1lZCBleHBvcnRzIGFyZSBub3Qgc3VwcG9ydGVkIGluICoudnVlIGZpbGVzLlwiKX1cbmlmIChDb21wb25lbnQub3B0aW9ucy5mdW5jdGlvbmFsKSB7Y29uc29sZS5lcnJvcihcIlt2dWUtbG9hZGVyXSBjb21wb25lbnQudnVlOiBmdW5jdGlvbmFsIGNvbXBvbmVudHMgYXJlIG5vdCBzdXBwb3J0ZWQgd2l0aCB0ZW1wbGF0ZXMsIHRoZXkgc2hvdWxkIHVzZSByZW5kZXIgZnVuY3Rpb25zLlwiKX1cblxuLyogaG90IHJlbG9hZCAqL1xuaWYgKGZhbHNlKSB7KGZ1bmN0aW9uICgpIHtcbiAgdmFyIGhvdEFQSSA9IHJlcXVpcmUoXCJ2dWUtaG90LXJlbG9hZC1hcGlcIilcbiAgaG90QVBJLmluc3RhbGwocmVxdWlyZShcInZ1ZVwiKSwgZmFsc2UpXG4gIGlmICghaG90QVBJLmNvbXBhdGlibGUpIHJldHVyblxuICBtb2R1bGUuaG90LmFjY2VwdCgpXG4gIGlmICghbW9kdWxlLmhvdC5kYXRhKSB7XG4gICAgaG90QVBJLmNyZWF0ZVJlY29yZChcImRhdGEtdi0zMDkxMDE0Y1wiLCBDb21wb25lbnQub3B0aW9ucylcbiAgfSBlbHNlIHtcbiAgICBob3RBUEkucmVsb2FkKFwiZGF0YS12LTMwOTEwMTRjXCIsIENvbXBvbmVudC5vcHRpb25zKVxuICB9XG59KSgpfVxuXG5tb2R1bGUuZXhwb3J0cyA9IENvbXBvbmVudC5leHBvcnRzXG5cblxuLyoqKi8gfSksXG4vKiA0ICovXG4vKioqLyAoZnVuY3Rpb24obW9kdWxlLCBfX3dlYnBhY2tfZXhwb3J0c19fLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KF9fd2VicGFja19leHBvcnRzX18sIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuLyogaGFybW9ueSBpbXBvcnQgKi8gdmFyIF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fdXRpbHNfXyA9IF9fd2VicGFja19yZXF1aXJlX18oMik7XG4vKiBoYXJtb255IGltcG9ydCAqLyB2YXIgX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX19jb21wb25lbnRfdnVlX18gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpO1xuLyogaGFybW9ueSBpbXBvcnQgKi8gdmFyIF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMV9fY29tcG9uZW50X3Z1ZV9fX2RlZmF1bHQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLm4oX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX19jb21wb25lbnRfdnVlX18pO1xuLyogaGFybW9ueSBpbXBvcnQgKi8gdmFyIF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMl9fZGlyZWN0aXZlX18gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpO1xuLyogaGFybW9ueSBpbXBvcnQgKi8gdmFyIF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfM192aWV3ZXJqc19fID0gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcbi8qIGhhcm1vbnkgaW1wb3J0ICovIHZhciBfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzNfdmlld2VyanNfX19kZWZhdWx0ID0gX193ZWJwYWNrX3JlcXVpcmVfXy5uKF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfM192aWV3ZXJqc19fKTtcblxuXG5cblxuXG4vKiBoYXJtb255IGRlZmF1bHQgZXhwb3J0ICovIF9fd2VicGFja19leHBvcnRzX19bXCJkZWZhdWx0XCJdID0gKHtcbiAgaW5zdGFsbDogZnVuY3Rpb24gaW5zdGFsbChWdWUpIHtcbiAgICB2YXIgX3JlZiA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge30sXG4gICAgICAgIF9yZWYkbmFtZSA9IF9yZWYubmFtZSxcbiAgICAgICAgbmFtZSA9IF9yZWYkbmFtZSA9PT0gdW5kZWZpbmVkID8gJ3ZpZXdlcicgOiBfcmVmJG5hbWUsXG4gICAgICAgIF9yZWYkZGVidWcgPSBfcmVmLmRlYnVnLFxuICAgICAgICBkZWJ1ZyA9IF9yZWYkZGVidWcgPT09IHVuZGVmaW5lZCA/IGZhbHNlIDogX3JlZiRkZWJ1ZyxcbiAgICAgICAgZGVmYXVsdE9wdGlvbnMgPSBfcmVmLmRlZmF1bHRPcHRpb25zO1xuXG4gICAgX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8zX3ZpZXdlcmpzX19fZGVmYXVsdC5hLnNldERlZmF1bHRzKGRlZmF1bHRPcHRpb25zKTtcblxuICAgIFZ1ZS5jb21wb25lbnQobmFtZSwgX193ZWJwYWNrX3JlcXVpcmVfXy5pKF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF9fdXRpbHNfX1tcImFcIiAvKiBleHRlbmQgKi9dKShfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzFfX2NvbXBvbmVudF92dWVfX19kZWZhdWx0LmEsIHsgbmFtZTogbmFtZSB9KSk7XG4gICAgVnVlLnVzZShfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzJfX2RpcmVjdGl2ZV9fW1wiYVwiIC8qIGRlZmF1bHQgKi9dLCB7IG5hbWU6IG5hbWUsIGRlYnVnOiBkZWJ1ZyB9KTtcbiAgfSxcbiAgc2V0RGVmYXVsdHM6IGZ1bmN0aW9uIHNldERlZmF1bHRzKGRlZmF1bHRPcHRpb25zKSB7XG4gICAgX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8zX3ZpZXdlcmpzX19fZGVmYXVsdC5hLnNldERlZmF1bHRzKGRlZmF1bHRPcHRpb25zKTtcbiAgfVxufSk7XG5cbi8qKiovIH0pLFxuLyogNSAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgX193ZWJwYWNrX2V4cG9ydHNfXywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cInVzZSBzdHJpY3RcIjtcbi8qIHVudXNlZCBoYXJtb255IGV4cG9ydCB0aHJvdHRsZSAqL1xuLyogaGFybW9ueSBleHBvcnQgKGJpbmRpbmcpICovIF9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcImFcIiwgZnVuY3Rpb24oKSB7IHJldHVybiBkZWJvdW5jZTsgfSk7XG5cbmZ1bmN0aW9uIHRocm90dGxlKGRlbGF5LCBub1RyYWlsaW5nLCBjYWxsYmFjaywgZGVib3VuY2VNb2RlKSB7XG4gIHZhciB0aW1lb3V0SUQ7XG4gIHZhciBjYW5jZWxsZWQgPSBmYWxzZTtcblxuICB2YXIgbGFzdEV4ZWMgPSAwO1xuXG4gIGZ1bmN0aW9uIGNsZWFyRXhpc3RpbmdUaW1lb3V0KCkge1xuICAgIGlmICh0aW1lb3V0SUQpIHtcbiAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0SUQpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGNhbmNlbCgpIHtcbiAgICBjbGVhckV4aXN0aW5nVGltZW91dCgpO1xuICAgIGNhbmNlbGxlZCA9IHRydWU7XG4gIH1cblxuICBpZiAodHlwZW9mIG5vVHJhaWxpbmcgIT09ICdib29sZWFuJykge1xuICAgIGRlYm91bmNlTW9kZSA9IGNhbGxiYWNrO1xuICAgIGNhbGxiYWNrID0gbm9UcmFpbGluZztcbiAgICBub1RyYWlsaW5nID0gdW5kZWZpbmVkO1xuICB9XG5cblxuICBmdW5jdGlvbiB3cmFwcGVyKCkge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB2YXIgZWxhcHNlZCA9IERhdGUubm93KCkgLSBsYXN0RXhlYztcbiAgICB2YXIgYXJncyA9IGFyZ3VtZW50cztcblxuICAgIGlmIChjYW5jZWxsZWQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBleGVjKCkge1xuICAgICAgbGFzdEV4ZWMgPSBEYXRlLm5vdygpO1xuICAgICAgY2FsbGJhY2suYXBwbHkoc2VsZiwgYXJncyk7XG4gICAgfVxuXG5cbiAgICBmdW5jdGlvbiBjbGVhcigpIHtcbiAgICAgIHRpbWVvdXRJRCA9IHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICBpZiAoZGVib3VuY2VNb2RlICYmICF0aW1lb3V0SUQpIHtcbiAgICAgIGV4ZWMoKTtcbiAgICB9XG5cbiAgICBjbGVhckV4aXN0aW5nVGltZW91dCgpO1xuXG4gICAgaWYgKGRlYm91bmNlTW9kZSA9PT0gdW5kZWZpbmVkICYmIGVsYXBzZWQgPiBkZWxheSkge1xuICAgICAgZXhlYygpO1xuICAgIH0gZWxzZSBpZiAobm9UcmFpbGluZyAhPT0gdHJ1ZSkge1xuICAgICAgdGltZW91dElEID0gc2V0VGltZW91dChkZWJvdW5jZU1vZGUgPyBjbGVhciA6IGV4ZWMsIGRlYm91bmNlTW9kZSA9PT0gdW5kZWZpbmVkID8gZGVsYXkgLSBlbGFwc2VkIDogZGVsYXkpO1xuICAgIH1cbiAgfVxuXG4gIHdyYXBwZXIuY2FuY2VsID0gY2FuY2VsO1xuXG4gIHJldHVybiB3cmFwcGVyO1xufVxuXG5mdW5jdGlvbiBkZWJvdW5jZShkZWxheSwgYXRCZWdpbiwgY2FsbGJhY2spIHtcbiAgcmV0dXJuIGNhbGxiYWNrID09PSB1bmRlZmluZWQgPyB0aHJvdHRsZShkZWxheSwgYXRCZWdpbiwgZmFsc2UpIDogdGhyb3R0bGUoZGVsYXksIGNhbGxiYWNrLCBhdEJlZ2luICE9PSBmYWxzZSk7XG59XG5cblxuXG4vKioqLyB9KSxcbi8qIDYgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIF9fd2VicGFja19leHBvcnRzX18sIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoX193ZWJwYWNrX2V4cG9ydHNfXywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG4vKiBoYXJtb255IGltcG9ydCAqLyB2YXIgX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX3ZpZXdlcmpzX18gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDApO1xuLyogaGFybW9ueSBpbXBvcnQgKi8gdmFyIF9fV0VCUEFDS19JTVBPUlRFRF9NT0RVTEVfMF92aWV3ZXJqc19fX2RlZmF1bHQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLm4oX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX3ZpZXdlcmpzX18pO1xuXG5cblxuXG4vKiBoYXJtb255IGRlZmF1bHQgZXhwb3J0ICovIF9fd2VicGFja19leHBvcnRzX19bXCJkZWZhdWx0XCJdID0gKHtcbiAgcHJvcHM6IHtcbiAgICBpbWFnZXM6IHtcbiAgICAgIHR5cGU6IEFycmF5XG4gICAgfSxcbiAgICByZWJ1aWxkOiB7XG4gICAgICB0eXBlOiBCb29sZWFuLFxuICAgICAgZGVmYXVsdDogZmFsc2VcbiAgICB9LFxuICAgIHRyaWdnZXI6IHt9LFxuICAgIG9wdGlvbnM6IHtcbiAgICAgIHR5cGU6IE9iamVjdFxuICAgIH1cbiAgfSxcblxuICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkge1xuICAgIHJldHVybiB7fTtcbiAgfSxcblxuXG4gIGNvbXB1dGVkOiB7fSxcblxuICBtZXRob2RzOiB7XG4gICAgb25DaGFuZ2U6IGZ1bmN0aW9uIG9uQ2hhbmdlKCkge1xuICAgICAgaWYgKHRoaXMucmVidWlsZCkge1xuICAgICAgICB0aGlzLnJlYnVpbGRWaWV3ZXIoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMudXBkYXRlVmlld2VyKCk7XG4gICAgICB9XG4gICAgfSxcbiAgICByZWJ1aWxkVmlld2VyOiBmdW5jdGlvbiByZWJ1aWxkVmlld2VyKCkge1xuICAgICAgdGhpcy5kZXN0cm95Vmlld2VyKCk7XG4gICAgICB0aGlzLmNyZWF0ZVZpZXdlcigpO1xuICAgIH0sXG4gICAgdXBkYXRlVmlld2VyOiBmdW5jdGlvbiB1cGRhdGVWaWV3ZXIoKSB7XG4gICAgICBpZiAodGhpcy4kdmlld2VyKSB7XG4gICAgICAgIHRoaXMuJHZpZXdlci51cGRhdGUoKTtcbiAgICAgICAgdGhpcy4kZW1pdCgnaW5pdGVkJywgdGhpcy4kdmlld2VyKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuY3JlYXRlVmlld2VyKCk7XG4gICAgICB9XG4gICAgfSxcbiAgICBkZXN0cm95Vmlld2VyOiBmdW5jdGlvbiBkZXN0cm95Vmlld2VyKCkge1xuICAgICAgdGhpcy4kdmlld2VyICYmIHRoaXMuJHZpZXdlci5kZXN0cm95KCk7XG4gICAgfSxcbiAgICBjcmVhdGVWaWV3ZXI6IGZ1bmN0aW9uIGNyZWF0ZVZpZXdlcigpIHtcbiAgICAgIHRoaXMuJHZpZXdlciA9IG5ldyBfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfdmlld2VyanNfX19kZWZhdWx0LmEodGhpcy4kZWwsIHRoaXMub3B0aW9ucyk7XG4gICAgICB0aGlzLiRlbWl0KCdpbml0ZWQnLCB0aGlzLiR2aWV3ZXIpO1xuICAgIH1cbiAgfSxcblxuICB3YXRjaDoge1xuICAgIGltYWdlczogZnVuY3Rpb24gaW1hZ2VzKCkge1xuICAgICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgICAgdGhpcy4kbmV4dFRpY2soZnVuY3Rpb24gKCkge1xuICAgICAgICBfdGhpcy5vbkNoYW5nZSgpO1xuICAgICAgfSk7XG4gICAgfSxcblxuICAgIHRyaWdnZXI6IHtcbiAgICAgIGhhbmRsZXI6IGZ1bmN0aW9uIGhhbmRsZXIoKSB7XG4gICAgICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gICAgICAgIHRoaXMuJG5leHRUaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBfdGhpczIub25DaGFuZ2UoKTtcbiAgICAgICAgfSk7XG4gICAgICB9LFxuXG4gICAgICBkZWVwOiB0cnVlXG4gICAgfSxcbiAgICBvcHRpb25zOiB7XG4gICAgICBoYW5kbGVyOiBmdW5jdGlvbiBoYW5kbGVyKCkge1xuICAgICAgICB2YXIgX3RoaXMzID0gdGhpcztcblxuICAgICAgICB0aGlzLiRuZXh0VGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgX3RoaXMzLnJlYnVpbGRWaWV3ZXIoKTtcbiAgICAgICAgfSk7XG4gICAgICB9LFxuXG4gICAgICBkZWVwOiB0cnVlXG4gICAgfVxuICB9LFxuXG4gIG1vdW50ZWQ6IGZ1bmN0aW9uIG1vdW50ZWQoKSB7XG4gICAgdGhpcy5jcmVhdGVWaWV3ZXIoKTtcbiAgfSxcbiAgZGVzdHJveWVkOiBmdW5jdGlvbiBkZXN0cm95ZWQoKSB7XG4gICAgdGhpcy5kZXN0cm95Vmlld2VyKCk7XG4gIH1cbn0pO1xuXG4vKioqLyB9KSxcbi8qIDcgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxudmFyIF90eXBlb2YgPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gXCJzeW1ib2xcIiA/IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH0gOiBmdW5jdGlvbiAob2JqKSB7IHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/IFwic3ltYm9sXCIgOiB0eXBlb2Ygb2JqOyB9O1xuXG52YXIgZztcblxuZyA9IGZ1bmN0aW9uICgpIHtcblx0cmV0dXJuIHRoaXM7XG59KCk7XG5cbnRyeSB7XG5cdGcgPSBnIHx8IEZ1bmN0aW9uKFwicmV0dXJuIHRoaXNcIikoKSB8fCAoMSwgZXZhbCkoXCJ0aGlzXCIpO1xufSBjYXRjaCAoZSkge1xuXHRpZiAoKHR5cGVvZiB3aW5kb3cgPT09IFwidW5kZWZpbmVkXCIgPyBcInVuZGVmaW5lZFwiIDogX3R5cGVvZih3aW5kb3cpKSA9PT0gXCJvYmplY3RcIikgZyA9IHdpbmRvdztcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBnO1xuXG4vKioqLyB9KSxcbi8qIDggKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuLy8gdGhpcyBtb2R1bGUgaXMgYSBydW50aW1lIHV0aWxpdHkgZm9yIGNsZWFuZXIgY29tcG9uZW50IG1vZHVsZSBvdXRwdXQgYW5kIHdpbGxcbi8vIGJlIGluY2x1ZGVkIGluIHRoZSBmaW5hbCB3ZWJwYWNrIHVzZXIgYnVuZGxlXG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gbm9ybWFsaXplQ29tcG9uZW50IChcbiAgcmF3U2NyaXB0RXhwb3J0cyxcbiAgY29tcGlsZWRUZW1wbGF0ZSxcbiAgc2NvcGVJZCxcbiAgY3NzTW9kdWxlc1xuKSB7XG4gIHZhciBlc01vZHVsZVxuICB2YXIgc2NyaXB0RXhwb3J0cyA9IHJhd1NjcmlwdEV4cG9ydHMgPSByYXdTY3JpcHRFeHBvcnRzIHx8IHt9XG5cbiAgLy8gRVM2IG1vZHVsZXMgaW50ZXJvcFxuICB2YXIgdHlwZSA9IHR5cGVvZiByYXdTY3JpcHRFeHBvcnRzLmRlZmF1bHRcbiAgaWYgKHR5cGUgPT09ICdvYmplY3QnIHx8IHR5cGUgPT09ICdmdW5jdGlvbicpIHtcbiAgICBlc01vZHVsZSA9IHJhd1NjcmlwdEV4cG9ydHNcbiAgICBzY3JpcHRFeHBvcnRzID0gcmF3U2NyaXB0RXhwb3J0cy5kZWZhdWx0XG4gIH1cblxuICAvLyBWdWUuZXh0ZW5kIGNvbnN0cnVjdG9yIGV4cG9ydCBpbnRlcm9wXG4gIHZhciBvcHRpb25zID0gdHlwZW9mIHNjcmlwdEV4cG9ydHMgPT09ICdmdW5jdGlvbidcbiAgICA/IHNjcmlwdEV4cG9ydHMub3B0aW9uc1xuICAgIDogc2NyaXB0RXhwb3J0c1xuXG4gIC8vIHJlbmRlciBmdW5jdGlvbnNcbiAgaWYgKGNvbXBpbGVkVGVtcGxhdGUpIHtcbiAgICBvcHRpb25zLnJlbmRlciA9IGNvbXBpbGVkVGVtcGxhdGUucmVuZGVyXG4gICAgb3B0aW9ucy5zdGF0aWNSZW5kZXJGbnMgPSBjb21waWxlZFRlbXBsYXRlLnN0YXRpY1JlbmRlckZuc1xuICB9XG5cbiAgLy8gc2NvcGVkSWRcbiAgaWYgKHNjb3BlSWQpIHtcbiAgICBvcHRpb25zLl9zY29wZUlkID0gc2NvcGVJZFxuICB9XG5cbiAgLy8gaW5qZWN0IGNzc01vZHVsZXNcbiAgaWYgKGNzc01vZHVsZXMpIHtcbiAgICB2YXIgY29tcHV0ZWQgPSBPYmplY3QuY3JlYXRlKG9wdGlvbnMuY29tcHV0ZWQgfHwgbnVsbClcbiAgICBPYmplY3Qua2V5cyhjc3NNb2R1bGVzKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgIHZhciBtb2R1bGUgPSBjc3NNb2R1bGVzW2tleV1cbiAgICAgIGNvbXB1dGVkW2tleV0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiBtb2R1bGUgfVxuICAgIH0pXG4gICAgb3B0aW9ucy5jb21wdXRlZCA9IGNvbXB1dGVkXG4gIH1cblxuICByZXR1cm4ge1xuICAgIGVzTW9kdWxlOiBlc01vZHVsZSxcbiAgICBleHBvcnRzOiBzY3JpcHRFeHBvcnRzLFxuICAgIG9wdGlvbnM6IG9wdGlvbnNcbiAgfVxufVxuXG5cbi8qKiovIH0pLFxuLyogOSAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5tb2R1bGUuZXhwb3J0cz17cmVuZGVyOmZ1bmN0aW9uICgpe3ZhciBfdm09dGhpczt2YXIgX2g9X3ZtLiRjcmVhdGVFbGVtZW50O3ZhciBfYz1fdm0uX3NlbGYuX2N8fF9oO1xuICByZXR1cm4gX2MoJ2RpdicsIFtfdm0uX3QoXCJkZWZhdWx0XCIsIG51bGwsIHtcbiAgICBcImltYWdlc1wiOiBfdm0uaW1hZ2VzLFxuICAgIFwib3B0aW9uc1wiOiBfdm0ub3B0aW9uc1xuICB9KV0sIDIpXG59LHN0YXRpY1JlbmRlckZuczogW119XG5tb2R1bGUuZXhwb3J0cy5yZW5kZXIuX3dpdGhTdHJpcHBlZCA9IHRydWVcbmlmIChmYWxzZSkge1xuICBtb2R1bGUuaG90LmFjY2VwdCgpXG4gIGlmIChtb2R1bGUuaG90LmRhdGEpIHtcbiAgICAgcmVxdWlyZShcInZ1ZS1ob3QtcmVsb2FkLWFwaVwiKS5yZXJlbmRlcihcImRhdGEtdi0zMDkxMDE0Y1wiLCBtb2R1bGUuZXhwb3J0cylcbiAgfVxufVxuXG4vKioqLyB9KVxuLyoqKioqKi8gXSk7XG59KTsiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBLFFBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBVUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/v-viewer/dist/v-viewer.js\n");

/***/ }),

/***/ "./node_modules/viewerjs/dist/viewer.css":
/*!***********************************************!*\
  !*** ./node_modules/viewerjs/dist/viewer.css ***!
  \***********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = __webpack_require__(/*! !../../css-loader??ref--6-oneOf-3-1!../../postcss-loader/src??ref--6-oneOf-3-2!./viewer.css */ \"./node_modules/css-loader/index.js?!./node_modules/postcss-loader/src/index.js?!./node_modules/viewerjs/dist/viewer.css\");\nif(typeof content === 'string') content = [[module.i, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = __webpack_require__(/*! ../../vue-style-loader/lib/addStylesClient.js */ \"./node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"6431b66b\", content, false, {\"sourceMap\":false,\"shadowMode\":false});\n// Hot Module Replacement\nif(true) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(/*! !../../css-loader??ref--6-oneOf-3-1!../../postcss-loader/src??ref--6-oneOf-3-2!./viewer.css */ \"./node_modules/css-loader/index.js?!./node_modules/postcss-loader/src/index.js?!./node_modules/viewerjs/dist/viewer.css\", function() {\n     var newContent = __webpack_require__(/*! !../../css-loader??ref--6-oneOf-3-1!../../postcss-loader/src??ref--6-oneOf-3-2!./viewer.css */ \"./node_modules/css-loader/index.js?!./node_modules/postcss-loader/src/index.js?!./node_modules/viewerjs/dist/viewer.css\");\n     if(typeof newContent === 'string') newContent = [[module.i, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvdmlld2VyanMvZGlzdC92aWV3ZXIuY3NzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL3ZpZXdlcmpzL2Rpc3Qvdmlld2VyLmNzcz9jNDVjIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHN0eWxlLWxvYWRlcjogQWRkcyBzb21lIGNzcyB0byB0aGUgRE9NIGJ5IGFkZGluZyBhIDxzdHlsZT4gdGFnXG5cbi8vIGxvYWQgdGhlIHN0eWxlc1xudmFyIGNvbnRlbnQgPSByZXF1aXJlKFwiISEuLi8uLi9jc3MtbG9hZGVyL2luZGV4LmpzPz9yZWYtLTYtb25lT2YtMy0xIS4uLy4uL3Bvc3Rjc3MtbG9hZGVyL3NyYy9pbmRleC5qcz8/cmVmLS02LW9uZU9mLTMtMiEuL3ZpZXdlci5jc3NcIik7XG5pZih0eXBlb2YgY29udGVudCA9PT0gJ3N0cmluZycpIGNvbnRlbnQgPSBbW21vZHVsZS5pZCwgY29udGVudCwgJyddXTtcbmlmKGNvbnRlbnQubG9jYWxzKSBtb2R1bGUuZXhwb3J0cyA9IGNvbnRlbnQubG9jYWxzO1xuLy8gYWRkIHRoZSBzdHlsZXMgdG8gdGhlIERPTVxudmFyIGFkZCA9IHJlcXVpcmUoXCIhLi4vLi4vdnVlLXN0eWxlLWxvYWRlci9saWIvYWRkU3R5bGVzQ2xpZW50LmpzXCIpLmRlZmF1bHRcbnZhciB1cGRhdGUgPSBhZGQoXCI2NDMxYjY2YlwiLCBjb250ZW50LCBmYWxzZSwge1wic291cmNlTWFwXCI6ZmFsc2UsXCJzaGFkb3dNb2RlXCI6ZmFsc2V9KTtcbi8vIEhvdCBNb2R1bGUgUmVwbGFjZW1lbnRcbmlmKG1vZHVsZS5ob3QpIHtcbiAvLyBXaGVuIHRoZSBzdHlsZXMgY2hhbmdlLCB1cGRhdGUgdGhlIDxzdHlsZT4gdGFnc1xuIGlmKCFjb250ZW50LmxvY2Fscykge1xuICAgbW9kdWxlLmhvdC5hY2NlcHQoXCIhIS4uLy4uL2Nzcy1sb2FkZXIvaW5kZXguanM/P3JlZi0tNi1vbmVPZi0zLTEhLi4vLi4vcG9zdGNzcy1sb2FkZXIvc3JjL2luZGV4LmpzPz9yZWYtLTYtb25lT2YtMy0yIS4vdmlld2VyLmNzc1wiLCBmdW5jdGlvbigpIHtcbiAgICAgdmFyIG5ld0NvbnRlbnQgPSByZXF1aXJlKFwiISEuLi8uLi9jc3MtbG9hZGVyL2luZGV4LmpzPz9yZWYtLTYtb25lT2YtMy0xIS4uLy4uL3Bvc3Rjc3MtbG9hZGVyL3NyYy9pbmRleC5qcz8/cmVmLS02LW9uZU9mLTMtMiEuL3ZpZXdlci5jc3NcIik7XG4gICAgIGlmKHR5cGVvZiBuZXdDb250ZW50ID09PSAnc3RyaW5nJykgbmV3Q29udGVudCA9IFtbbW9kdWxlLmlkLCBuZXdDb250ZW50LCAnJ11dO1xuICAgICB1cGRhdGUobmV3Q29udGVudCk7XG4gICB9KTtcbiB9XG4gLy8gV2hlbiB0aGUgbW9kdWxlIGlzIGRpc3Bvc2VkLCByZW1vdmUgdGhlIDxzdHlsZT4gdGFnc1xuIG1vZHVsZS5ob3QuZGlzcG9zZShmdW5jdGlvbigpIHsgdXBkYXRlKCk7IH0pO1xufSJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/viewerjs/dist/viewer.css\n");

/***/ }),

/***/ "./node_modules/viewerjs/dist/viewer.js":
/*!**********************************************!*\
  !*** ./node_modules/viewerjs/dist/viewer.js ***!
  \**********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("/*!\n * Viewer.js v1.9.0\n * https://fengyuanchen.github.io/viewerjs\n *\n * Copyright 2015-present Chen Fengyuan\n * Released under the MIT license\n *\n * Date: 2020-12-06T11:25:15.688Z\n */\n\n(function (global, factory) {\n   true ? module.exports = factory() :\n  undefined;\n}(this, (function () { 'use strict';\n\n  function _typeof(obj) {\n    \"@babel/helpers - typeof\";\n\n    if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n      _typeof = function (obj) {\n        return typeof obj;\n      };\n    } else {\n      _typeof = function (obj) {\n        return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n      };\n    }\n\n    return _typeof(obj);\n  }\n\n  function _classCallCheck(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError(\"Cannot call a class as a function\");\n    }\n  }\n\n  function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  function _createClass(Constructor, protoProps, staticProps) {\n    if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) _defineProperties(Constructor, staticProps);\n    return Constructor;\n  }\n\n  function _defineProperty(obj, key, value) {\n    if (key in obj) {\n      Object.defineProperty(obj, key, {\n        value: value,\n        enumerable: true,\n        configurable: true,\n        writable: true\n      });\n    } else {\n      obj[key] = value;\n    }\n\n    return obj;\n  }\n\n  function ownKeys(object, enumerableOnly) {\n    var keys = Object.keys(object);\n\n    if (Object.getOwnPropertySymbols) {\n      var symbols = Object.getOwnPropertySymbols(object);\n      if (enumerableOnly) symbols = symbols.filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n      });\n      keys.push.apply(keys, symbols);\n    }\n\n    return keys;\n  }\n\n  function _objectSpread2(target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i] != null ? arguments[i] : {};\n\n      if (i % 2) {\n        ownKeys(Object(source), true).forEach(function (key) {\n          _defineProperty(target, key, source[key]);\n        });\n      } else if (Object.getOwnPropertyDescriptors) {\n        Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n      } else {\n        ownKeys(Object(source)).forEach(function (key) {\n          Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n        });\n      }\n    }\n\n    return target;\n  }\n\n  var DEFAULTS = {\n    /**\n     * Enable a modal backdrop, specify `static` for a backdrop\n     * which doesn't close the modal on click.\n     * @type {boolean}\n     */\n    backdrop: true,\n\n    /**\n     * Show the button on the top-right of the viewer.\n     * @type {boolean}\n     */\n    button: true,\n\n    /**\n     * Show the navbar.\n     * @type {boolean | number}\n     */\n    navbar: true,\n\n    /**\n     * Specify the visibility and the content of the title.\n     * @type {boolean | number | Function | Array}\n     */\n    title: true,\n\n    /**\n     * Show the toolbar.\n     * @type {boolean | number | Object}\n     */\n    toolbar: true,\n\n    /**\n     * Custom class name(s) to add to the viewer's root element.\n     * @type {string}\n     */\n    className: '',\n\n    /**\n     * Define where to put the viewer in modal mode.\n     * @type {string | Element}\n     */\n    container: 'body',\n\n    /**\n     * Filter the images for viewing. Return true if the image is viewable.\n     * @type {Function}\n     */\n    filter: null,\n\n    /**\n     * Enable to request fullscreen when play.\n     * @type {boolean}\n     */\n    fullscreen: true,\n\n    /**\n     * Define the extra attributes to inherit from the original image.\n     * @type {Array}\n     */\n    inheritedAttributes: ['crossOrigin', 'decoding', 'isMap', 'loading', 'referrerPolicy', 'sizes', 'srcset', 'useMap'],\n\n    /**\n     * Define the initial index of image for viewing.\n     * @type {number}\n     */\n    initialViewIndex: 0,\n\n    /**\n     * Enable inline mode.\n     * @type {boolean}\n     */\n    inline: false,\n\n    /**\n     * The amount of time to delay between automatically cycling an image when playing.\n     * @type {number}\n     */\n    interval: 5000,\n\n    /**\n     * Enable keyboard support.\n     * @type {boolean}\n     */\n    keyboard: true,\n\n    /**\n     * Focus the viewer when initialized.\n     * @type {boolean}\n     */\n    focus: true,\n\n    /**\n     * Indicate if show a loading spinner when load image or not.\n     * @type {boolean}\n     */\n    loading: true,\n\n    /**\n     * Indicate if enable loop viewing or not.\n     * @type {boolean}\n     */\n    loop: true,\n\n    /**\n     * Min width of the viewer in inline mode.\n     * @type {number}\n     */\n    minWidth: 200,\n\n    /**\n     * Min height of the viewer in inline mode.\n     * @type {number}\n     */\n    minHeight: 100,\n\n    /**\n     * Enable to move the image.\n     * @type {boolean}\n     */\n    movable: true,\n\n    /**\n     * Enable to rotate the image.\n     * @type {boolean}\n     */\n    rotatable: true,\n\n    /**\n     * Enable to scale the image.\n     * @type {boolean}\n     */\n    scalable: true,\n\n    /**\n     * Enable to zoom the image.\n     * @type {boolean}\n     */\n    zoomable: true,\n\n    /**\n     * Enable to zoom the current image by dragging on the touch screen.\n     * @type {boolean}\n     */\n    zoomOnTouch: true,\n\n    /**\n     * Enable to zoom the image by wheeling mouse.\n     * @type {boolean}\n     */\n    zoomOnWheel: true,\n\n    /**\n     * Enable to slide to the next or previous image by swiping on the touch screen.\n     * @type {boolean}\n     */\n    slideOnTouch: true,\n\n    /**\n     * Indicate if toggle the image size between its natural size\n     * and initial size when double click on the image or not.\n     * @type {boolean}\n     */\n    toggleOnDblclick: true,\n\n    /**\n     * Show the tooltip with image ratio (percentage) when zoom in or zoom out.\n     * @type {boolean}\n     */\n    tooltip: true,\n\n    /**\n     * Enable CSS3 Transition for some special elements.\n     * @type {boolean}\n     */\n    transition: true,\n\n    /**\n     * Define the CSS `z-index` value of viewer in modal mode.\n     * @type {number}\n     */\n    zIndex: 2015,\n\n    /**\n     * Define the CSS `z-index` value of viewer in inline mode.\n     * @type {number}\n     */\n    zIndexInline: 0,\n\n    /**\n     * Define the ratio when zoom the image by wheeling mouse.\n     * @type {number}\n     */\n    zoomRatio: 0.1,\n\n    /**\n     * Define the min ratio of the image when zoom out.\n     * @type {number}\n     */\n    minZoomRatio: 0.01,\n\n    /**\n     * Define the max ratio of the image when zoom in.\n     * @type {number}\n     */\n    maxZoomRatio: 100,\n\n    /**\n     * Define where to get the original image URL for viewing.\n     * @type {string | Function}\n     */\n    url: 'src',\n\n    /**\n     * Event shortcuts.\n     * @type {Function}\n     */\n    ready: null,\n    show: null,\n    shown: null,\n    hide: null,\n    hidden: null,\n    view: null,\n    viewed: null,\n    move: null,\n    moved: null,\n    rotate: null,\n    rotated: null,\n    scale: null,\n    scaled: null,\n    zoom: null,\n    zoomed: null,\n    play: null,\n    stop: null\n  };\n\n  var TEMPLATE = '<div class=\"viewer-container\" tabindex=\"-1\" touch-action=\"none\">' + '<div class=\"viewer-canvas\"></div>' + '<div class=\"viewer-footer\">' + '<div class=\"viewer-title\"></div>' + '<div class=\"viewer-toolbar\"></div>' + '<div class=\"viewer-navbar\">' + '<ul class=\"viewer-list\" role=\"navigation\"></ul>' + '</div>' + '</div>' + '<div class=\"viewer-tooltip\" role=\"alert\" aria-hidden=\"true\"></div>' + '<div class=\"viewer-button\" data-viewer-action=\"mix\" role=\"button\"></div>' + '<div class=\"viewer-player\"></div>' + '</div>';\n\n  var IS_BROWSER = typeof window !== 'undefined' && typeof window.document !== 'undefined';\n  var WINDOW = IS_BROWSER ? window : {};\n  var IS_TOUCH_DEVICE = IS_BROWSER && WINDOW.document.documentElement ? 'ontouchstart' in WINDOW.document.documentElement : false;\n  var HAS_POINTER_EVENT = IS_BROWSER ? 'PointerEvent' in WINDOW : false;\n  var NAMESPACE = 'viewer'; // Actions\n\n  var ACTION_MOVE = 'move';\n  var ACTION_SWITCH = 'switch';\n  var ACTION_ZOOM = 'zoom'; // Classes\n\n  var CLASS_ACTIVE = \"\".concat(NAMESPACE, \"-active\");\n  var CLASS_CLOSE = \"\".concat(NAMESPACE, \"-close\");\n  var CLASS_FADE = \"\".concat(NAMESPACE, \"-fade\");\n  var CLASS_FIXED = \"\".concat(NAMESPACE, \"-fixed\");\n  var CLASS_FULLSCREEN = \"\".concat(NAMESPACE, \"-fullscreen\");\n  var CLASS_FULLSCREEN_EXIT = \"\".concat(NAMESPACE, \"-fullscreen-exit\");\n  var CLASS_HIDE = \"\".concat(NAMESPACE, \"-hide\");\n  var CLASS_HIDE_MD_DOWN = \"\".concat(NAMESPACE, \"-hide-md-down\");\n  var CLASS_HIDE_SM_DOWN = \"\".concat(NAMESPACE, \"-hide-sm-down\");\n  var CLASS_HIDE_XS_DOWN = \"\".concat(NAMESPACE, \"-hide-xs-down\");\n  var CLASS_IN = \"\".concat(NAMESPACE, \"-in\");\n  var CLASS_INVISIBLE = \"\".concat(NAMESPACE, \"-invisible\");\n  var CLASS_LOADING = \"\".concat(NAMESPACE, \"-loading\");\n  var CLASS_MOVE = \"\".concat(NAMESPACE, \"-move\");\n  var CLASS_OPEN = \"\".concat(NAMESPACE, \"-open\");\n  var CLASS_SHOW = \"\".concat(NAMESPACE, \"-show\");\n  var CLASS_TRANSITION = \"\".concat(NAMESPACE, \"-transition\"); // Native events\n\n  var EVENT_CLICK = 'click';\n  var EVENT_DBLCLICK = 'dblclick';\n  var EVENT_DRAG_START = 'dragstart';\n  var EVENT_FOCUSIN = 'focusin';\n  var EVENT_KEY_DOWN = 'keydown';\n  var EVENT_LOAD = 'load';\n  var EVENT_TOUCH_END = IS_TOUCH_DEVICE ? 'touchend touchcancel' : 'mouseup';\n  var EVENT_TOUCH_MOVE = IS_TOUCH_DEVICE ? 'touchmove' : 'mousemove';\n  var EVENT_TOUCH_START = IS_TOUCH_DEVICE ? 'touchstart' : 'mousedown';\n  var EVENT_POINTER_DOWN = HAS_POINTER_EVENT ? 'pointerdown' : EVENT_TOUCH_START;\n  var EVENT_POINTER_MOVE = HAS_POINTER_EVENT ? 'pointermove' : EVENT_TOUCH_MOVE;\n  var EVENT_POINTER_UP = HAS_POINTER_EVENT ? 'pointerup pointercancel' : EVENT_TOUCH_END;\n  var EVENT_RESIZE = 'resize';\n  var EVENT_TRANSITION_END = 'transitionend';\n  var EVENT_WHEEL = 'wheel'; // Custom events\n\n  var EVENT_READY = 'ready';\n  var EVENT_SHOW = 'show';\n  var EVENT_SHOWN = 'shown';\n  var EVENT_HIDE = 'hide';\n  var EVENT_HIDDEN = 'hidden';\n  var EVENT_VIEW = 'view';\n  var EVENT_VIEWED = 'viewed';\n  var EVENT_MOVE = 'move';\n  var EVENT_MOVED = 'moved';\n  var EVENT_ROTATE = 'rotate';\n  var EVENT_ROTATED = 'rotated';\n  var EVENT_SCALE = 'scale';\n  var EVENT_SCALED = 'scaled';\n  var EVENT_ZOOM = 'zoom';\n  var EVENT_ZOOMED = 'zoomed';\n  var EVENT_PLAY = 'play';\n  var EVENT_STOP = 'stop'; // Data keys\n\n  var DATA_ACTION = \"\".concat(NAMESPACE, \"Action\"); // RegExps\n\n  var REGEXP_SPACES = /\\s\\s*/; // Misc\n\n  var BUTTONS = ['zoom-in', 'zoom-out', 'one-to-one', 'reset', 'prev', 'play', 'next', 'rotate-left', 'rotate-right', 'flip-horizontal', 'flip-vertical'];\n\n  /**\n   * Check if the given value is a string.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is a string, else `false`.\n   */\n\n  function isString(value) {\n    return typeof value === 'string';\n  }\n  /**\n   * Check if the given value is not a number.\n   */\n\n  var isNaN = Number.isNaN || WINDOW.isNaN;\n  /**\n   * Check if the given value is a number.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is a number, else `false`.\n   */\n\n  function isNumber(value) {\n    return typeof value === 'number' && !isNaN(value);\n  }\n  /**\n   * Check if the given value is undefined.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is undefined, else `false`.\n   */\n\n  function isUndefined(value) {\n    return typeof value === 'undefined';\n  }\n  /**\n   * Check if the given value is an object.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is an object, else `false`.\n   */\n\n  function isObject(value) {\n    return _typeof(value) === 'object' && value !== null;\n  }\n  var hasOwnProperty = Object.prototype.hasOwnProperty;\n  /**\n   * Check if the given value is a plain object.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is a plain object, else `false`.\n   */\n\n  function isPlainObject(value) {\n    if (!isObject(value)) {\n      return false;\n    }\n\n    try {\n      var _constructor = value.constructor;\n      var prototype = _constructor.prototype;\n      return _constructor && prototype && hasOwnProperty.call(prototype, 'isPrototypeOf');\n    } catch (error) {\n      return false;\n    }\n  }\n  /**\n   * Check if the given value is a function.\n   * @param {*} value - The value to check.\n   * @returns {boolean} Returns `true` if the given value is a function, else `false`.\n   */\n\n  function isFunction(value) {\n    return typeof value === 'function';\n  }\n  /**\n   * Iterate the given data.\n   * @param {*} data - The data to iterate.\n   * @param {Function} callback - The process function for each element.\n   * @returns {*} The original data.\n   */\n\n  function forEach(data, callback) {\n    if (data && isFunction(callback)) {\n      if (Array.isArray(data) || isNumber(data.length)\n      /* array-like */\n      ) {\n          var length = data.length;\n          var i;\n\n          for (i = 0; i < length; i += 1) {\n            if (callback.call(data, data[i], i, data) === false) {\n              break;\n            }\n          }\n        } else if (isObject(data)) {\n        Object.keys(data).forEach(function (key) {\n          callback.call(data, data[key], key, data);\n        });\n      }\n    }\n\n    return data;\n  }\n  /**\n   * Extend the given object.\n   * @param {*} obj - The object to be extended.\n   * @param {*} args - The rest objects which will be merged to the first object.\n   * @returns {Object} The extended object.\n   */\n\n  var assign = Object.assign || function assign(obj) {\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n\n    if (isObject(obj) && args.length > 0) {\n      args.forEach(function (arg) {\n        if (isObject(arg)) {\n          Object.keys(arg).forEach(function (key) {\n            obj[key] = arg[key];\n          });\n        }\n      });\n    }\n\n    return obj;\n  };\n  var REGEXP_SUFFIX = /^(?:width|height|left|top|marginLeft|marginTop)$/;\n  /**\n   * Apply styles to the given element.\n   * @param {Element} element - The target element.\n   * @param {Object} styles - The styles for applying.\n   */\n\n  function setStyle(element, styles) {\n    var style = element.style;\n    forEach(styles, function (value, property) {\n      if (REGEXP_SUFFIX.test(property) && isNumber(value)) {\n        value += 'px';\n      }\n\n      style[property] = value;\n    });\n  }\n  /**\n   * Escape a string for using in HTML.\n   * @param {String} value - The string to escape.\n   * @returns {String} Returns the escaped string.\n   */\n\n  function escapeHTMLEntities(value) {\n    return isString(value) ? value.replace(/&(?!amp;|quot;|#39;|lt;|gt;)/g, '&amp;').replace(/\"/g, '&quot;').replace(/'/g, '&#39;').replace(/</g, '&lt;').replace(/>/g, '&gt;') : value;\n  }\n  /**\n   * Check if the given element has a special class.\n   * @param {Element} element - The element to check.\n   * @param {string} value - The class to search.\n   * @returns {boolean} Returns `true` if the special class was found.\n   */\n\n  function hasClass(element, value) {\n    if (!element || !value) {\n      return false;\n    }\n\n    return element.classList ? element.classList.contains(value) : element.className.indexOf(value) > -1;\n  }\n  /**\n   * Add classes to the given element.\n   * @param {Element} element - The target element.\n   * @param {string} value - The classes to be added.\n   */\n\n  function addClass(element, value) {\n    if (!element || !value) {\n      return;\n    }\n\n    if (isNumber(element.length)) {\n      forEach(element, function (elem) {\n        addClass(elem, value);\n      });\n      return;\n    }\n\n    if (element.classList) {\n      element.classList.add(value);\n      return;\n    }\n\n    var className = element.className.trim();\n\n    if (!className) {\n      element.className = value;\n    } else if (className.indexOf(value) < 0) {\n      element.className = \"\".concat(className, \" \").concat(value);\n    }\n  }\n  /**\n   * Remove classes from the given element.\n   * @param {Element} element - The target element.\n   * @param {string} value - The classes to be removed.\n   */\n\n  function removeClass(element, value) {\n    if (!element || !value) {\n      return;\n    }\n\n    if (isNumber(element.length)) {\n      forEach(element, function (elem) {\n        removeClass(elem, value);\n      });\n      return;\n    }\n\n    if (element.classList) {\n      element.classList.remove(value);\n      return;\n    }\n\n    if (element.className.indexOf(value) >= 0) {\n      element.className = element.className.replace(value, '');\n    }\n  }\n  /**\n   * Add or remove classes from the given element.\n   * @param {Element} element - The target element.\n   * @param {string} value - The classes to be toggled.\n   * @param {boolean} added - Add only.\n   */\n\n  function toggleClass(element, value, added) {\n    if (!value) {\n      return;\n    }\n\n    if (isNumber(element.length)) {\n      forEach(element, function (elem) {\n        toggleClass(elem, value, added);\n      });\n      return;\n    } // IE10-11 doesn't support the second parameter of `classList.toggle`\n\n\n    if (added) {\n      addClass(element, value);\n    } else {\n      removeClass(element, value);\n    }\n  }\n  var REGEXP_HYPHENATE = /([a-z\\d])([A-Z])/g;\n  /**\n   * Transform the given string from camelCase to kebab-case\n   * @param {string} value - The value to transform.\n   * @returns {string} The transformed value.\n   */\n\n  function hyphenate(value) {\n    return value.replace(REGEXP_HYPHENATE, '$1-$2').toLowerCase();\n  }\n  /**\n   * Get data from the given element.\n   * @param {Element} element - The target element.\n   * @param {string} name - The data key to get.\n   * @returns {string} The data value.\n   */\n\n  function getData(element, name) {\n    if (isObject(element[name])) {\n      return element[name];\n    }\n\n    if (element.dataset) {\n      return element.dataset[name];\n    }\n\n    return element.getAttribute(\"data-\".concat(hyphenate(name)));\n  }\n  /**\n   * Set data to the given element.\n   * @param {Element} element - The target element.\n   * @param {string} name - The data key to set.\n   * @param {string} data - The data value.\n   */\n\n  function setData(element, name, data) {\n    if (isObject(data)) {\n      element[name] = data;\n    } else if (element.dataset) {\n      element.dataset[name] = data;\n    } else {\n      element.setAttribute(\"data-\".concat(hyphenate(name)), data);\n    }\n  }\n\n  var onceSupported = function () {\n    var supported = false;\n\n    if (IS_BROWSER) {\n      var once = false;\n\n      var listener = function listener() {};\n\n      var options = Object.defineProperty({}, 'once', {\n        get: function get() {\n          supported = true;\n          return once;\n        },\n\n        /**\n         * This setter can fix a `TypeError` in strict mode\n         * {@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Getter_only}\n         * @param {boolean} value - The value to set\n         */\n        set: function set(value) {\n          once = value;\n        }\n      });\n      WINDOW.addEventListener('test', listener, options);\n      WINDOW.removeEventListener('test', listener, options);\n    }\n\n    return supported;\n  }();\n  /**\n   * Remove event listener from the target element.\n   * @param {Element} element - The event target.\n   * @param {string} type - The event type(s).\n   * @param {Function} listener - The event listener.\n   * @param {Object} options - The event options.\n   */\n\n\n  function removeListener(element, type, listener) {\n    var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n    var handler = listener;\n    type.trim().split(REGEXP_SPACES).forEach(function (event) {\n      if (!onceSupported) {\n        var listeners = element.listeners;\n\n        if (listeners && listeners[event] && listeners[event][listener]) {\n          handler = listeners[event][listener];\n          delete listeners[event][listener];\n\n          if (Object.keys(listeners[event]).length === 0) {\n            delete listeners[event];\n          }\n\n          if (Object.keys(listeners).length === 0) {\n            delete element.listeners;\n          }\n        }\n      }\n\n      element.removeEventListener(event, handler, options);\n    });\n  }\n  /**\n   * Add event listener to the target element.\n   * @param {Element} element - The event target.\n   * @param {string} type - The event type(s).\n   * @param {Function} listener - The event listener.\n   * @param {Object} options - The event options.\n   */\n\n  function addListener(element, type, listener) {\n    var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n    var _handler = listener;\n    type.trim().split(REGEXP_SPACES).forEach(function (event) {\n      if (options.once && !onceSupported) {\n        var _element$listeners = element.listeners,\n            listeners = _element$listeners === void 0 ? {} : _element$listeners;\n\n        _handler = function handler() {\n          delete listeners[event][listener];\n          element.removeEventListener(event, _handler, options);\n\n          for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n            args[_key2] = arguments[_key2];\n          }\n\n          listener.apply(element, args);\n        };\n\n        if (!listeners[event]) {\n          listeners[event] = {};\n        }\n\n        if (listeners[event][listener]) {\n          element.removeEventListener(event, listeners[event][listener], options);\n        }\n\n        listeners[event][listener] = _handler;\n        element.listeners = listeners;\n      }\n\n      element.addEventListener(event, _handler, options);\n    });\n  }\n  /**\n   * Dispatch event on the target element.\n   * @param {Element} element - The event target.\n   * @param {string} type - The event type(s).\n   * @param {Object} data - The additional event data.\n   * @param {Object} options - The additional event options.\n   * @returns {boolean} Indicate if the event is default prevented or not.\n   */\n\n  function dispatchEvent(element, type, data, options) {\n    var event; // Event and CustomEvent on IE9-11 are global objects, not constructors\n\n    if (isFunction(Event) && isFunction(CustomEvent)) {\n      event = new CustomEvent(type, _objectSpread2({\n        bubbles: true,\n        cancelable: true,\n        detail: data\n      }, options));\n    } else {\n      event = document.createEvent('CustomEvent');\n      event.initCustomEvent(type, true, true, data);\n    }\n\n    return element.dispatchEvent(event);\n  }\n  /**\n   * Get the offset base on the document.\n   * @param {Element} element - The target element.\n   * @returns {Object} The offset data.\n   */\n\n  function getOffset(element) {\n    var box = element.getBoundingClientRect();\n    return {\n      left: box.left + (window.pageXOffset - document.documentElement.clientLeft),\n      top: box.top + (window.pageYOffset - document.documentElement.clientTop)\n    };\n  }\n  /**\n   * Get transforms base on the given object.\n   * @param {Object} obj - The target object.\n   * @returns {string} A string contains transform values.\n   */\n\n  function getTransforms(_ref) {\n    var rotate = _ref.rotate,\n        scaleX = _ref.scaleX,\n        scaleY = _ref.scaleY,\n        translateX = _ref.translateX,\n        translateY = _ref.translateY;\n    var values = [];\n\n    if (isNumber(translateX) && translateX !== 0) {\n      values.push(\"translateX(\".concat(translateX, \"px)\"));\n    }\n\n    if (isNumber(translateY) && translateY !== 0) {\n      values.push(\"translateY(\".concat(translateY, \"px)\"));\n    } // Rotate should come first before scale to match orientation transform\n\n\n    if (isNumber(rotate) && rotate !== 0) {\n      values.push(\"rotate(\".concat(rotate, \"deg)\"));\n    }\n\n    if (isNumber(scaleX) && scaleX !== 1) {\n      values.push(\"scaleX(\".concat(scaleX, \")\"));\n    }\n\n    if (isNumber(scaleY) && scaleY !== 1) {\n      values.push(\"scaleY(\".concat(scaleY, \")\"));\n    }\n\n    var transform = values.length ? values.join(' ') : 'none';\n    return {\n      WebkitTransform: transform,\n      msTransform: transform,\n      transform: transform\n    };\n  }\n  /**\n   * Get an image name from an image url.\n   * @param {string} url - The target url.\n   * @example\n   * // picture.jpg\n   * getImageNameFromURL('https://domain.com/path/to/picture.jpg?size=1280×960')\n   * @returns {string} A string contains the image name.\n   */\n\n  function getImageNameFromURL(url) {\n    return isString(url) ? decodeURIComponent(url.replace(/^.*\\//, '').replace(/[?&#].*$/, '')) : '';\n  }\n  var IS_SAFARI = WINDOW.navigator && /(Macintosh|iPhone|iPod|iPad).*AppleWebKit/i.test(WINDOW.navigator.userAgent);\n  /**\n   * Get an image's natural sizes.\n   * @param {string} image - The target image.\n   * @param {Object} options - The viewer options.\n   * @param {Function} callback - The callback function.\n   * @returns {HTMLImageElement} The new image.\n   */\n\n  function getImageNaturalSizes(image, options, callback) {\n    var newImage = document.createElement('img'); // Modern browsers (except Safari)\n\n    if (image.naturalWidth && !IS_SAFARI) {\n      callback(image.naturalWidth, image.naturalHeight);\n      return newImage;\n    }\n\n    var body = document.body || document.documentElement;\n\n    newImage.onload = function () {\n      callback(newImage.width, newImage.height);\n\n      if (!IS_SAFARI) {\n        body.removeChild(newImage);\n      }\n    };\n\n    forEach(options.inheritedAttributes, function (name) {\n      var value = image.getAttribute(name);\n\n      if (value !== null) {\n        newImage.setAttribute(name, value);\n      }\n    });\n    newImage.src = image.src; // iOS Safari will convert the image automatically\n    // with its orientation once append it into DOM\n\n    if (!IS_SAFARI) {\n      newImage.style.cssText = 'left:0;' + 'max-height:none!important;' + 'max-width:none!important;' + 'min-height:0!important;' + 'min-width:0!important;' + 'opacity:0;' + 'position:absolute;' + 'top:0;' + 'z-index:-1;';\n      body.appendChild(newImage);\n    }\n\n    return newImage;\n  }\n  /**\n   * Get the related class name of a responsive type number.\n   * @param {string} type - The responsive type.\n   * @returns {string} The related class name.\n   */\n\n  function getResponsiveClass(type) {\n    switch (type) {\n      case 2:\n        return CLASS_HIDE_XS_DOWN;\n\n      case 3:\n        return CLASS_HIDE_SM_DOWN;\n\n      case 4:\n        return CLASS_HIDE_MD_DOWN;\n\n      default:\n        return '';\n    }\n  }\n  /**\n   * Get the max ratio of a group of pointers.\n   * @param {string} pointers - The target pointers.\n   * @returns {number} The result ratio.\n   */\n\n  function getMaxZoomRatio(pointers) {\n    var pointers2 = _objectSpread2({}, pointers);\n\n    var ratios = [];\n    forEach(pointers, function (pointer, pointerId) {\n      delete pointers2[pointerId];\n      forEach(pointers2, function (pointer2) {\n        var x1 = Math.abs(pointer.startX - pointer2.startX);\n        var y1 = Math.abs(pointer.startY - pointer2.startY);\n        var x2 = Math.abs(pointer.endX - pointer2.endX);\n        var y2 = Math.abs(pointer.endY - pointer2.endY);\n        var z1 = Math.sqrt(x1 * x1 + y1 * y1);\n        var z2 = Math.sqrt(x2 * x2 + y2 * y2);\n        var ratio = (z2 - z1) / z1;\n        ratios.push(ratio);\n      });\n    });\n    ratios.sort(function (a, b) {\n      return Math.abs(a) < Math.abs(b);\n    });\n    return ratios[0];\n  }\n  /**\n   * Get a pointer from an event object.\n   * @param {Object} event - The target event object.\n   * @param {boolean} endOnly - Indicates if only returns the end point coordinate or not.\n   * @returns {Object} The result pointer contains start and/or end point coordinates.\n   */\n\n  function getPointer(_ref2, endOnly) {\n    var pageX = _ref2.pageX,\n        pageY = _ref2.pageY;\n    var end = {\n      endX: pageX,\n      endY: pageY\n    };\n    return endOnly ? end : _objectSpread2({\n      timeStamp: Date.now(),\n      startX: pageX,\n      startY: pageY\n    }, end);\n  }\n  /**\n   * Get the center point coordinate of a group of pointers.\n   * @param {Object} pointers - The target pointers.\n   * @returns {Object} The center point coordinate.\n   */\n\n  function getPointersCenter(pointers) {\n    var pageX = 0;\n    var pageY = 0;\n    var count = 0;\n    forEach(pointers, function (_ref3) {\n      var startX = _ref3.startX,\n          startY = _ref3.startY;\n      pageX += startX;\n      pageY += startY;\n      count += 1;\n    });\n    pageX /= count;\n    pageY /= count;\n    return {\n      pageX: pageX,\n      pageY: pageY\n    };\n  }\n\n  var render = {\n    render: function render() {\n      this.initContainer();\n      this.initViewer();\n      this.initList();\n      this.renderViewer();\n    },\n    initBody: function initBody() {\n      var ownerDocument = this.element.ownerDocument;\n      var body = ownerDocument.body || ownerDocument.documentElement;\n      this.body = body;\n      this.scrollbarWidth = window.innerWidth - ownerDocument.documentElement.clientWidth;\n      this.initialBodyPaddingRight = body.style.paddingRight;\n      this.initialBodyComputedPaddingRight = window.getComputedStyle(body).paddingRight;\n    },\n    initContainer: function initContainer() {\n      this.containerData = {\n        width: window.innerWidth,\n        height: window.innerHeight\n      };\n    },\n    initViewer: function initViewer() {\n      var options = this.options,\n          parent = this.parent;\n      var viewerData;\n\n      if (options.inline) {\n        viewerData = {\n          width: Math.max(parent.offsetWidth, options.minWidth),\n          height: Math.max(parent.offsetHeight, options.minHeight)\n        };\n        this.parentData = viewerData;\n      }\n\n      if (this.fulled || !viewerData) {\n        viewerData = this.containerData;\n      }\n\n      this.viewerData = assign({}, viewerData);\n    },\n    renderViewer: function renderViewer() {\n      if (this.options.inline && !this.fulled) {\n        setStyle(this.viewer, this.viewerData);\n      }\n    },\n    initList: function initList() {\n      var _this = this;\n\n      var element = this.element,\n          options = this.options,\n          list = this.list;\n      var items = []; // initList may be called in this.update, so should keep idempotent\n\n      list.innerHTML = '';\n      forEach(this.images, function (image, index) {\n        var src = image.src;\n        var alt = image.alt || getImageNameFromURL(src);\n\n        var url = _this.getImageURL(image);\n\n        if (src || url) {\n          var item = document.createElement('li');\n          var img = document.createElement('img');\n          forEach(options.inheritedAttributes, function (name) {\n            var value = image.getAttribute(name);\n\n            if (value !== null) {\n              img.setAttribute(name, value);\n            }\n          });\n          img.src = src || url;\n          img.alt = alt;\n          img.setAttribute('data-original-url', url || src);\n          item.setAttribute('data-index', index);\n          item.setAttribute('data-viewer-action', 'view');\n          item.setAttribute('role', 'button');\n\n          if (options.keyboard) {\n            item.setAttribute('tabindex', 0);\n          }\n\n          item.appendChild(img);\n          list.appendChild(item);\n          items.push(item);\n        }\n      });\n      this.items = items;\n      forEach(items, function (item) {\n        var image = item.firstElementChild;\n        setData(image, 'filled', true);\n\n        if (options.loading) {\n          addClass(item, CLASS_LOADING);\n        }\n\n        addListener(image, EVENT_LOAD, function (event) {\n          if (options.loading) {\n            removeClass(item, CLASS_LOADING);\n          }\n\n          _this.loadImage(event);\n        }, {\n          once: true\n        });\n      });\n\n      if (options.transition) {\n        addListener(element, EVENT_VIEWED, function () {\n          addClass(list, CLASS_TRANSITION);\n        }, {\n          once: true\n        });\n      }\n    },\n    renderList: function renderList(index) {\n      var i = index || this.index;\n      var width = this.items[i].offsetWidth || 30;\n      var outerWidth = width + 1; // 1 pixel of `margin-left` width\n      // Place the active item in the center of the screen\n\n      setStyle(this.list, assign({\n        width: outerWidth * this.length\n      }, getTransforms({\n        translateX: (this.viewerData.width - width) / 2 - outerWidth * i\n      })));\n    },\n    resetList: function resetList() {\n      var list = this.list;\n      list.innerHTML = '';\n      removeClass(list, CLASS_TRANSITION);\n      setStyle(list, getTransforms({\n        translateX: 0\n      }));\n    },\n    initImage: function initImage(done) {\n      var _this2 = this;\n\n      var options = this.options,\n          image = this.image,\n          viewerData = this.viewerData;\n      var footerHeight = this.footer.offsetHeight;\n      var viewerWidth = viewerData.width;\n      var viewerHeight = Math.max(viewerData.height - footerHeight, footerHeight);\n      var oldImageData = this.imageData || {};\n      var sizingImage;\n      this.imageInitializing = {\n        abort: function abort() {\n          sizingImage.onload = null;\n        }\n      };\n      sizingImage = getImageNaturalSizes(image, options, function (naturalWidth, naturalHeight) {\n        var aspectRatio = naturalWidth / naturalHeight;\n        var width = viewerWidth;\n        var height = viewerHeight;\n        _this2.imageInitializing = false;\n\n        if (viewerHeight * aspectRatio > viewerWidth) {\n          height = viewerWidth / aspectRatio;\n        } else {\n          width = viewerHeight * aspectRatio;\n        }\n\n        width = Math.min(width * 0.9, naturalWidth);\n        height = Math.min(height * 0.9, naturalHeight);\n        var left = (viewerWidth - width) / 2;\n        var top = (viewerHeight - height) / 2;\n        var imageData = {\n          left: left,\n          top: top,\n          x: left,\n          y: top,\n          width: width,\n          height: height,\n          ratio: width / naturalWidth,\n          aspectRatio: aspectRatio,\n          naturalWidth: naturalWidth,\n          naturalHeight: naturalHeight\n        };\n        var initialImageData = assign({}, imageData);\n\n        if (options.rotatable) {\n          imageData.rotate = oldImageData.rotate || 0;\n          initialImageData.rotate = 0;\n        }\n\n        if (options.scalable) {\n          imageData.scaleX = oldImageData.scaleX || 1;\n          imageData.scaleY = oldImageData.scaleY || 1;\n          initialImageData.scaleX = 1;\n          initialImageData.scaleY = 1;\n        }\n\n        _this2.imageData = imageData;\n        _this2.initialImageData = initialImageData;\n\n        if (done) {\n          done();\n        }\n      });\n    },\n    renderImage: function renderImage(done) {\n      var _this3 = this;\n\n      var image = this.image,\n          imageData = this.imageData;\n      setStyle(image, assign({\n        width: imageData.width,\n        height: imageData.height,\n        // XXX: Not to use translateX/Y to avoid image shaking when zooming\n        marginLeft: imageData.x,\n        marginTop: imageData.y\n      }, getTransforms(imageData)));\n\n      if (done) {\n        if ((this.viewing || this.moving || this.rotating || this.scaling || this.zooming) && this.options.transition && hasClass(image, CLASS_TRANSITION)) {\n          var onTransitionEnd = function onTransitionEnd() {\n            _this3.imageRendering = false;\n            done();\n          };\n\n          this.imageRendering = {\n            abort: function abort() {\n              removeListener(image, EVENT_TRANSITION_END, onTransitionEnd);\n            }\n          };\n          addListener(image, EVENT_TRANSITION_END, onTransitionEnd, {\n            once: true\n          });\n        } else {\n          done();\n        }\n      }\n    },\n    resetImage: function resetImage() {\n      // this.image only defined after viewed\n      if (this.viewing || this.viewed) {\n        var image = this.image;\n\n        if (this.viewing) {\n          this.viewing.abort();\n        }\n\n        image.parentNode.removeChild(image);\n        this.image = null;\n      }\n    }\n  };\n\n  var events = {\n    bind: function bind() {\n      var options = this.options,\n          viewer = this.viewer,\n          canvas = this.canvas;\n      var document = this.element.ownerDocument;\n      addListener(viewer, EVENT_CLICK, this.onClick = this.click.bind(this));\n      addListener(viewer, EVENT_DRAG_START, this.onDragStart = this.dragstart.bind(this));\n      addListener(canvas, EVENT_POINTER_DOWN, this.onPointerDown = this.pointerdown.bind(this));\n      addListener(document, EVENT_POINTER_MOVE, this.onPointerMove = this.pointermove.bind(this));\n      addListener(document, EVENT_POINTER_UP, this.onPointerUp = this.pointerup.bind(this));\n      addListener(document, EVENT_KEY_DOWN, this.onKeyDown = this.keydown.bind(this));\n      addListener(window, EVENT_RESIZE, this.onResize = this.resize.bind(this));\n\n      if (options.zoomable && options.zoomOnWheel) {\n        addListener(viewer, EVENT_WHEEL, this.onWheel = this.wheel.bind(this), {\n          passive: false,\n          capture: true\n        });\n      }\n\n      if (options.toggleOnDblclick) {\n        addListener(canvas, EVENT_DBLCLICK, this.onDblclick = this.dblclick.bind(this));\n      }\n    },\n    unbind: function unbind() {\n      var options = this.options,\n          viewer = this.viewer,\n          canvas = this.canvas;\n      var document = this.element.ownerDocument;\n      removeListener(viewer, EVENT_CLICK, this.onClick);\n      removeListener(viewer, EVENT_DRAG_START, this.onDragStart);\n      removeListener(canvas, EVENT_POINTER_DOWN, this.onPointerDown);\n      removeListener(document, EVENT_POINTER_MOVE, this.onPointerMove);\n      removeListener(document, EVENT_POINTER_UP, this.onPointerUp);\n      removeListener(document, EVENT_KEY_DOWN, this.onKeyDown);\n      removeListener(window, EVENT_RESIZE, this.onResize);\n\n      if (options.zoomable && options.zoomOnWheel) {\n        removeListener(viewer, EVENT_WHEEL, this.onWheel, {\n          passive: false,\n          capture: true\n        });\n      }\n\n      if (options.toggleOnDblclick) {\n        removeListener(canvas, EVENT_DBLCLICK, this.onDblclick);\n      }\n    }\n  };\n\n  var handlers = {\n    click: function click(event) {\n      var options = this.options,\n          imageData = this.imageData;\n      var target = event.target;\n      var action = getData(target, DATA_ACTION);\n\n      if (!action && target.localName === 'img' && target.parentElement.localName === 'li') {\n        target = target.parentElement;\n        action = getData(target, DATA_ACTION);\n      } // Cancel the emulated click when the native click event was triggered.\n\n\n      if (IS_TOUCH_DEVICE && event.isTrusted && target === this.canvas) {\n        clearTimeout(this.clickCanvasTimeout);\n      }\n\n      switch (action) {\n        case 'mix':\n          if (this.played) {\n            this.stop();\n          } else if (options.inline) {\n            if (this.fulled) {\n              this.exit();\n            } else {\n              this.full();\n            }\n          } else {\n            this.hide();\n          }\n\n          break;\n\n        case 'hide':\n          this.hide();\n          break;\n\n        case 'view':\n          this.view(getData(target, 'index'));\n          break;\n\n        case 'zoom-in':\n          this.zoom(0.1, true);\n          break;\n\n        case 'zoom-out':\n          this.zoom(-0.1, true);\n          break;\n\n        case 'one-to-one':\n          this.toggle();\n          break;\n\n        case 'reset':\n          this.reset();\n          break;\n\n        case 'prev':\n          this.prev(options.loop);\n          break;\n\n        case 'play':\n          this.play(options.fullscreen);\n          break;\n\n        case 'next':\n          this.next(options.loop);\n          break;\n\n        case 'rotate-left':\n          this.rotate(-90);\n          break;\n\n        case 'rotate-right':\n          this.rotate(90);\n          break;\n\n        case 'flip-horizontal':\n          this.scaleX(-imageData.scaleX || -1);\n          break;\n\n        case 'flip-vertical':\n          this.scaleY(-imageData.scaleY || -1);\n          break;\n\n        default:\n          if (this.played) {\n            this.stop();\n          }\n\n      }\n    },\n    dblclick: function dblclick(event) {\n      event.preventDefault();\n\n      if (this.viewed && event.target === this.image) {\n        // Cancel the emulated double click when the native dblclick event was triggered.\n        if (IS_TOUCH_DEVICE && event.isTrusted) {\n          clearTimeout(this.doubleClickImageTimeout);\n        }\n\n        this.toggle();\n      }\n    },\n    load: function load() {\n      var _this = this;\n\n      if (this.timeout) {\n        clearTimeout(this.timeout);\n        this.timeout = false;\n      }\n\n      var element = this.element,\n          options = this.options,\n          image = this.image,\n          index = this.index,\n          viewerData = this.viewerData;\n      removeClass(image, CLASS_INVISIBLE);\n\n      if (options.loading) {\n        removeClass(this.canvas, CLASS_LOADING);\n      }\n\n      image.style.cssText = 'height:0;' + \"margin-left:\".concat(viewerData.width / 2, \"px;\") + \"margin-top:\".concat(viewerData.height / 2, \"px;\") + 'max-width:none!important;' + 'position:absolute;' + 'width:0;';\n      this.initImage(function () {\n        toggleClass(image, CLASS_MOVE, options.movable);\n        toggleClass(image, CLASS_TRANSITION, options.transition);\n\n        _this.renderImage(function () {\n          _this.viewed = true;\n          _this.viewing = false;\n\n          if (isFunction(options.viewed)) {\n            addListener(element, EVENT_VIEWED, options.viewed, {\n              once: true\n            });\n          }\n\n          dispatchEvent(element, EVENT_VIEWED, {\n            originalImage: _this.images[index],\n            index: index,\n            image: image\n          }, {\n            cancelable: false\n          });\n        });\n      });\n    },\n    loadImage: function loadImage(event) {\n      var image = event.target;\n      var parent = image.parentNode;\n      var parentWidth = parent.offsetWidth || 30;\n      var parentHeight = parent.offsetHeight || 50;\n      var filled = !!getData(image, 'filled');\n      getImageNaturalSizes(image, this.options, function (naturalWidth, naturalHeight) {\n        var aspectRatio = naturalWidth / naturalHeight;\n        var width = parentWidth;\n        var height = parentHeight;\n\n        if (parentHeight * aspectRatio > parentWidth) {\n          if (filled) {\n            width = parentHeight * aspectRatio;\n          } else {\n            height = parentWidth / aspectRatio;\n          }\n        } else if (filled) {\n          height = parentWidth / aspectRatio;\n        } else {\n          width = parentHeight * aspectRatio;\n        }\n\n        setStyle(image, assign({\n          width: width,\n          height: height\n        }, getTransforms({\n          translateX: (parentWidth - width) / 2,\n          translateY: (parentHeight - height) / 2\n        })));\n      });\n    },\n    keydown: function keydown(event) {\n      var options = this.options;\n\n      if (!options.keyboard) {\n        return;\n      }\n\n      var keyCode = event.keyCode || event.which || event.charCode;\n\n      switch (keyCode) {\n        // Enter\n        case 13:\n          if (this.viewer.contains(event.target)) {\n            this.click(event);\n          }\n\n          break;\n      }\n\n      if (!this.fulled) {\n        return;\n      }\n\n      switch (keyCode) {\n        // Escape\n        case 27:\n          if (this.played) {\n            this.stop();\n          } else if (options.inline) {\n            if (this.fulled) {\n              this.exit();\n            }\n          } else {\n            this.hide();\n          }\n\n          break;\n        // Space\n\n        case 32:\n          if (this.played) {\n            this.stop();\n          }\n\n          break;\n        // ArrowLeft\n\n        case 37:\n          this.prev(options.loop);\n          break;\n        // ArrowUp\n\n        case 38:\n          // Prevent scroll on Firefox\n          event.preventDefault(); // Zoom in\n\n          this.zoom(options.zoomRatio, true);\n          break;\n        // ArrowRight\n\n        case 39:\n          this.next(options.loop);\n          break;\n        // ArrowDown\n\n        case 40:\n          // Prevent scroll on Firefox\n          event.preventDefault(); // Zoom out\n\n          this.zoom(-options.zoomRatio, true);\n          break;\n        // Ctrl + 0\n\n        case 48: // Fall through\n        // Ctrl + 1\n        // eslint-disable-next-line no-fallthrough\n\n        case 49:\n          if (event.ctrlKey) {\n            event.preventDefault();\n            this.toggle();\n          }\n\n          break;\n      }\n    },\n    dragstart: function dragstart(event) {\n      if (event.target.localName === 'img') {\n        event.preventDefault();\n      }\n    },\n    pointerdown: function pointerdown(event) {\n      var options = this.options,\n          pointers = this.pointers;\n      var buttons = event.buttons,\n          button = event.button;\n\n      if (!this.viewed || this.showing || this.viewing || this.hiding // Handle mouse event and pointer event and ignore touch event\n      || (event.type === 'mousedown' || event.type === 'pointerdown' && event.pointerType === 'mouse') && ( // No primary button (Usually the left button)\n      isNumber(buttons) && buttons !== 1 || isNumber(button) && button !== 0 // Open context menu\n      || event.ctrlKey)) {\n        return;\n      } // Prevent default behaviours as page zooming in touch devices.\n\n\n      event.preventDefault();\n\n      if (event.changedTouches) {\n        forEach(event.changedTouches, function (touch) {\n          pointers[touch.identifier] = getPointer(touch);\n        });\n      } else {\n        pointers[event.pointerId || 0] = getPointer(event);\n      }\n\n      var action = options.movable ? ACTION_MOVE : false;\n\n      if (options.zoomOnTouch && options.zoomable && Object.keys(pointers).length > 1) {\n        action = ACTION_ZOOM;\n      } else if (options.slideOnTouch && (event.pointerType === 'touch' || event.type === 'touchstart') && this.isSwitchable()) {\n        action = ACTION_SWITCH;\n      }\n\n      if (options.transition && (action === ACTION_MOVE || action === ACTION_ZOOM)) {\n        removeClass(this.image, CLASS_TRANSITION);\n      }\n\n      this.action = action;\n    },\n    pointermove: function pointermove(event) {\n      var pointers = this.pointers,\n          action = this.action;\n\n      if (!this.viewed || !action) {\n        return;\n      }\n\n      event.preventDefault();\n\n      if (event.changedTouches) {\n        forEach(event.changedTouches, function (touch) {\n          assign(pointers[touch.identifier] || {}, getPointer(touch, true));\n        });\n      } else {\n        assign(pointers[event.pointerId || 0] || {}, getPointer(event, true));\n      }\n\n      this.change(event);\n    },\n    pointerup: function pointerup(event) {\n      var _this2 = this;\n\n      var options = this.options,\n          action = this.action,\n          pointers = this.pointers;\n      var pointer;\n\n      if (event.changedTouches) {\n        forEach(event.changedTouches, function (touch) {\n          pointer = pointers[touch.identifier];\n          delete pointers[touch.identifier];\n        });\n      } else {\n        pointer = pointers[event.pointerId || 0];\n        delete pointers[event.pointerId || 0];\n      }\n\n      if (!action) {\n        return;\n      }\n\n      event.preventDefault();\n\n      if (options.transition && (action === ACTION_MOVE || action === ACTION_ZOOM)) {\n        addClass(this.image, CLASS_TRANSITION);\n      }\n\n      this.action = false; // Emulate click and double click in touch devices to support backdrop and image zooming (#210).\n\n      if (IS_TOUCH_DEVICE && action !== ACTION_ZOOM && pointer && Date.now() - pointer.timeStamp < 500) {\n        clearTimeout(this.clickCanvasTimeout);\n        clearTimeout(this.doubleClickImageTimeout);\n\n        if (options.toggleOnDblclick && this.viewed && event.target === this.image) {\n          if (this.imageClicked) {\n            this.imageClicked = false; // This timeout will be cleared later when a native dblclick event is triggering\n\n            this.doubleClickImageTimeout = setTimeout(function () {\n              dispatchEvent(_this2.image, EVENT_DBLCLICK);\n            }, 50);\n          } else {\n            this.imageClicked = true; // The default timing of a double click in Windows is 500 ms\n\n            this.doubleClickImageTimeout = setTimeout(function () {\n              _this2.imageClicked = false;\n            }, 500);\n          }\n        } else {\n          this.imageClicked = false;\n\n          if (options.backdrop && options.backdrop !== 'static' && event.target === this.canvas) {\n            // This timeout will be cleared later when a native click event is triggering\n            this.clickCanvasTimeout = setTimeout(function () {\n              dispatchEvent(_this2.canvas, EVENT_CLICK);\n            }, 50);\n          }\n        }\n      }\n    },\n    resize: function resize() {\n      var _this3 = this;\n\n      if (!this.isShown || this.hiding) {\n        return;\n      }\n\n      if (this.fulled) {\n        this.close();\n        this.initBody();\n        this.open();\n      }\n\n      this.initContainer();\n      this.initViewer();\n      this.renderViewer();\n      this.renderList();\n\n      if (this.viewed) {\n        this.initImage(function () {\n          _this3.renderImage();\n        });\n      }\n\n      if (this.played) {\n        if (this.options.fullscreen && this.fulled && !(document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement)) {\n          this.stop();\n          return;\n        }\n\n        forEach(this.player.getElementsByTagName('img'), function (image) {\n          addListener(image, EVENT_LOAD, _this3.loadImage.bind(_this3), {\n            once: true\n          });\n          dispatchEvent(image, EVENT_LOAD);\n        });\n      }\n    },\n    wheel: function wheel(event) {\n      var _this4 = this;\n\n      if (!this.viewed) {\n        return;\n      }\n\n      event.preventDefault(); // Limit wheel speed to prevent zoom too fast\n\n      if (this.wheeling) {\n        return;\n      }\n\n      this.wheeling = true;\n      setTimeout(function () {\n        _this4.wheeling = false;\n      }, 50);\n      var ratio = Number(this.options.zoomRatio) || 0.1;\n      var delta = 1;\n\n      if (event.deltaY) {\n        delta = event.deltaY > 0 ? 1 : -1;\n      } else if (event.wheelDelta) {\n        delta = -event.wheelDelta / 120;\n      } else if (event.detail) {\n        delta = event.detail > 0 ? 1 : -1;\n      }\n\n      this.zoom(-delta * ratio, true, event);\n    }\n  };\n\n  var methods = {\n    /** Show the viewer (only available in modal mode)\n     * @param {boolean} [immediate=false] - Indicates if show the viewer immediately or not.\n     * @returns {Viewer} this\n     */\n    show: function show() {\n      var immediate = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      var element = this.element,\n          options = this.options;\n\n      if (options.inline || this.showing || this.isShown || this.showing) {\n        return this;\n      }\n\n      if (!this.ready) {\n        this.build();\n\n        if (this.ready) {\n          this.show(immediate);\n        }\n\n        return this;\n      }\n\n      if (isFunction(options.show)) {\n        addListener(element, EVENT_SHOW, options.show, {\n          once: true\n        });\n      }\n\n      if (dispatchEvent(element, EVENT_SHOW) === false || !this.ready) {\n        return this;\n      }\n\n      if (this.hiding) {\n        this.transitioning.abort();\n      }\n\n      this.showing = true;\n      this.open();\n      var viewer = this.viewer;\n      removeClass(viewer, CLASS_HIDE);\n      viewer.setAttribute('role', 'dialog');\n      viewer.setAttribute('aria-labelledby', this.title.id);\n      viewer.setAttribute('aria-modal', true);\n      viewer.removeAttribute('aria-hidden');\n\n      if (options.transition && !immediate) {\n        var shown = this.shown.bind(this);\n        this.transitioning = {\n          abort: function abort() {\n            removeListener(viewer, EVENT_TRANSITION_END, shown);\n            removeClass(viewer, CLASS_IN);\n          }\n        };\n        addClass(viewer, CLASS_TRANSITION); // Force reflow to enable CSS3 transition\n\n        viewer.initialOffsetWidth = viewer.offsetWidth;\n        addListener(viewer, EVENT_TRANSITION_END, shown, {\n          once: true\n        });\n        addClass(viewer, CLASS_IN);\n      } else {\n        addClass(viewer, CLASS_IN);\n        this.shown();\n      }\n\n      return this;\n    },\n\n    /**\n     * Hide the viewer (only available in modal mode)\n     * @param {boolean} [immediate=false] - Indicates if hide the viewer immediately or not.\n     * @returns {Viewer} this\n     */\n    hide: function hide() {\n      var _this = this;\n\n      var immediate = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      var element = this.element,\n          options = this.options;\n\n      if (options.inline || this.hiding || !(this.isShown || this.showing)) {\n        return this;\n      }\n\n      if (isFunction(options.hide)) {\n        addListener(element, EVENT_HIDE, options.hide, {\n          once: true\n        });\n      }\n\n      if (dispatchEvent(element, EVENT_HIDE) === false) {\n        return this;\n      }\n\n      if (this.showing) {\n        this.transitioning.abort();\n      }\n\n      this.hiding = true;\n\n      if (this.played) {\n        this.stop();\n      } else if (this.viewing) {\n        this.viewing.abort();\n      }\n\n      var viewer = this.viewer,\n          image = this.image;\n\n      var hideImmediately = function hideImmediately() {\n        removeClass(viewer, CLASS_IN);\n\n        _this.hidden();\n      };\n\n      if (options.transition && !immediate) {\n        var onViewerTransitionEnd = function onViewerTransitionEnd(event) {\n          // Ignore all propagating `transitionend` events (#275).\n          if (event && event.target === viewer) {\n            removeListener(viewer, EVENT_TRANSITION_END, onViewerTransitionEnd);\n\n            _this.hidden();\n          }\n        };\n\n        var onImageTransitionEnd = function onImageTransitionEnd() {\n          // In case of show the viewer by `viewer.show(true)` previously (#407).\n          if (hasClass(viewer, CLASS_TRANSITION)) {\n            addListener(viewer, EVENT_TRANSITION_END, onViewerTransitionEnd);\n            removeClass(viewer, CLASS_IN);\n          } else {\n            hideImmediately();\n          }\n        };\n\n        this.transitioning = {\n          abort: function abort() {\n            if (_this.viewed && hasClass(image, CLASS_TRANSITION)) {\n              removeListener(image, EVENT_TRANSITION_END, onImageTransitionEnd);\n            } else if (hasClass(viewer, CLASS_TRANSITION)) {\n              removeListener(viewer, EVENT_TRANSITION_END, onViewerTransitionEnd);\n            }\n          }\n        }; // In case of hiding the viewer when holding on the image (#255),\n        // note that the `CLASS_TRANSITION` class will be removed on pointer down.\n\n        if (this.viewed && hasClass(image, CLASS_TRANSITION)) {\n          addListener(image, EVENT_TRANSITION_END, onImageTransitionEnd, {\n            once: true\n          });\n          this.zoomTo(0, false, false, true);\n        } else {\n          onImageTransitionEnd();\n        }\n      } else {\n        hideImmediately();\n      }\n\n      return this;\n    },\n\n    /**\n     * View one of the images with image's index\n     * @param {number} index - The index of the image to view.\n     * @returns {Viewer} this\n     */\n    view: function view() {\n      var _this2 = this;\n\n      var index = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.options.initialViewIndex;\n      index = Number(index) || 0;\n\n      if (this.hiding || this.played || index < 0 || index >= this.length || this.viewed && index === this.index) {\n        return this;\n      }\n\n      if (!this.isShown) {\n        this.index = index;\n        return this.show();\n      }\n\n      if (this.viewing) {\n        this.viewing.abort();\n      }\n\n      var element = this.element,\n          options = this.options,\n          title = this.title,\n          canvas = this.canvas;\n      var item = this.items[index];\n      var img = item.querySelector('img');\n      var url = getData(img, 'originalUrl');\n      var alt = img.getAttribute('alt');\n      var image = document.createElement('img');\n      forEach(options.inheritedAttributes, function (name) {\n        var value = img.getAttribute(name);\n\n        if (value !== null) {\n          image.setAttribute(name, value);\n        }\n      });\n      image.src = url;\n      image.alt = alt;\n\n      if (isFunction(options.view)) {\n        addListener(element, EVENT_VIEW, options.view, {\n          once: true\n        });\n      }\n\n      if (dispatchEvent(element, EVENT_VIEW, {\n        originalImage: this.images[index],\n        index: index,\n        image: image\n      }) === false || !this.isShown || this.hiding || this.played) {\n        return this;\n      }\n\n      var activeItem = this.items[this.index];\n      removeClass(activeItem, CLASS_ACTIVE);\n      activeItem.removeAttribute('aria-selected');\n      addClass(item, CLASS_ACTIVE);\n      item.setAttribute('aria-selected', true);\n\n      if (options.focus) {\n        item.focus();\n      }\n\n      this.image = image;\n      this.viewed = false;\n      this.index = index;\n      this.imageData = {};\n      addClass(image, CLASS_INVISIBLE);\n\n      if (options.loading) {\n        addClass(canvas, CLASS_LOADING);\n      }\n\n      canvas.innerHTML = '';\n      canvas.appendChild(image); // Center current item\n\n      this.renderList(); // Clear title\n\n      title.innerHTML = ''; // Generate title after viewed\n\n      var onViewed = function onViewed() {\n        var imageData = _this2.imageData;\n        var render = Array.isArray(options.title) ? options.title[1] : options.title;\n        title.innerHTML = escapeHTMLEntities(isFunction(render) ? render.call(_this2, image, imageData) : \"\".concat(alt, \" (\").concat(imageData.naturalWidth, \" \\xD7 \").concat(imageData.naturalHeight, \")\"));\n      };\n\n      var onLoad;\n      addListener(element, EVENT_VIEWED, onViewed, {\n        once: true\n      });\n      this.viewing = {\n        abort: function abort() {\n          removeListener(element, EVENT_VIEWED, onViewed);\n\n          if (image.complete) {\n            if (_this2.imageRendering) {\n              _this2.imageRendering.abort();\n            } else if (_this2.imageInitializing) {\n              _this2.imageInitializing.abort();\n            }\n          } else {\n            // Cancel download to save bandwidth.\n            image.src = '';\n            removeListener(image, EVENT_LOAD, onLoad);\n\n            if (_this2.timeout) {\n              clearTimeout(_this2.timeout);\n            }\n          }\n        }\n      };\n\n      if (image.complete) {\n        this.load();\n      } else {\n        addListener(image, EVENT_LOAD, onLoad = this.load.bind(this), {\n          once: true\n        });\n\n        if (this.timeout) {\n          clearTimeout(this.timeout);\n        } // Make the image visible if it fails to load within 1s\n\n\n        this.timeout = setTimeout(function () {\n          removeClass(image, CLASS_INVISIBLE);\n          _this2.timeout = false;\n        }, 1000);\n      }\n\n      return this;\n    },\n\n    /**\n     * View the previous image\n     * @param {boolean} [loop=false] - Indicate if view the last one\n     * when it is the first one at present.\n     * @returns {Viewer} this\n     */\n    prev: function prev() {\n      var loop = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      var index = this.index - 1;\n\n      if (index < 0) {\n        index = loop ? this.length - 1 : 0;\n      }\n\n      this.view(index);\n      return this;\n    },\n\n    /**\n     * View the next image\n     * @param {boolean} [loop=false] - Indicate if view the first one\n     * when it is the last one at present.\n     * @returns {Viewer} this\n     */\n    next: function next() {\n      var loop = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      var maxIndex = this.length - 1;\n      var index = this.index + 1;\n\n      if (index > maxIndex) {\n        index = loop ? 0 : maxIndex;\n      }\n\n      this.view(index);\n      return this;\n    },\n\n    /**\n     * Move the image with relative offsets.\n     * @param {number} x - The moving distance in the horizontal direction.\n     * @param {number} [y=x] The moving distance in the vertical direction.\n     * @returns {Viewer} this\n     */\n    move: function move(x) {\n      var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : x;\n      var imageData = this.imageData;\n      this.moveTo(isUndefined(x) ? x : imageData.x + Number(x), isUndefined(y) ? y : imageData.y + Number(y));\n      return this;\n    },\n\n    /**\n     * Move the image to an absolute point.\n     * @param {number} x - The new position in the horizontal direction.\n     * @param {number} [y=x] - The new position in the vertical direction.\n     * @param {Event} [_originalEvent=null] - The original event if any.\n     * @returns {Viewer} this\n     */\n    moveTo: function moveTo(x) {\n      var _this3 = this;\n\n      var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : x;\n\n      var _originalEvent = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n\n      var element = this.element,\n          options = this.options,\n          imageData = this.imageData;\n      x = Number(x);\n      y = Number(y);\n\n      if (this.viewed && !this.played && options.movable) {\n        var oldX = imageData.x;\n        var oldY = imageData.y;\n        var changed = false;\n\n        if (isNumber(x)) {\n          changed = true;\n        } else {\n          x = oldX;\n        }\n\n        if (isNumber(y)) {\n          changed = true;\n        } else {\n          y = oldY;\n        }\n\n        if (changed) {\n          if (isFunction(options.move)) {\n            addListener(element, EVENT_MOVE, options.move, {\n              once: true\n            });\n          }\n\n          if (dispatchEvent(element, EVENT_MOVE, {\n            x: x,\n            y: y,\n            oldX: oldX,\n            oldY: oldY,\n            originalEvent: _originalEvent\n          }) === false) {\n            return this;\n          }\n\n          imageData.x = x;\n          imageData.y = y;\n          imageData.left = x;\n          imageData.top = y;\n          this.moving = true;\n          this.renderImage(function () {\n            _this3.moving = false;\n\n            if (isFunction(options.moved)) {\n              addListener(element, EVENT_MOVED, options.moved, {\n                once: true\n              });\n            }\n\n            dispatchEvent(element, EVENT_MOVED, {\n              x: x,\n              y: y,\n              oldX: oldX,\n              oldY: oldY,\n              originalEvent: _originalEvent\n            }, {\n              cancelable: false\n            });\n          });\n        }\n      }\n\n      return this;\n    },\n\n    /**\n     * Rotate the image with a relative degree.\n     * @param {number} degree - The rotate degree.\n     * @returns {Viewer} this\n     */\n    rotate: function rotate(degree) {\n      this.rotateTo((this.imageData.rotate || 0) + Number(degree));\n      return this;\n    },\n\n    /**\n     * Rotate the image to an absolute degree.\n     * @param {number} degree - The rotate degree.\n     * @returns {Viewer} this\n     */\n    rotateTo: function rotateTo(degree) {\n      var _this4 = this;\n\n      var element = this.element,\n          options = this.options,\n          imageData = this.imageData;\n      degree = Number(degree);\n\n      if (isNumber(degree) && this.viewed && !this.played && options.rotatable) {\n        var oldDegree = imageData.rotate;\n\n        if (isFunction(options.rotate)) {\n          addListener(element, EVENT_ROTATE, options.rotate, {\n            once: true\n          });\n        }\n\n        if (dispatchEvent(element, EVENT_ROTATE, {\n          degree: degree,\n          oldDegree: oldDegree\n        }) === false) {\n          return this;\n        }\n\n        imageData.rotate = degree;\n        this.rotating = true;\n        this.renderImage(function () {\n          _this4.rotating = false;\n\n          if (isFunction(options.rotated)) {\n            addListener(element, EVENT_ROTATED, options.rotated, {\n              once: true\n            });\n          }\n\n          dispatchEvent(element, EVENT_ROTATED, {\n            degree: degree,\n            oldDegree: oldDegree\n          }, {\n            cancelable: false\n          });\n        });\n      }\n\n      return this;\n    },\n\n    /**\n     * Scale the image on the x-axis.\n     * @param {number} scaleX - The scale ratio on the x-axis.\n     * @returns {Viewer} this\n     */\n    scaleX: function scaleX(_scaleX) {\n      this.scale(_scaleX, this.imageData.scaleY);\n      return this;\n    },\n\n    /**\n     * Scale the image on the y-axis.\n     * @param {number} scaleY - The scale ratio on the y-axis.\n     * @returns {Viewer} this\n     */\n    scaleY: function scaleY(_scaleY) {\n      this.scale(this.imageData.scaleX, _scaleY);\n      return this;\n    },\n\n    /**\n     * Scale the image.\n     * @param {number} scaleX - The scale ratio on the x-axis.\n     * @param {number} [scaleY=scaleX] - The scale ratio on the y-axis.\n     * @returns {Viewer} this\n     */\n    scale: function scale(scaleX) {\n      var _this5 = this;\n\n      var scaleY = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : scaleX;\n      var element = this.element,\n          options = this.options,\n          imageData = this.imageData;\n      scaleX = Number(scaleX);\n      scaleY = Number(scaleY);\n\n      if (this.viewed && !this.played && options.scalable) {\n        var oldScaleX = imageData.scaleX;\n        var oldScaleY = imageData.scaleY;\n        var changed = false;\n\n        if (isNumber(scaleX)) {\n          changed = true;\n        } else {\n          scaleX = oldScaleX;\n        }\n\n        if (isNumber(scaleY)) {\n          changed = true;\n        } else {\n          scaleY = oldScaleY;\n        }\n\n        if (changed) {\n          if (isFunction(options.scale)) {\n            addListener(element, EVENT_SCALE, options.scale, {\n              once: true\n            });\n          }\n\n          if (dispatchEvent(element, EVENT_SCALE, {\n            scaleX: scaleX,\n            scaleY: scaleY,\n            oldScaleX: oldScaleX,\n            oldScaleY: oldScaleY\n          }) === false) {\n            return this;\n          }\n\n          imageData.scaleX = scaleX;\n          imageData.scaleY = scaleY;\n          this.scaling = true;\n          this.renderImage(function () {\n            _this5.scaling = false;\n\n            if (isFunction(options.scaled)) {\n              addListener(element, EVENT_SCALED, options.scaled, {\n                once: true\n              });\n            }\n\n            dispatchEvent(element, EVENT_SCALED, {\n              scaleX: scaleX,\n              scaleY: scaleY,\n              oldScaleX: oldScaleX,\n              oldScaleY: oldScaleY\n            }, {\n              cancelable: false\n            });\n          });\n        }\n      }\n\n      return this;\n    },\n\n    /**\n     * Zoom the image with a relative ratio.\n     * @param {number} ratio - The target ratio.\n     * @param {boolean} [hasTooltip=false] - Indicates if it has a tooltip or not.\n     * @param {Event} [_originalEvent=null] - The original event if any.\n     * @returns {Viewer} this\n     */\n    zoom: function zoom(ratio) {\n      var hasTooltip = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n      var _originalEvent = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n\n      var imageData = this.imageData;\n      ratio = Number(ratio);\n\n      if (ratio < 0) {\n        ratio = 1 / (1 - ratio);\n      } else {\n        ratio = 1 + ratio;\n      }\n\n      this.zoomTo(imageData.width * ratio / imageData.naturalWidth, hasTooltip, _originalEvent);\n      return this;\n    },\n\n    /**\n     * Zoom the image to an absolute ratio.\n     * @param {number} ratio - The target ratio.\n     * @param {boolean} [hasTooltip=false] - Indicates if it has a tooltip or not.\n     * @param {Event} [_originalEvent=null] - The original event if any.\n     * @param {Event} [_zoomable=false] - Indicates if the current zoom is available or not.\n     * @returns {Viewer} this\n     */\n    zoomTo: function zoomTo(ratio) {\n      var _this6 = this;\n\n      var hasTooltip = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n      var _originalEvent = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n\n      var _zoomable = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n\n      var element = this.element,\n          options = this.options,\n          pointers = this.pointers,\n          imageData = this.imageData;\n      var x = imageData.x,\n          y = imageData.y,\n          width = imageData.width,\n          height = imageData.height,\n          naturalWidth = imageData.naturalWidth,\n          naturalHeight = imageData.naturalHeight;\n      ratio = Math.max(0, ratio);\n\n      if (isNumber(ratio) && this.viewed && !this.played && (_zoomable || options.zoomable)) {\n        if (!_zoomable) {\n          var minZoomRatio = Math.max(0.01, options.minZoomRatio);\n          var maxZoomRatio = Math.min(100, options.maxZoomRatio);\n          ratio = Math.min(Math.max(ratio, minZoomRatio), maxZoomRatio);\n        }\n\n        if (_originalEvent && options.zoomRatio >= 0.055 && ratio > 0.95 && ratio < 1.05) {\n          ratio = 1;\n        }\n\n        var newWidth = naturalWidth * ratio;\n        var newHeight = naturalHeight * ratio;\n        var offsetWidth = newWidth - width;\n        var offsetHeight = newHeight - height;\n        var oldRatio = width / naturalWidth;\n\n        if (isFunction(options.zoom)) {\n          addListener(element, EVENT_ZOOM, options.zoom, {\n            once: true\n          });\n        }\n\n        if (dispatchEvent(element, EVENT_ZOOM, {\n          ratio: ratio,\n          oldRatio: oldRatio,\n          originalEvent: _originalEvent\n        }) === false) {\n          return this;\n        }\n\n        this.zooming = true;\n\n        if (_originalEvent) {\n          var offset = getOffset(this.viewer);\n          var center = pointers && Object.keys(pointers).length ? getPointersCenter(pointers) : {\n            pageX: _originalEvent.pageX,\n            pageY: _originalEvent.pageY\n          }; // Zoom from the triggering point of the event\n\n          imageData.x -= offsetWidth * ((center.pageX - offset.left - x) / width);\n          imageData.y -= offsetHeight * ((center.pageY - offset.top - y) / height);\n        } else {\n          // Zoom from the center of the image\n          imageData.x -= offsetWidth / 2;\n          imageData.y -= offsetHeight / 2;\n        }\n\n        imageData.left = imageData.x;\n        imageData.top = imageData.y;\n        imageData.width = newWidth;\n        imageData.height = newHeight;\n        imageData.ratio = ratio;\n        this.renderImage(function () {\n          _this6.zooming = false;\n\n          if (isFunction(options.zoomed)) {\n            addListener(element, EVENT_ZOOMED, options.zoomed, {\n              once: true\n            });\n          }\n\n          dispatchEvent(element, EVENT_ZOOMED, {\n            ratio: ratio,\n            oldRatio: oldRatio,\n            originalEvent: _originalEvent\n          }, {\n            cancelable: false\n          });\n        });\n\n        if (hasTooltip) {\n          this.tooltip();\n        }\n      }\n\n      return this;\n    },\n\n    /**\n     * Play the images\n     * @param {boolean} [fullscreen=false] - Indicate if request fullscreen or not.\n     * @returns {Viewer} this\n     */\n    play: function play() {\n      var _this7 = this;\n\n      var fullscreen = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n      if (!this.isShown || this.played) {\n        return this;\n      }\n\n      var element = this.element,\n          options = this.options;\n\n      if (isFunction(options.play)) {\n        addListener(element, EVENT_PLAY, options.play, {\n          once: true\n        });\n      }\n\n      if (dispatchEvent(element, EVENT_PLAY) === false) {\n        return this;\n      }\n\n      var player = this.player;\n      var onLoad = this.loadImage.bind(this);\n      var list = [];\n      var total = 0;\n      var index = 0;\n      this.played = true;\n      this.onLoadWhenPlay = onLoad;\n\n      if (fullscreen) {\n        this.requestFullscreen();\n      }\n\n      addClass(player, CLASS_SHOW);\n      forEach(this.items, function (item, i) {\n        var img = item.querySelector('img');\n        var image = document.createElement('img');\n        image.src = getData(img, 'originalUrl');\n        image.alt = img.getAttribute('alt');\n        image.referrerPolicy = img.referrerPolicy;\n        total += 1;\n        addClass(image, CLASS_FADE);\n        toggleClass(image, CLASS_TRANSITION, options.transition);\n\n        if (hasClass(item, CLASS_ACTIVE)) {\n          addClass(image, CLASS_IN);\n          index = i;\n        }\n\n        list.push(image);\n        addListener(image, EVENT_LOAD, onLoad, {\n          once: true\n        });\n        player.appendChild(image);\n      });\n\n      if (isNumber(options.interval) && options.interval > 0) {\n        var play = function play() {\n          _this7.playing = setTimeout(function () {\n            removeClass(list[index], CLASS_IN);\n            index += 1;\n            index = index < total ? index : 0;\n            addClass(list[index], CLASS_IN);\n            play();\n          }, options.interval);\n        };\n\n        if (total > 1) {\n          play();\n        }\n      }\n\n      return this;\n    },\n    // Stop play\n    stop: function stop() {\n      var _this8 = this;\n\n      if (!this.played) {\n        return this;\n      }\n\n      var element = this.element,\n          options = this.options;\n\n      if (isFunction(options.stop)) {\n        addListener(element, EVENT_STOP, options.stop, {\n          once: true\n        });\n      }\n\n      if (dispatchEvent(element, EVENT_STOP) === false) {\n        return this;\n      }\n\n      var player = this.player;\n      this.played = false;\n      clearTimeout(this.playing);\n      forEach(player.getElementsByTagName('img'), function (image) {\n        removeListener(image, EVENT_LOAD, _this8.onLoadWhenPlay);\n      });\n      removeClass(player, CLASS_SHOW);\n      player.innerHTML = '';\n      this.exitFullscreen();\n      return this;\n    },\n    // Enter modal mode (only available in inline mode)\n    full: function full() {\n      var _this9 = this;\n\n      var options = this.options,\n          viewer = this.viewer,\n          image = this.image,\n          list = this.list;\n\n      if (!this.isShown || this.played || this.fulled || !options.inline) {\n        return this;\n      }\n\n      this.fulled = true;\n      this.open();\n      addClass(this.button, CLASS_FULLSCREEN_EXIT);\n\n      if (options.transition) {\n        removeClass(list, CLASS_TRANSITION);\n\n        if (this.viewed) {\n          removeClass(image, CLASS_TRANSITION);\n        }\n      }\n\n      addClass(viewer, CLASS_FIXED);\n      viewer.setAttribute('role', 'dialog');\n      viewer.setAttribute('aria-labelledby', this.title.id);\n      viewer.setAttribute('aria-modal', true);\n      viewer.removeAttribute('style');\n      setStyle(viewer, {\n        zIndex: options.zIndex\n      });\n\n      if (options.focus) {\n        this.enforceFocus();\n      }\n\n      this.initContainer();\n      this.viewerData = assign({}, this.containerData);\n      this.renderList();\n\n      if (this.viewed) {\n        this.initImage(function () {\n          _this9.renderImage(function () {\n            if (options.transition) {\n              setTimeout(function () {\n                addClass(image, CLASS_TRANSITION);\n                addClass(list, CLASS_TRANSITION);\n              }, 0);\n            }\n          });\n        });\n      }\n\n      return this;\n    },\n    // Exit modal mode (only available in inline mode)\n    exit: function exit() {\n      var _this10 = this;\n\n      var options = this.options,\n          viewer = this.viewer,\n          image = this.image,\n          list = this.list;\n\n      if (!this.isShown || this.played || !this.fulled || !options.inline) {\n        return this;\n      }\n\n      this.fulled = false;\n      this.close();\n      removeClass(this.button, CLASS_FULLSCREEN_EXIT);\n\n      if (options.transition) {\n        removeClass(list, CLASS_TRANSITION);\n\n        if (this.viewed) {\n          removeClass(image, CLASS_TRANSITION);\n        }\n      }\n\n      if (options.focus) {\n        this.clearEnforceFocus();\n      }\n\n      viewer.removeAttribute('role');\n      viewer.removeAttribute('aria-labelledby');\n      viewer.removeAttribute('aria-modal');\n      removeClass(viewer, CLASS_FIXED);\n      setStyle(viewer, {\n        zIndex: options.zIndexInline\n      });\n      this.viewerData = assign({}, this.parentData);\n      this.renderViewer();\n      this.renderList();\n\n      if (this.viewed) {\n        this.initImage(function () {\n          _this10.renderImage(function () {\n            if (options.transition) {\n              setTimeout(function () {\n                addClass(image, CLASS_TRANSITION);\n                addClass(list, CLASS_TRANSITION);\n              }, 0);\n            }\n          });\n        });\n      }\n\n      return this;\n    },\n    // Show the current ratio of the image with percentage\n    tooltip: function tooltip() {\n      var _this11 = this;\n\n      var options = this.options,\n          tooltipBox = this.tooltipBox,\n          imageData = this.imageData;\n\n      if (!this.viewed || this.played || !options.tooltip) {\n        return this;\n      }\n\n      tooltipBox.textContent = \"\".concat(Math.round(imageData.ratio * 100), \"%\");\n\n      if (!this.tooltipping) {\n        if (options.transition) {\n          if (this.fading) {\n            dispatchEvent(tooltipBox, EVENT_TRANSITION_END);\n          }\n\n          addClass(tooltipBox, CLASS_SHOW);\n          addClass(tooltipBox, CLASS_FADE);\n          addClass(tooltipBox, CLASS_TRANSITION);\n          tooltipBox.removeAttribute('aria-hidden'); // Force reflow to enable CSS3 transition\n\n          tooltipBox.initialOffsetWidth = tooltipBox.offsetWidth;\n          addClass(tooltipBox, CLASS_IN);\n        } else {\n          addClass(tooltipBox, CLASS_SHOW);\n          tooltipBox.removeAttribute('aria-hidden');\n        }\n      } else {\n        clearTimeout(this.tooltipping);\n      }\n\n      this.tooltipping = setTimeout(function () {\n        if (options.transition) {\n          addListener(tooltipBox, EVENT_TRANSITION_END, function () {\n            removeClass(tooltipBox, CLASS_SHOW);\n            removeClass(tooltipBox, CLASS_FADE);\n            removeClass(tooltipBox, CLASS_TRANSITION);\n            tooltipBox.setAttribute('aria-hidden', true);\n            _this11.fading = false;\n          }, {\n            once: true\n          });\n          removeClass(tooltipBox, CLASS_IN);\n          _this11.fading = true;\n        } else {\n          removeClass(tooltipBox, CLASS_SHOW);\n          tooltipBox.setAttribute('aria-hidden', true);\n        }\n\n        _this11.tooltipping = false;\n      }, 1000);\n      return this;\n    },\n    // Toggle the image size between its natural size and initial size\n    toggle: function toggle() {\n      if (this.imageData.ratio === 1) {\n        this.zoomTo(this.initialImageData.ratio, true);\n      } else {\n        this.zoomTo(1, true);\n      }\n\n      return this;\n    },\n    // Reset the image to its initial state\n    reset: function reset() {\n      if (this.viewed && !this.played) {\n        this.imageData = assign({}, this.initialImageData);\n        this.renderImage();\n      }\n\n      return this;\n    },\n    // Update viewer when images changed\n    update: function update() {\n      var _this12 = this;\n\n      var element = this.element,\n          options = this.options,\n          isImg = this.isImg; // Destroy viewer if the target image was deleted\n\n      if (isImg && !element.parentNode) {\n        return this.destroy();\n      }\n\n      var images = [];\n      forEach(isImg ? [element] : element.querySelectorAll('img'), function (image) {\n        if (isFunction(options.filter)) {\n          if (options.filter.call(_this12, image)) {\n            images.push(image);\n          }\n        } else if (_this12.getImageURL(image)) {\n          images.push(image);\n        }\n      });\n\n      if (!images.length) {\n        return this;\n      }\n\n      this.images = images;\n      this.length = images.length;\n\n      if (this.ready) {\n        var changedIndexes = [];\n        forEach(this.items, function (item, i) {\n          var img = item.querySelector('img');\n          var image = images[i];\n\n          if (image && img) {\n            if (image.src !== img.src // Title changed (#408)\n            || image.alt !== img.alt) {\n              changedIndexes.push(i);\n            }\n          } else {\n            changedIndexes.push(i);\n          }\n        });\n        setStyle(this.list, {\n          width: 'auto'\n        });\n        this.initList();\n\n        if (this.isShown) {\n          if (this.length) {\n            if (this.viewed) {\n              var changedIndex = changedIndexes.indexOf(this.index);\n\n              if (changedIndex >= 0) {\n                this.viewed = false;\n                this.view(Math.max(Math.min(this.index - changedIndex, this.length - 1), 0));\n              } else {\n                var activeItem = this.items[this.index]; // Reactivate the current viewing item after reset the list.\n\n                addClass(activeItem, CLASS_ACTIVE);\n                activeItem.setAttribute('aria-selected', true);\n              }\n            }\n          } else {\n            this.image = null;\n            this.viewed = false;\n            this.index = 0;\n            this.imageData = {};\n            this.canvas.innerHTML = '';\n            this.title.innerHTML = '';\n          }\n        }\n      } else {\n        this.build();\n      }\n\n      return this;\n    },\n    // Destroy the viewer\n    destroy: function destroy() {\n      var element = this.element,\n          options = this.options;\n\n      if (!element[NAMESPACE]) {\n        return this;\n      }\n\n      this.destroyed = true;\n\n      if (this.ready) {\n        if (this.played) {\n          this.stop();\n        }\n\n        if (options.inline) {\n          if (this.fulled) {\n            this.exit();\n          }\n\n          this.unbind();\n        } else if (this.isShown) {\n          if (this.viewing) {\n            if (this.imageRendering) {\n              this.imageRendering.abort();\n            } else if (this.imageInitializing) {\n              this.imageInitializing.abort();\n            }\n          }\n\n          if (this.hiding) {\n            this.transitioning.abort();\n          }\n\n          this.hidden();\n        } else if (this.showing) {\n          this.transitioning.abort();\n          this.hidden();\n        }\n\n        this.ready = false;\n        this.viewer.parentNode.removeChild(this.viewer);\n      } else if (options.inline) {\n        if (this.delaying) {\n          this.delaying.abort();\n        } else if (this.initializing) {\n          this.initializing.abort();\n        }\n      }\n\n      if (!options.inline) {\n        removeListener(element, EVENT_CLICK, this.onStart);\n      }\n\n      element[NAMESPACE] = undefined;\n      return this;\n    }\n  };\n\n  var others = {\n    getImageURL: function getImageURL(image) {\n      var url = this.options.url;\n\n      if (isString(url)) {\n        url = image.getAttribute(url);\n      } else if (isFunction(url)) {\n        url = url.call(this, image);\n      } else {\n        url = '';\n      }\n\n      return url;\n    },\n    enforceFocus: function enforceFocus() {\n      var _this = this;\n\n      this.clearEnforceFocus();\n      addListener(document, EVENT_FOCUSIN, this.onFocusin = function (_ref) {\n        var target = _ref.target;\n        var viewer = _this.viewer;\n\n        if (target !== document && target !== viewer && !viewer.contains(target)) {\n          viewer.focus();\n        }\n      });\n    },\n    clearEnforceFocus: function clearEnforceFocus() {\n      if (this.onFocusin) {\n        removeListener(document, EVENT_FOCUSIN, this.onFocusin);\n        this.onFocusin = null;\n      }\n    },\n    open: function open() {\n      var body = this.body;\n      addClass(body, CLASS_OPEN);\n      body.style.paddingRight = \"\".concat(this.scrollbarWidth + (parseFloat(this.initialBodyComputedPaddingRight) || 0), \"px\");\n    },\n    close: function close() {\n      var body = this.body;\n      removeClass(body, CLASS_OPEN);\n      body.style.paddingRight = this.initialBodyPaddingRight;\n    },\n    shown: function shown() {\n      var element = this.element,\n          options = this.options,\n          viewer = this.viewer;\n      this.fulled = true;\n      this.isShown = true;\n      this.render();\n      this.bind();\n      this.showing = false;\n\n      if (options.focus) {\n        viewer.focus();\n        this.enforceFocus();\n      }\n\n      if (isFunction(options.shown)) {\n        addListener(element, EVENT_SHOWN, options.shown, {\n          once: true\n        });\n      }\n\n      if (dispatchEvent(element, EVENT_SHOWN) === false) {\n        return;\n      }\n\n      if (this.ready && this.isShown && !this.hiding) {\n        this.view(this.index);\n      }\n    },\n    hidden: function hidden() {\n      var element = this.element,\n          options = this.options,\n          viewer = this.viewer;\n\n      if (options.fucus) {\n        this.clearEnforceFocus();\n      }\n\n      this.fulled = false;\n      this.viewed = false;\n      this.isShown = false;\n      this.close();\n      this.unbind();\n      addClass(viewer, CLASS_HIDE);\n      viewer.removeAttribute('role');\n      viewer.removeAttribute('aria-labelledby');\n      viewer.removeAttribute('aria-modal');\n      viewer.setAttribute('aria-hidden', true);\n      this.resetList();\n      this.resetImage();\n      this.hiding = false;\n\n      if (!this.destroyed) {\n        if (isFunction(options.hidden)) {\n          addListener(element, EVENT_HIDDEN, options.hidden, {\n            once: true\n          });\n        }\n\n        dispatchEvent(element, EVENT_HIDDEN, null, {\n          cancelable: false\n        });\n      }\n    },\n    requestFullscreen: function requestFullscreen() {\n      var document = this.element.ownerDocument;\n\n      if (this.fulled && !(document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement)) {\n        var documentElement = document.documentElement; // Element.requestFullscreen()\n\n        if (documentElement.requestFullscreen) {\n          documentElement.requestFullscreen();\n        } else if (documentElement.webkitRequestFullscreen) {\n          documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);\n        } else if (documentElement.mozRequestFullScreen) {\n          documentElement.mozRequestFullScreen();\n        } else if (documentElement.msRequestFullscreen) {\n          documentElement.msRequestFullscreen();\n        }\n      }\n    },\n    exitFullscreen: function exitFullscreen() {\n      var document = this.element.ownerDocument;\n\n      if (this.fulled && (document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement)) {\n        // Document.exitFullscreen()\n        if (document.exitFullscreen) {\n          document.exitFullscreen();\n        } else if (document.webkitExitFullscreen) {\n          document.webkitExitFullscreen();\n        } else if (document.mozCancelFullScreen) {\n          document.mozCancelFullScreen();\n        } else if (document.msExitFullscreen) {\n          document.msExitFullscreen();\n        }\n      }\n    },\n    change: function change(event) {\n      var options = this.options,\n          pointers = this.pointers;\n      var pointer = pointers[Object.keys(pointers)[0]]; // In the case of the `pointers` object is empty (#421)\n\n      if (!pointer) {\n        return;\n      }\n\n      var offsetX = pointer.endX - pointer.startX;\n      var offsetY = pointer.endY - pointer.startY;\n\n      switch (this.action) {\n        // Move the current image\n        case ACTION_MOVE:\n          this.move(offsetX, offsetY, event);\n          break;\n        // Zoom the current image\n\n        case ACTION_ZOOM:\n          this.zoom(getMaxZoomRatio(pointers), false, event);\n          break;\n\n        case ACTION_SWITCH:\n          {\n            this.action = 'switched';\n            var absoluteOffsetX = Math.abs(offsetX);\n\n            if (absoluteOffsetX > 1 && absoluteOffsetX > Math.abs(offsetY)) {\n              // Empty `pointers` as `touchend` event will not be fired after swiped in iOS browsers.\n              this.pointers = {};\n\n              if (offsetX > 1) {\n                this.prev(options.loop);\n              } else if (offsetX < -1) {\n                this.next(options.loop);\n              }\n            }\n\n            break;\n          }\n      } // Override\n\n\n      forEach(pointers, function (p) {\n        p.startX = p.endX;\n        p.startY = p.endY;\n      });\n    },\n    isSwitchable: function isSwitchable() {\n      var imageData = this.imageData,\n          viewerData = this.viewerData;\n      return this.length > 1 && imageData.x >= 0 && imageData.y >= 0 && imageData.width <= viewerData.width && imageData.height <= viewerData.height;\n    }\n  };\n\n  var AnotherViewer = WINDOW.Viewer;\n\n  var getUniqueID = function (id) {\n    return function () {\n      id += 1;\n      return id;\n    };\n  }(-1);\n\n  var Viewer = /*#__PURE__*/function () {\n    /**\n     * Create a new Viewer.\n     * @param {Element} element - The target element for viewing.\n     * @param {Object} [options={}] - The configuration options.\n     */\n    function Viewer(element) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      _classCallCheck(this, Viewer);\n\n      if (!element || element.nodeType !== 1) {\n        throw new Error('The first argument is required and must be an element.');\n      }\n\n      this.element = element;\n      this.options = assign({}, DEFAULTS, isPlainObject(options) && options);\n      this.action = false;\n      this.fading = false;\n      this.fulled = false;\n      this.hiding = false;\n      this.imageClicked = false;\n      this.imageData = {};\n      this.index = this.options.initialViewIndex;\n      this.isImg = false;\n      this.isShown = false;\n      this.length = 0;\n      this.moving = false;\n      this.played = false;\n      this.playing = false;\n      this.pointers = {};\n      this.ready = false;\n      this.rotating = false;\n      this.scaling = false;\n      this.showing = false;\n      this.timeout = false;\n      this.tooltipping = false;\n      this.viewed = false;\n      this.viewing = false;\n      this.wheeling = false;\n      this.zooming = false;\n      this.id = getUniqueID();\n      this.init();\n    }\n\n    _createClass(Viewer, [{\n      key: \"init\",\n      value: function init() {\n        var _this = this;\n\n        var element = this.element,\n            options = this.options;\n\n        if (element[NAMESPACE]) {\n          return;\n        }\n\n        element[NAMESPACE] = this; // The `focus` option requires the `keyboard` option set to `true`.\n\n        if (options.focus && !options.keyboard) {\n          options.focus = false;\n        }\n\n        var isImg = element.localName === 'img';\n        var images = [];\n        forEach(isImg ? [element] : element.querySelectorAll('img'), function (image) {\n          if (isFunction(options.filter)) {\n            if (options.filter.call(_this, image)) {\n              images.push(image);\n            }\n          } else if (_this.getImageURL(image)) {\n            images.push(image);\n          }\n        });\n        this.isImg = isImg;\n        this.length = images.length;\n        this.images = images;\n        this.initBody(); // Override `transition` option if it is not supported\n\n        if (isUndefined(document.createElement(NAMESPACE).style.transition)) {\n          options.transition = false;\n        }\n\n        if (options.inline) {\n          var count = 0;\n\n          var progress = function progress() {\n            count += 1;\n\n            if (count === _this.length) {\n              var timeout;\n              _this.initializing = false;\n              _this.delaying = {\n                abort: function abort() {\n                  clearTimeout(timeout);\n                }\n              }; // build asynchronously to keep `this.viewer` is accessible in `ready` event handler.\n\n              timeout = setTimeout(function () {\n                _this.delaying = false;\n\n                _this.build();\n              }, 0);\n            }\n          };\n\n          this.initializing = {\n            abort: function abort() {\n              forEach(images, function (image) {\n                if (!image.complete) {\n                  removeListener(image, EVENT_LOAD, progress);\n                }\n              });\n            }\n          };\n          forEach(images, function (image) {\n            if (image.complete) {\n              progress();\n            } else {\n              addListener(image, EVENT_LOAD, progress, {\n                once: true\n              });\n            }\n          });\n        } else {\n          addListener(element, EVENT_CLICK, this.onStart = function (_ref) {\n            var target = _ref.target;\n\n            if (target.localName === 'img' && (!isFunction(options.filter) || options.filter.call(_this, target))) {\n              _this.view(_this.images.indexOf(target));\n            }\n          });\n        }\n      }\n    }, {\n      key: \"build\",\n      value: function build() {\n        if (this.ready) {\n          return;\n        }\n\n        var element = this.element,\n            options = this.options;\n        var parent = element.parentNode;\n        var template = document.createElement('div');\n        template.innerHTML = TEMPLATE;\n        var viewer = template.querySelector(\".\".concat(NAMESPACE, \"-container\"));\n        var title = viewer.querySelector(\".\".concat(NAMESPACE, \"-title\"));\n        var toolbar = viewer.querySelector(\".\".concat(NAMESPACE, \"-toolbar\"));\n        var navbar = viewer.querySelector(\".\".concat(NAMESPACE, \"-navbar\"));\n        var button = viewer.querySelector(\".\".concat(NAMESPACE, \"-button\"));\n        var canvas = viewer.querySelector(\".\".concat(NAMESPACE, \"-canvas\"));\n        this.parent = parent;\n        this.viewer = viewer;\n        this.title = title;\n        this.toolbar = toolbar;\n        this.navbar = navbar;\n        this.button = button;\n        this.canvas = canvas;\n        this.footer = viewer.querySelector(\".\".concat(NAMESPACE, \"-footer\"));\n        this.tooltipBox = viewer.querySelector(\".\".concat(NAMESPACE, \"-tooltip\"));\n        this.player = viewer.querySelector(\".\".concat(NAMESPACE, \"-player\"));\n        this.list = viewer.querySelector(\".\".concat(NAMESPACE, \"-list\"));\n        viewer.id = \"\".concat(NAMESPACE).concat(this.id);\n        title.id = \"\".concat(NAMESPACE, \"Title\").concat(this.id);\n        addClass(title, !options.title ? CLASS_HIDE : getResponsiveClass(Array.isArray(options.title) ? options.title[0] : options.title));\n        addClass(navbar, !options.navbar ? CLASS_HIDE : getResponsiveClass(options.navbar));\n        toggleClass(button, CLASS_HIDE, !options.button);\n\n        if (options.keyboard) {\n          button.setAttribute('tabindex', 0);\n        }\n\n        if (options.backdrop) {\n          addClass(viewer, \"\".concat(NAMESPACE, \"-backdrop\"));\n\n          if (!options.inline && options.backdrop !== 'static') {\n            setData(canvas, DATA_ACTION, 'hide');\n          }\n        }\n\n        if (isString(options.className) && options.className) {\n          // In case there are multiple class names\n          options.className.split(REGEXP_SPACES).forEach(function (className) {\n            addClass(viewer, className);\n          });\n        }\n\n        if (options.toolbar) {\n          var list = document.createElement('ul');\n          var custom = isPlainObject(options.toolbar);\n          var zoomButtons = BUTTONS.slice(0, 3);\n          var rotateButtons = BUTTONS.slice(7, 9);\n          var scaleButtons = BUTTONS.slice(9);\n\n          if (!custom) {\n            addClass(toolbar, getResponsiveClass(options.toolbar));\n          }\n\n          forEach(custom ? options.toolbar : BUTTONS, function (value, index) {\n            var deep = custom && isPlainObject(value);\n            var name = custom ? hyphenate(index) : value;\n            var show = deep && !isUndefined(value.show) ? value.show : value;\n\n            if (!show || !options.zoomable && zoomButtons.indexOf(name) !== -1 || !options.rotatable && rotateButtons.indexOf(name) !== -1 || !options.scalable && scaleButtons.indexOf(name) !== -1) {\n              return;\n            }\n\n            var size = deep && !isUndefined(value.size) ? value.size : value;\n            var click = deep && !isUndefined(value.click) ? value.click : value;\n            var item = document.createElement('li');\n\n            if (options.keyboard) {\n              item.setAttribute('tabindex', 0);\n            }\n\n            item.setAttribute('role', 'button');\n            addClass(item, \"\".concat(NAMESPACE, \"-\").concat(name));\n\n            if (!isFunction(click)) {\n              setData(item, DATA_ACTION, name);\n            }\n\n            if (isNumber(show)) {\n              addClass(item, getResponsiveClass(show));\n            }\n\n            if (['small', 'large'].indexOf(size) !== -1) {\n              addClass(item, \"\".concat(NAMESPACE, \"-\").concat(size));\n            } else if (name === 'play') {\n              addClass(item, \"\".concat(NAMESPACE, \"-large\"));\n            }\n\n            if (isFunction(click)) {\n              addListener(item, EVENT_CLICK, click);\n            }\n\n            list.appendChild(item);\n          });\n          toolbar.appendChild(list);\n        } else {\n          addClass(toolbar, CLASS_HIDE);\n        }\n\n        if (!options.rotatable) {\n          var rotates = toolbar.querySelectorAll('li[class*=\"rotate\"]');\n          addClass(rotates, CLASS_INVISIBLE);\n          forEach(rotates, function (rotate) {\n            toolbar.appendChild(rotate);\n          });\n        }\n\n        if (options.inline) {\n          addClass(button, CLASS_FULLSCREEN);\n          setStyle(viewer, {\n            zIndex: options.zIndexInline\n          });\n\n          if (window.getComputedStyle(parent).position === 'static') {\n            setStyle(parent, {\n              position: 'relative'\n            });\n          }\n\n          parent.insertBefore(viewer, element.nextSibling);\n        } else {\n          addClass(button, CLASS_CLOSE);\n          addClass(viewer, CLASS_FIXED);\n          addClass(viewer, CLASS_FADE);\n          addClass(viewer, CLASS_HIDE);\n          setStyle(viewer, {\n            zIndex: options.zIndex\n          });\n          var container = options.container;\n\n          if (isString(container)) {\n            container = element.ownerDocument.querySelector(container);\n          }\n\n          if (!container) {\n            container = this.body;\n          }\n\n          container.appendChild(viewer);\n        }\n\n        if (options.inline) {\n          this.render();\n          this.bind();\n          this.isShown = true;\n        }\n\n        this.ready = true;\n\n        if (isFunction(options.ready)) {\n          addListener(element, EVENT_READY, options.ready, {\n            once: true\n          });\n        }\n\n        if (dispatchEvent(element, EVENT_READY) === false) {\n          this.ready = false;\n          return;\n        }\n\n        if (this.ready && options.inline) {\n          this.view(this.index);\n        }\n      }\n      /**\n       * Get the no conflict viewer class.\n       * @returns {Viewer} The viewer class.\n       */\n\n    }], [{\n      key: \"noConflict\",\n      value: function noConflict() {\n        window.Viewer = AnotherViewer;\n        return Viewer;\n      }\n      /**\n       * Change the default options.\n       * @param {Object} options - The new default options.\n       */\n\n    }, {\n      key: \"setDefaults\",\n      value: function setDefaults(options) {\n        assign(DEFAULTS, isPlainObject(options) && options);\n      }\n    }]);\n\n    return Viewer;\n  }();\n\n  assign(Viewer.prototype, render, events, handlers, methods, others);\n\n  return Viewer;\n\n})));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvdmlld2VyanMvZGlzdC92aWV3ZXIuanMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvdmlld2VyanMvZGlzdC92aWV3ZXIuanM/YzgyYyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiFcbiAqIFZpZXdlci5qcyB2MS45LjBcbiAqIGh0dHBzOi8vZmVuZ3l1YW5jaGVuLmdpdGh1Yi5pby92aWV3ZXJqc1xuICpcbiAqIENvcHlyaWdodCAyMDE1LXByZXNlbnQgQ2hlbiBGZW5neXVhblxuICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlXG4gKlxuICogRGF0ZTogMjAyMC0xMi0wNlQxMToyNToxNS42ODhaXG4gKi9cblxuKGZ1bmN0aW9uIChnbG9iYWwsIGZhY3RvcnkpIHtcbiAgdHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnID8gbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCkgOlxuICB0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQgPyBkZWZpbmUoZmFjdG9yeSkgOlxuICAoZ2xvYmFsID0gdHlwZW9mIGdsb2JhbFRoaXMgIT09ICd1bmRlZmluZWQnID8gZ2xvYmFsVGhpcyA6IGdsb2JhbCB8fCBzZWxmLCBnbG9iYWwuVmlld2VyID0gZmFjdG9yeSgpKTtcbn0odGhpcywgKGZ1bmN0aW9uICgpIHsgJ3VzZSBzdHJpY3QnO1xuXG4gIGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7XG4gICAgXCJAYmFiZWwvaGVscGVycyAtIHR5cGVvZlwiO1xuXG4gICAgaWYgKHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSBcInN5bWJvbFwiKSB7XG4gICAgICBfdHlwZW9mID0gZnVuY3Rpb24gKG9iaikge1xuICAgICAgICByZXR1cm4gdHlwZW9mIG9iajtcbiAgICAgIH07XG4gICAgfSBlbHNlIHtcbiAgICAgIF90eXBlb2YgPSBmdW5jdGlvbiAob2JqKSB7XG4gICAgICAgIHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/IFwic3ltYm9sXCIgOiB0eXBlb2Ygb2JqO1xuICAgICAgfTtcbiAgICB9XG5cbiAgICByZXR1cm4gX3R5cGVvZihvYmopO1xuICB9XG5cbiAgZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3Rvcikge1xuICAgIGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldO1xuICAgICAgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlO1xuICAgICAgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlO1xuICAgICAgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBfY3JlYXRlQ2xhc3MoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7XG4gICAgaWYgKHByb3RvUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7XG4gICAgaWYgKHN0YXRpY1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpO1xuICAgIHJldHVybiBDb25zdHJ1Y3RvcjtcbiAgfVxuXG4gIGZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHtcbiAgICBpZiAoa2V5IGluIG9iaikge1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7XG4gICAgICAgIHZhbHVlOiB2YWx1ZSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICB3cml0YWJsZTogdHJ1ZVxuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIG9ialtrZXldID0gdmFsdWU7XG4gICAgfVxuXG4gICAgcmV0dXJuIG9iajtcbiAgfVxuXG4gIGZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkge1xuICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTtcblxuICAgIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7XG4gICAgICB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KTtcbiAgICAgIGlmIChlbnVtZXJhYmxlT25seSkgc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHtcbiAgICAgICAgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7XG4gICAgICB9KTtcbiAgICAgIGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTtcbiAgICB9XG5cbiAgICByZXR1cm4ga2V5cztcbiAgfVxuXG4gIGZ1bmN0aW9uIF9vYmplY3RTcHJlYWQyKHRhcmdldCkge1xuICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTtcblxuICAgICAgaWYgKGkgJSAyKSB7XG4gICAgICAgIG93bktleXMoT2JqZWN0KHNvdXJjZSksIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgICAgICAgIF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pO1xuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMpIHtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG93bktleXMoT2JqZWN0KHNvdXJjZSkpLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gdGFyZ2V0O1xuICB9XG5cbiAgdmFyIERFRkFVTFRTID0ge1xuICAgIC8qKlxuICAgICAqIEVuYWJsZSBhIG1vZGFsIGJhY2tkcm9wLCBzcGVjaWZ5IGBzdGF0aWNgIGZvciBhIGJhY2tkcm9wXG4gICAgICogd2hpY2ggZG9lc24ndCBjbG9zZSB0aGUgbW9kYWwgb24gY2xpY2suXG4gICAgICogQHR5cGUge2Jvb2xlYW59XG4gICAgICovXG4gICAgYmFja2Ryb3A6IHRydWUsXG5cbiAgICAvKipcbiAgICAgKiBTaG93IHRoZSBidXR0b24gb24gdGhlIHRvcC1yaWdodCBvZiB0aGUgdmlld2VyLlxuICAgICAqIEB0eXBlIHtib29sZWFufVxuICAgICAqL1xuICAgIGJ1dHRvbjogdHJ1ZSxcblxuICAgIC8qKlxuICAgICAqIFNob3cgdGhlIG5hdmJhci5cbiAgICAgKiBAdHlwZSB7Ym9vbGVhbiB8IG51bWJlcn1cbiAgICAgKi9cbiAgICBuYXZiYXI6IHRydWUsXG5cbiAgICAvKipcbiAgICAgKiBTcGVjaWZ5IHRoZSB2aXNpYmlsaXR5IGFuZCB0aGUgY29udGVudCBvZiB0aGUgdGl0bGUuXG4gICAgICogQHR5cGUge2Jvb2xlYW4gfCBudW1iZXIgfCBGdW5jdGlvbiB8IEFycmF5fVxuICAgICAqL1xuICAgIHRpdGxlOiB0cnVlLFxuXG4gICAgLyoqXG4gICAgICogU2hvdyB0aGUgdG9vbGJhci5cbiAgICAgKiBAdHlwZSB7Ym9vbGVhbiB8IG51bWJlciB8IE9iamVjdH1cbiAgICAgKi9cbiAgICB0b29sYmFyOiB0cnVlLFxuXG4gICAgLyoqXG4gICAgICogQ3VzdG9tIGNsYXNzIG5hbWUocykgdG8gYWRkIHRvIHRoZSB2aWV3ZXIncyByb290IGVsZW1lbnQuXG4gICAgICogQHR5cGUge3N0cmluZ31cbiAgICAgKi9cbiAgICBjbGFzc05hbWU6ICcnLFxuXG4gICAgLyoqXG4gICAgICogRGVmaW5lIHdoZXJlIHRvIHB1dCB0aGUgdmlld2VyIGluIG1vZGFsIG1vZGUuXG4gICAgICogQHR5cGUge3N0cmluZyB8IEVsZW1lbnR9XG4gICAgICovXG4gICAgY29udGFpbmVyOiAnYm9keScsXG5cbiAgICAvKipcbiAgICAgKiBGaWx0ZXIgdGhlIGltYWdlcyBmb3Igdmlld2luZy4gUmV0dXJuIHRydWUgaWYgdGhlIGltYWdlIGlzIHZpZXdhYmxlLlxuICAgICAqIEB0eXBlIHtGdW5jdGlvbn1cbiAgICAgKi9cbiAgICBmaWx0ZXI6IG51bGwsXG5cbiAgICAvKipcbiAgICAgKiBFbmFibGUgdG8gcmVxdWVzdCBmdWxsc2NyZWVuIHdoZW4gcGxheS5cbiAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBmdWxsc2NyZWVuOiB0cnVlLFxuXG4gICAgLyoqXG4gICAgICogRGVmaW5lIHRoZSBleHRyYSBhdHRyaWJ1dGVzIHRvIGluaGVyaXQgZnJvbSB0aGUgb3JpZ2luYWwgaW1hZ2UuXG4gICAgICogQHR5cGUge0FycmF5fVxuICAgICAqL1xuICAgIGluaGVyaXRlZEF0dHJpYnV0ZXM6IFsnY3Jvc3NPcmlnaW4nLCAnZGVjb2RpbmcnLCAnaXNNYXAnLCAnbG9hZGluZycsICdyZWZlcnJlclBvbGljeScsICdzaXplcycsICdzcmNzZXQnLCAndXNlTWFwJ10sXG5cbiAgICAvKipcbiAgICAgKiBEZWZpbmUgdGhlIGluaXRpYWwgaW5kZXggb2YgaW1hZ2UgZm9yIHZpZXdpbmcuXG4gICAgICogQHR5cGUge251bWJlcn1cbiAgICAgKi9cbiAgICBpbml0aWFsVmlld0luZGV4OiAwLFxuXG4gICAgLyoqXG4gICAgICogRW5hYmxlIGlubGluZSBtb2RlLlxuICAgICAqIEB0eXBlIHtib29sZWFufVxuICAgICAqL1xuICAgIGlubGluZTogZmFsc2UsXG5cbiAgICAvKipcbiAgICAgKiBUaGUgYW1vdW50IG9mIHRpbWUgdG8gZGVsYXkgYmV0d2VlbiBhdXRvbWF0aWNhbGx5IGN5Y2xpbmcgYW4gaW1hZ2Ugd2hlbiBwbGF5aW5nLlxuICAgICAqIEB0eXBlIHtudW1iZXJ9XG4gICAgICovXG4gICAgaW50ZXJ2YWw6IDUwMDAsXG5cbiAgICAvKipcbiAgICAgKiBFbmFibGUga2V5Ym9hcmQgc3VwcG9ydC5cbiAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBrZXlib2FyZDogdHJ1ZSxcblxuICAgIC8qKlxuICAgICAqIEZvY3VzIHRoZSB2aWV3ZXIgd2hlbiBpbml0aWFsaXplZC5cbiAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBmb2N1czogdHJ1ZSxcblxuICAgIC8qKlxuICAgICAqIEluZGljYXRlIGlmIHNob3cgYSBsb2FkaW5nIHNwaW5uZXIgd2hlbiBsb2FkIGltYWdlIG9yIG5vdC5cbiAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBsb2FkaW5nOiB0cnVlLFxuXG4gICAgLyoqXG4gICAgICogSW5kaWNhdGUgaWYgZW5hYmxlIGxvb3Agdmlld2luZyBvciBub3QuXG4gICAgICogQHR5cGUge2Jvb2xlYW59XG4gICAgICovXG4gICAgbG9vcDogdHJ1ZSxcblxuICAgIC8qKlxuICAgICAqIE1pbiB3aWR0aCBvZiB0aGUgdmlld2VyIGluIGlubGluZSBtb2RlLlxuICAgICAqIEB0eXBlIHtudW1iZXJ9XG4gICAgICovXG4gICAgbWluV2lkdGg6IDIwMCxcblxuICAgIC8qKlxuICAgICAqIE1pbiBoZWlnaHQgb2YgdGhlIHZpZXdlciBpbiBpbmxpbmUgbW9kZS5cbiAgICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgICAqL1xuICAgIG1pbkhlaWdodDogMTAwLFxuXG4gICAgLyoqXG4gICAgICogRW5hYmxlIHRvIG1vdmUgdGhlIGltYWdlLlxuICAgICAqIEB0eXBlIHtib29sZWFufVxuICAgICAqL1xuICAgIG1vdmFibGU6IHRydWUsXG5cbiAgICAvKipcbiAgICAgKiBFbmFibGUgdG8gcm90YXRlIHRoZSBpbWFnZS5cbiAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICByb3RhdGFibGU6IHRydWUsXG5cbiAgICAvKipcbiAgICAgKiBFbmFibGUgdG8gc2NhbGUgdGhlIGltYWdlLlxuICAgICAqIEB0eXBlIHtib29sZWFufVxuICAgICAqL1xuICAgIHNjYWxhYmxlOiB0cnVlLFxuXG4gICAgLyoqXG4gICAgICogRW5hYmxlIHRvIHpvb20gdGhlIGltYWdlLlxuICAgICAqIEB0eXBlIHtib29sZWFufVxuICAgICAqL1xuICAgIHpvb21hYmxlOiB0cnVlLFxuXG4gICAgLyoqXG4gICAgICogRW5hYmxlIHRvIHpvb20gdGhlIGN1cnJlbnQgaW1hZ2UgYnkgZHJhZ2dpbmcgb24gdGhlIHRvdWNoIHNjcmVlbi5cbiAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICB6b29tT25Ub3VjaDogdHJ1ZSxcblxuICAgIC8qKlxuICAgICAqIEVuYWJsZSB0byB6b29tIHRoZSBpbWFnZSBieSB3aGVlbGluZyBtb3VzZS5cbiAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICB6b29tT25XaGVlbDogdHJ1ZSxcblxuICAgIC8qKlxuICAgICAqIEVuYWJsZSB0byBzbGlkZSB0byB0aGUgbmV4dCBvciBwcmV2aW91cyBpbWFnZSBieSBzd2lwaW5nIG9uIHRoZSB0b3VjaCBzY3JlZW4uXG4gICAgICogQHR5cGUge2Jvb2xlYW59XG4gICAgICovXG4gICAgc2xpZGVPblRvdWNoOiB0cnVlLFxuXG4gICAgLyoqXG4gICAgICogSW5kaWNhdGUgaWYgdG9nZ2xlIHRoZSBpbWFnZSBzaXplIGJldHdlZW4gaXRzIG5hdHVyYWwgc2l6ZVxuICAgICAqIGFuZCBpbml0aWFsIHNpemUgd2hlbiBkb3VibGUgY2xpY2sgb24gdGhlIGltYWdlIG9yIG5vdC5cbiAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICB0b2dnbGVPbkRibGNsaWNrOiB0cnVlLFxuXG4gICAgLyoqXG4gICAgICogU2hvdyB0aGUgdG9vbHRpcCB3aXRoIGltYWdlIHJhdGlvIChwZXJjZW50YWdlKSB3aGVuIHpvb20gaW4gb3Igem9vbSBvdXQuXG4gICAgICogQHR5cGUge2Jvb2xlYW59XG4gICAgICovXG4gICAgdG9vbHRpcDogdHJ1ZSxcblxuICAgIC8qKlxuICAgICAqIEVuYWJsZSBDU1MzIFRyYW5zaXRpb24gZm9yIHNvbWUgc3BlY2lhbCBlbGVtZW50cy5cbiAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICB0cmFuc2l0aW9uOiB0cnVlLFxuXG4gICAgLyoqXG4gICAgICogRGVmaW5lIHRoZSBDU1MgYHotaW5kZXhgIHZhbHVlIG9mIHZpZXdlciBpbiBtb2RhbCBtb2RlLlxuICAgICAqIEB0eXBlIHtudW1iZXJ9XG4gICAgICovXG4gICAgekluZGV4OiAyMDE1LFxuXG4gICAgLyoqXG4gICAgICogRGVmaW5lIHRoZSBDU1MgYHotaW5kZXhgIHZhbHVlIG9mIHZpZXdlciBpbiBpbmxpbmUgbW9kZS5cbiAgICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgICAqL1xuICAgIHpJbmRleElubGluZTogMCxcblxuICAgIC8qKlxuICAgICAqIERlZmluZSB0aGUgcmF0aW8gd2hlbiB6b29tIHRoZSBpbWFnZSBieSB3aGVlbGluZyBtb3VzZS5cbiAgICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgICAqL1xuICAgIHpvb21SYXRpbzogMC4xLFxuXG4gICAgLyoqXG4gICAgICogRGVmaW5lIHRoZSBtaW4gcmF0aW8gb2YgdGhlIGltYWdlIHdoZW4gem9vbSBvdXQuXG4gICAgICogQHR5cGUge251bWJlcn1cbiAgICAgKi9cbiAgICBtaW5ab29tUmF0aW86IDAuMDEsXG5cbiAgICAvKipcbiAgICAgKiBEZWZpbmUgdGhlIG1heCByYXRpbyBvZiB0aGUgaW1hZ2Ugd2hlbiB6b29tIGluLlxuICAgICAqIEB0eXBlIHtudW1iZXJ9XG4gICAgICovXG4gICAgbWF4Wm9vbVJhdGlvOiAxMDAsXG5cbiAgICAvKipcbiAgICAgKiBEZWZpbmUgd2hlcmUgdG8gZ2V0IHRoZSBvcmlnaW5hbCBpbWFnZSBVUkwgZm9yIHZpZXdpbmcuXG4gICAgICogQHR5cGUge3N0cmluZyB8IEZ1bmN0aW9ufVxuICAgICAqL1xuICAgIHVybDogJ3NyYycsXG5cbiAgICAvKipcbiAgICAgKiBFdmVudCBzaG9ydGN1dHMuXG4gICAgICogQHR5cGUge0Z1bmN0aW9ufVxuICAgICAqL1xuICAgIHJlYWR5OiBudWxsLFxuICAgIHNob3c6IG51bGwsXG4gICAgc2hvd246IG51bGwsXG4gICAgaGlkZTogbnVsbCxcbiAgICBoaWRkZW46IG51bGwsXG4gICAgdmlldzogbnVsbCxcbiAgICB2aWV3ZWQ6IG51bGwsXG4gICAgbW92ZTogbnVsbCxcbiAgICBtb3ZlZDogbnVsbCxcbiAgICByb3RhdGU6IG51bGwsXG4gICAgcm90YXRlZDogbnVsbCxcbiAgICBzY2FsZTogbnVsbCxcbiAgICBzY2FsZWQ6IG51bGwsXG4gICAgem9vbTogbnVsbCxcbiAgICB6b29tZWQ6IG51bGwsXG4gICAgcGxheTogbnVsbCxcbiAgICBzdG9wOiBudWxsXG4gIH07XG5cbiAgdmFyIFRFTVBMQVRFID0gJzxkaXYgY2xhc3M9XCJ2aWV3ZXItY29udGFpbmVyXCIgdGFiaW5kZXg9XCItMVwiIHRvdWNoLWFjdGlvbj1cIm5vbmVcIj4nICsgJzxkaXYgY2xhc3M9XCJ2aWV3ZXItY2FudmFzXCI+PC9kaXY+JyArICc8ZGl2IGNsYXNzPVwidmlld2VyLWZvb3RlclwiPicgKyAnPGRpdiBjbGFzcz1cInZpZXdlci10aXRsZVwiPjwvZGl2PicgKyAnPGRpdiBjbGFzcz1cInZpZXdlci10b29sYmFyXCI+PC9kaXY+JyArICc8ZGl2IGNsYXNzPVwidmlld2VyLW5hdmJhclwiPicgKyAnPHVsIGNsYXNzPVwidmlld2VyLWxpc3RcIiByb2xlPVwibmF2aWdhdGlvblwiPjwvdWw+JyArICc8L2Rpdj4nICsgJzwvZGl2PicgKyAnPGRpdiBjbGFzcz1cInZpZXdlci10b29sdGlwXCIgcm9sZT1cImFsZXJ0XCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+PC9kaXY+JyArICc8ZGl2IGNsYXNzPVwidmlld2VyLWJ1dHRvblwiIGRhdGEtdmlld2VyLWFjdGlvbj1cIm1peFwiIHJvbGU9XCJidXR0b25cIj48L2Rpdj4nICsgJzxkaXYgY2xhc3M9XCJ2aWV3ZXItcGxheWVyXCI+PC9kaXY+JyArICc8L2Rpdj4nO1xuXG4gIHZhciBJU19CUk9XU0VSID0gdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIHdpbmRvdy5kb2N1bWVudCAhPT0gJ3VuZGVmaW5lZCc7XG4gIHZhciBXSU5ET1cgPSBJU19CUk9XU0VSID8gd2luZG93IDoge307XG4gIHZhciBJU19UT1VDSF9ERVZJQ0UgPSBJU19CUk9XU0VSICYmIFdJTkRPVy5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQgPyAnb250b3VjaHN0YXJ0JyBpbiBXSU5ET1cuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50IDogZmFsc2U7XG4gIHZhciBIQVNfUE9JTlRFUl9FVkVOVCA9IElTX0JST1dTRVIgPyAnUG9pbnRlckV2ZW50JyBpbiBXSU5ET1cgOiBmYWxzZTtcbiAgdmFyIE5BTUVTUEFDRSA9ICd2aWV3ZXInOyAvLyBBY3Rpb25zXG5cbiAgdmFyIEFDVElPTl9NT1ZFID0gJ21vdmUnO1xuICB2YXIgQUNUSU9OX1NXSVRDSCA9ICdzd2l0Y2gnO1xuICB2YXIgQUNUSU9OX1pPT00gPSAnem9vbSc7IC8vIENsYXNzZXNcblxuICB2YXIgQ0xBU1NfQUNUSVZFID0gXCJcIi5jb25jYXQoTkFNRVNQQUNFLCBcIi1hY3RpdmVcIik7XG4gIHZhciBDTEFTU19DTE9TRSA9IFwiXCIuY29uY2F0KE5BTUVTUEFDRSwgXCItY2xvc2VcIik7XG4gIHZhciBDTEFTU19GQURFID0gXCJcIi5jb25jYXQoTkFNRVNQQUNFLCBcIi1mYWRlXCIpO1xuICB2YXIgQ0xBU1NfRklYRUQgPSBcIlwiLmNvbmNhdChOQU1FU1BBQ0UsIFwiLWZpeGVkXCIpO1xuICB2YXIgQ0xBU1NfRlVMTFNDUkVFTiA9IFwiXCIuY29uY2F0KE5BTUVTUEFDRSwgXCItZnVsbHNjcmVlblwiKTtcbiAgdmFyIENMQVNTX0ZVTExTQ1JFRU5fRVhJVCA9IFwiXCIuY29uY2F0KE5BTUVTUEFDRSwgXCItZnVsbHNjcmVlbi1leGl0XCIpO1xuICB2YXIgQ0xBU1NfSElERSA9IFwiXCIuY29uY2F0KE5BTUVTUEFDRSwgXCItaGlkZVwiKTtcbiAgdmFyIENMQVNTX0hJREVfTURfRE9XTiA9IFwiXCIuY29uY2F0KE5BTUVTUEFDRSwgXCItaGlkZS1tZC1kb3duXCIpO1xuICB2YXIgQ0xBU1NfSElERV9TTV9ET1dOID0gXCJcIi5jb25jYXQoTkFNRVNQQUNFLCBcIi1oaWRlLXNtLWRvd25cIik7XG4gIHZhciBDTEFTU19ISURFX1hTX0RPV04gPSBcIlwiLmNvbmNhdChOQU1FU1BBQ0UsIFwiLWhpZGUteHMtZG93blwiKTtcbiAgdmFyIENMQVNTX0lOID0gXCJcIi5jb25jYXQoTkFNRVNQQUNFLCBcIi1pblwiKTtcbiAgdmFyIENMQVNTX0lOVklTSUJMRSA9IFwiXCIuY29uY2F0KE5BTUVTUEFDRSwgXCItaW52aXNpYmxlXCIpO1xuICB2YXIgQ0xBU1NfTE9BRElORyA9IFwiXCIuY29uY2F0KE5BTUVTUEFDRSwgXCItbG9hZGluZ1wiKTtcbiAgdmFyIENMQVNTX01PVkUgPSBcIlwiLmNvbmNhdChOQU1FU1BBQ0UsIFwiLW1vdmVcIik7XG4gIHZhciBDTEFTU19PUEVOID0gXCJcIi5jb25jYXQoTkFNRVNQQUNFLCBcIi1vcGVuXCIpO1xuICB2YXIgQ0xBU1NfU0hPVyA9IFwiXCIuY29uY2F0KE5BTUVTUEFDRSwgXCItc2hvd1wiKTtcbiAgdmFyIENMQVNTX1RSQU5TSVRJT04gPSBcIlwiLmNvbmNhdChOQU1FU1BBQ0UsIFwiLXRyYW5zaXRpb25cIik7IC8vIE5hdGl2ZSBldmVudHNcblxuICB2YXIgRVZFTlRfQ0xJQ0sgPSAnY2xpY2snO1xuICB2YXIgRVZFTlRfREJMQ0xJQ0sgPSAnZGJsY2xpY2snO1xuICB2YXIgRVZFTlRfRFJBR19TVEFSVCA9ICdkcmFnc3RhcnQnO1xuICB2YXIgRVZFTlRfRk9DVVNJTiA9ICdmb2N1c2luJztcbiAgdmFyIEVWRU5UX0tFWV9ET1dOID0gJ2tleWRvd24nO1xuICB2YXIgRVZFTlRfTE9BRCA9ICdsb2FkJztcbiAgdmFyIEVWRU5UX1RPVUNIX0VORCA9IElTX1RPVUNIX0RFVklDRSA/ICd0b3VjaGVuZCB0b3VjaGNhbmNlbCcgOiAnbW91c2V1cCc7XG4gIHZhciBFVkVOVF9UT1VDSF9NT1ZFID0gSVNfVE9VQ0hfREVWSUNFID8gJ3RvdWNobW92ZScgOiAnbW91c2Vtb3ZlJztcbiAgdmFyIEVWRU5UX1RPVUNIX1NUQVJUID0gSVNfVE9VQ0hfREVWSUNFID8gJ3RvdWNoc3RhcnQnIDogJ21vdXNlZG93bic7XG4gIHZhciBFVkVOVF9QT0lOVEVSX0RPV04gPSBIQVNfUE9JTlRFUl9FVkVOVCA/ICdwb2ludGVyZG93bicgOiBFVkVOVF9UT1VDSF9TVEFSVDtcbiAgdmFyIEVWRU5UX1BPSU5URVJfTU9WRSA9IEhBU19QT0lOVEVSX0VWRU5UID8gJ3BvaW50ZXJtb3ZlJyA6IEVWRU5UX1RPVUNIX01PVkU7XG4gIHZhciBFVkVOVF9QT0lOVEVSX1VQID0gSEFTX1BPSU5URVJfRVZFTlQgPyAncG9pbnRlcnVwIHBvaW50ZXJjYW5jZWwnIDogRVZFTlRfVE9VQ0hfRU5EO1xuICB2YXIgRVZFTlRfUkVTSVpFID0gJ3Jlc2l6ZSc7XG4gIHZhciBFVkVOVF9UUkFOU0lUSU9OX0VORCA9ICd0cmFuc2l0aW9uZW5kJztcbiAgdmFyIEVWRU5UX1dIRUVMID0gJ3doZWVsJzsgLy8gQ3VzdG9tIGV2ZW50c1xuXG4gIHZhciBFVkVOVF9SRUFEWSA9ICdyZWFkeSc7XG4gIHZhciBFVkVOVF9TSE9XID0gJ3Nob3cnO1xuICB2YXIgRVZFTlRfU0hPV04gPSAnc2hvd24nO1xuICB2YXIgRVZFTlRfSElERSA9ICdoaWRlJztcbiAgdmFyIEVWRU5UX0hJRERFTiA9ICdoaWRkZW4nO1xuICB2YXIgRVZFTlRfVklFVyA9ICd2aWV3JztcbiAgdmFyIEVWRU5UX1ZJRVdFRCA9ICd2aWV3ZWQnO1xuICB2YXIgRVZFTlRfTU9WRSA9ICdtb3ZlJztcbiAgdmFyIEVWRU5UX01PVkVEID0gJ21vdmVkJztcbiAgdmFyIEVWRU5UX1JPVEFURSA9ICdyb3RhdGUnO1xuICB2YXIgRVZFTlRfUk9UQVRFRCA9ICdyb3RhdGVkJztcbiAgdmFyIEVWRU5UX1NDQUxFID0gJ3NjYWxlJztcbiAgdmFyIEVWRU5UX1NDQUxFRCA9ICdzY2FsZWQnO1xuICB2YXIgRVZFTlRfWk9PTSA9ICd6b29tJztcbiAgdmFyIEVWRU5UX1pPT01FRCA9ICd6b29tZWQnO1xuICB2YXIgRVZFTlRfUExBWSA9ICdwbGF5JztcbiAgdmFyIEVWRU5UX1NUT1AgPSAnc3RvcCc7IC8vIERhdGEga2V5c1xuXG4gIHZhciBEQVRBX0FDVElPTiA9IFwiXCIuY29uY2F0KE5BTUVTUEFDRSwgXCJBY3Rpb25cIik7IC8vIFJlZ0V4cHNcblxuICB2YXIgUkVHRVhQX1NQQUNFUyA9IC9cXHNcXHMqLzsgLy8gTWlzY1xuXG4gIHZhciBCVVRUT05TID0gWyd6b29tLWluJywgJ3pvb20tb3V0JywgJ29uZS10by1vbmUnLCAncmVzZXQnLCAncHJldicsICdwbGF5JywgJ25leHQnLCAncm90YXRlLWxlZnQnLCAncm90YXRlLXJpZ2h0JywgJ2ZsaXAtaG9yaXpvbnRhbCcsICdmbGlwLXZlcnRpY2FsJ107XG5cbiAgLyoqXG4gICAqIENoZWNrIGlmIHRoZSBnaXZlbiB2YWx1ZSBpcyBhIHN0cmluZy5cbiAgICogQHBhcmFtIHsqfSB2YWx1ZSAtIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIHRoZSBnaXZlbiB2YWx1ZSBpcyBhIHN0cmluZywgZWxzZSBgZmFsc2VgLlxuICAgKi9cblxuICBmdW5jdGlvbiBpc1N0cmluZyh2YWx1ZSkge1xuICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnO1xuICB9XG4gIC8qKlxuICAgKiBDaGVjayBpZiB0aGUgZ2l2ZW4gdmFsdWUgaXMgbm90IGEgbnVtYmVyLlxuICAgKi9cblxuICB2YXIgaXNOYU4gPSBOdW1iZXIuaXNOYU4gfHwgV0lORE9XLmlzTmFOO1xuICAvKipcbiAgICogQ2hlY2sgaWYgdGhlIGdpdmVuIHZhbHVlIGlzIGEgbnVtYmVyLlxuICAgKiBAcGFyYW0geyp9IHZhbHVlIC0gVGhlIHZhbHVlIHRvIGNoZWNrLlxuICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIGdpdmVuIHZhbHVlIGlzIGEgbnVtYmVyLCBlbHNlIGBmYWxzZWAuXG4gICAqL1xuXG4gIGZ1bmN0aW9uIGlzTnVtYmVyKHZhbHVlKSB7XG4gICAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicgJiYgIWlzTmFOKHZhbHVlKTtcbiAgfVxuICAvKipcbiAgICogQ2hlY2sgaWYgdGhlIGdpdmVuIHZhbHVlIGlzIHVuZGVmaW5lZC5cbiAgICogQHBhcmFtIHsqfSB2YWx1ZSAtIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIHRoZSBnaXZlbiB2YWx1ZSBpcyB1bmRlZmluZWQsIGVsc2UgYGZhbHNlYC5cbiAgICovXG5cbiAgZnVuY3Rpb24gaXNVbmRlZmluZWQodmFsdWUpIHtcbiAgICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSAndW5kZWZpbmVkJztcbiAgfVxuICAvKipcbiAgICogQ2hlY2sgaWYgdGhlIGdpdmVuIHZhbHVlIGlzIGFuIG9iamVjdC5cbiAgICogQHBhcmFtIHsqfSB2YWx1ZSAtIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIHRoZSBnaXZlbiB2YWx1ZSBpcyBhbiBvYmplY3QsIGVsc2UgYGZhbHNlYC5cbiAgICovXG5cbiAgZnVuY3Rpb24gaXNPYmplY3QodmFsdWUpIHtcbiAgICByZXR1cm4gX3R5cGVvZih2YWx1ZSkgPT09ICdvYmplY3QnICYmIHZhbHVlICE9PSBudWxsO1xuICB9XG4gIHZhciBoYXNPd25Qcm9wZXJ0eSA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7XG4gIC8qKlxuICAgKiBDaGVjayBpZiB0aGUgZ2l2ZW4gdmFsdWUgaXMgYSBwbGFpbiBvYmplY3QuXG4gICAqIEBwYXJhbSB7Kn0gdmFsdWUgLSBUaGUgdmFsdWUgdG8gY2hlY2suXG4gICAqIEByZXR1cm5zIHtib29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgZ2l2ZW4gdmFsdWUgaXMgYSBwbGFpbiBvYmplY3QsIGVsc2UgYGZhbHNlYC5cbiAgICovXG5cbiAgZnVuY3Rpb24gaXNQbGFpbk9iamVjdCh2YWx1ZSkge1xuICAgIGlmICghaXNPYmplY3QodmFsdWUpKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIHZhciBfY29uc3RydWN0b3IgPSB2YWx1ZS5jb25zdHJ1Y3RvcjtcbiAgICAgIHZhciBwcm90b3R5cGUgPSBfY29uc3RydWN0b3IucHJvdG90eXBlO1xuICAgICAgcmV0dXJuIF9jb25zdHJ1Y3RvciAmJiBwcm90b3R5cGUgJiYgaGFzT3duUHJvcGVydHkuY2FsbChwcm90b3R5cGUsICdpc1Byb3RvdHlwZU9mJyk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cbiAgLyoqXG4gICAqIENoZWNrIGlmIHRoZSBnaXZlbiB2YWx1ZSBpcyBhIGZ1bmN0aW9uLlxuICAgKiBAcGFyYW0geyp9IHZhbHVlIC0gVGhlIHZhbHVlIHRvIGNoZWNrLlxuICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIGdpdmVuIHZhbHVlIGlzIGEgZnVuY3Rpb24sIGVsc2UgYGZhbHNlYC5cbiAgICovXG5cbiAgZnVuY3Rpb24gaXNGdW5jdGlvbih2YWx1ZSkge1xuICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT09ICdmdW5jdGlvbic7XG4gIH1cbiAgLyoqXG4gICAqIEl0ZXJhdGUgdGhlIGdpdmVuIGRhdGEuXG4gICAqIEBwYXJhbSB7Kn0gZGF0YSAtIFRoZSBkYXRhIHRvIGl0ZXJhdGUuXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIC0gVGhlIHByb2Nlc3MgZnVuY3Rpb24gZm9yIGVhY2ggZWxlbWVudC5cbiAgICogQHJldHVybnMgeyp9IFRoZSBvcmlnaW5hbCBkYXRhLlxuICAgKi9cblxuICBmdW5jdGlvbiBmb3JFYWNoKGRhdGEsIGNhbGxiYWNrKSB7XG4gICAgaWYgKGRhdGEgJiYgaXNGdW5jdGlvbihjYWxsYmFjaykpIHtcbiAgICAgIGlmIChBcnJheS5pc0FycmF5KGRhdGEpIHx8IGlzTnVtYmVyKGRhdGEubGVuZ3RoKVxuICAgICAgLyogYXJyYXktbGlrZSAqL1xuICAgICAgKSB7XG4gICAgICAgICAgdmFyIGxlbmd0aCA9IGRhdGEubGVuZ3RoO1xuICAgICAgICAgIHZhciBpO1xuXG4gICAgICAgICAgZm9yIChpID0gMDsgaSA8IGxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgICAgICBpZiAoY2FsbGJhY2suY2FsbChkYXRhLCBkYXRhW2ldLCBpLCBkYXRhKSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKGlzT2JqZWN0KGRhdGEpKSB7XG4gICAgICAgIE9iamVjdC5rZXlzKGRhdGEpLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgICAgICAgIGNhbGxiYWNrLmNhbGwoZGF0YSwgZGF0YVtrZXldLCBrZXksIGRhdGEpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gZGF0YTtcbiAgfVxuICAvKipcbiAgICogRXh0ZW5kIHRoZSBnaXZlbiBvYmplY3QuXG4gICAqIEBwYXJhbSB7Kn0gb2JqIC0gVGhlIG9iamVjdCB0byBiZSBleHRlbmRlZC5cbiAgICogQHBhcmFtIHsqfSBhcmdzIC0gVGhlIHJlc3Qgb2JqZWN0cyB3aGljaCB3aWxsIGJlIG1lcmdlZCB0byB0aGUgZmlyc3Qgb2JqZWN0LlxuICAgKiBAcmV0dXJucyB7T2JqZWN0fSBUaGUgZXh0ZW5kZWQgb2JqZWN0LlxuICAgKi9cblxuICB2YXIgYXNzaWduID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiBhc3NpZ24ob2JqKSB7XG4gICAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbiA+IDEgPyBfbGVuIC0gMSA6IDApLCBfa2V5ID0gMTsgX2tleSA8IF9sZW47IF9rZXkrKykge1xuICAgICAgYXJnc1tfa2V5IC0gMV0gPSBhcmd1bWVudHNbX2tleV07XG4gICAgfVxuXG4gICAgaWYgKGlzT2JqZWN0KG9iaikgJiYgYXJncy5sZW5ndGggPiAwKSB7XG4gICAgICBhcmdzLmZvckVhY2goZnVuY3Rpb24gKGFyZykge1xuICAgICAgICBpZiAoaXNPYmplY3QoYXJnKSkge1xuICAgICAgICAgIE9iamVjdC5rZXlzKGFyZykuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgICAgICBvYmpba2V5XSA9IGFyZ1trZXldO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gb2JqO1xuICB9O1xuICB2YXIgUkVHRVhQX1NVRkZJWCA9IC9eKD86d2lkdGh8aGVpZ2h0fGxlZnR8dG9wfG1hcmdpbkxlZnR8bWFyZ2luVG9wKSQvO1xuICAvKipcbiAgICogQXBwbHkgc3R5bGVzIHRvIHRoZSBnaXZlbiBlbGVtZW50LlxuICAgKiBAcGFyYW0ge0VsZW1lbnR9IGVsZW1lbnQgLSBUaGUgdGFyZ2V0IGVsZW1lbnQuXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBzdHlsZXMgLSBUaGUgc3R5bGVzIGZvciBhcHBseWluZy5cbiAgICovXG5cbiAgZnVuY3Rpb24gc2V0U3R5bGUoZWxlbWVudCwgc3R5bGVzKSB7XG4gICAgdmFyIHN0eWxlID0gZWxlbWVudC5zdHlsZTtcbiAgICBmb3JFYWNoKHN0eWxlcywgZnVuY3Rpb24gKHZhbHVlLCBwcm9wZXJ0eSkge1xuICAgICAgaWYgKFJFR0VYUF9TVUZGSVgudGVzdChwcm9wZXJ0eSkgJiYgaXNOdW1iZXIodmFsdWUpKSB7XG4gICAgICAgIHZhbHVlICs9ICdweCc7XG4gICAgICB9XG5cbiAgICAgIHN0eWxlW3Byb3BlcnR5XSA9IHZhbHVlO1xuICAgIH0pO1xuICB9XG4gIC8qKlxuICAgKiBFc2NhcGUgYSBzdHJpbmcgZm9yIHVzaW5nIGluIEhUTUwuXG4gICAqIEBwYXJhbSB7U3RyaW5nfSB2YWx1ZSAtIFRoZSBzdHJpbmcgdG8gZXNjYXBlLlxuICAgKiBAcmV0dXJucyB7U3RyaW5nfSBSZXR1cm5zIHRoZSBlc2NhcGVkIHN0cmluZy5cbiAgICovXG5cbiAgZnVuY3Rpb24gZXNjYXBlSFRNTEVudGl0aWVzKHZhbHVlKSB7XG4gICAgcmV0dXJuIGlzU3RyaW5nKHZhbHVlKSA/IHZhbHVlLnJlcGxhY2UoLyYoPyFhbXA7fHF1b3Q7fCMzOTt8bHQ7fGd0OykvZywgJyZhbXA7JykucmVwbGFjZSgvXCIvZywgJyZxdW90OycpLnJlcGxhY2UoLycvZywgJyYjMzk7JykucmVwbGFjZSgvPC9nLCAnJmx0OycpLnJlcGxhY2UoLz4vZywgJyZndDsnKSA6IHZhbHVlO1xuICB9XG4gIC8qKlxuICAgKiBDaGVjayBpZiB0aGUgZ2l2ZW4gZWxlbWVudCBoYXMgYSBzcGVjaWFsIGNsYXNzLlxuICAgKiBAcGFyYW0ge0VsZW1lbnR9IGVsZW1lbnQgLSBUaGUgZWxlbWVudCB0byBjaGVjay5cbiAgICogQHBhcmFtIHtzdHJpbmd9IHZhbHVlIC0gVGhlIGNsYXNzIHRvIHNlYXJjaC5cbiAgICogQHJldHVybnMge2Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIHRoZSBzcGVjaWFsIGNsYXNzIHdhcyBmb3VuZC5cbiAgICovXG5cbiAgZnVuY3Rpb24gaGFzQ2xhc3MoZWxlbWVudCwgdmFsdWUpIHtcbiAgICBpZiAoIWVsZW1lbnQgfHwgIXZhbHVlKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgcmV0dXJuIGVsZW1lbnQuY2xhc3NMaXN0ID8gZWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnModmFsdWUpIDogZWxlbWVudC5jbGFzc05hbWUuaW5kZXhPZih2YWx1ZSkgPiAtMTtcbiAgfVxuICAvKipcbiAgICogQWRkIGNsYXNzZXMgdG8gdGhlIGdpdmVuIGVsZW1lbnQuXG4gICAqIEBwYXJhbSB7RWxlbWVudH0gZWxlbWVudCAtIFRoZSB0YXJnZXQgZWxlbWVudC5cbiAgICogQHBhcmFtIHtzdHJpbmd9IHZhbHVlIC0gVGhlIGNsYXNzZXMgdG8gYmUgYWRkZWQuXG4gICAqL1xuXG4gIGZ1bmN0aW9uIGFkZENsYXNzKGVsZW1lbnQsIHZhbHVlKSB7XG4gICAgaWYgKCFlbGVtZW50IHx8ICF2YWx1ZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChpc051bWJlcihlbGVtZW50Lmxlbmd0aCkpIHtcbiAgICAgIGZvckVhY2goZWxlbWVudCwgZnVuY3Rpb24gKGVsZW0pIHtcbiAgICAgICAgYWRkQ2xhc3MoZWxlbSwgdmFsdWUpO1xuICAgICAgfSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKGVsZW1lbnQuY2xhc3NMaXN0KSB7XG4gICAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQodmFsdWUpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHZhciBjbGFzc05hbWUgPSBlbGVtZW50LmNsYXNzTmFtZS50cmltKCk7XG5cbiAgICBpZiAoIWNsYXNzTmFtZSkge1xuICAgICAgZWxlbWVudC5jbGFzc05hbWUgPSB2YWx1ZTtcbiAgICB9IGVsc2UgaWYgKGNsYXNzTmFtZS5pbmRleE9mKHZhbHVlKSA8IDApIHtcbiAgICAgIGVsZW1lbnQuY2xhc3NOYW1lID0gXCJcIi5jb25jYXQoY2xhc3NOYW1lLCBcIiBcIikuY29uY2F0KHZhbHVlKTtcbiAgICB9XG4gIH1cbiAgLyoqXG4gICAqIFJlbW92ZSBjbGFzc2VzIGZyb20gdGhlIGdpdmVuIGVsZW1lbnQuXG4gICAqIEBwYXJhbSB7RWxlbWVudH0gZWxlbWVudCAtIFRoZSB0YXJnZXQgZWxlbWVudC5cbiAgICogQHBhcmFtIHtzdHJpbmd9IHZhbHVlIC0gVGhlIGNsYXNzZXMgdG8gYmUgcmVtb3ZlZC5cbiAgICovXG5cbiAgZnVuY3Rpb24gcmVtb3ZlQ2xhc3MoZWxlbWVudCwgdmFsdWUpIHtcbiAgICBpZiAoIWVsZW1lbnQgfHwgIXZhbHVlKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKGlzTnVtYmVyKGVsZW1lbnQubGVuZ3RoKSkge1xuICAgICAgZm9yRWFjaChlbGVtZW50LCBmdW5jdGlvbiAoZWxlbSkge1xuICAgICAgICByZW1vdmVDbGFzcyhlbGVtLCB2YWx1ZSk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoZWxlbWVudC5jbGFzc0xpc3QpIHtcbiAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh2YWx1ZSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKGVsZW1lbnQuY2xhc3NOYW1lLmluZGV4T2YodmFsdWUpID49IDApIHtcbiAgICAgIGVsZW1lbnQuY2xhc3NOYW1lID0gZWxlbWVudC5jbGFzc05hbWUucmVwbGFjZSh2YWx1ZSwgJycpO1xuICAgIH1cbiAgfVxuICAvKipcbiAgICogQWRkIG9yIHJlbW92ZSBjbGFzc2VzIGZyb20gdGhlIGdpdmVuIGVsZW1lbnQuXG4gICAqIEBwYXJhbSB7RWxlbWVudH0gZWxlbWVudCAtIFRoZSB0YXJnZXQgZWxlbWVudC5cbiAgICogQHBhcmFtIHtzdHJpbmd9IHZhbHVlIC0gVGhlIGNsYXNzZXMgdG8gYmUgdG9nZ2xlZC5cbiAgICogQHBhcmFtIHtib29sZWFufSBhZGRlZCAtIEFkZCBvbmx5LlxuICAgKi9cblxuICBmdW5jdGlvbiB0b2dnbGVDbGFzcyhlbGVtZW50LCB2YWx1ZSwgYWRkZWQpIHtcbiAgICBpZiAoIXZhbHVlKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKGlzTnVtYmVyKGVsZW1lbnQubGVuZ3RoKSkge1xuICAgICAgZm9yRWFjaChlbGVtZW50LCBmdW5jdGlvbiAoZWxlbSkge1xuICAgICAgICB0b2dnbGVDbGFzcyhlbGVtLCB2YWx1ZSwgYWRkZWQpO1xuICAgICAgfSk7XG4gICAgICByZXR1cm47XG4gICAgfSAvLyBJRTEwLTExIGRvZXNuJ3Qgc3VwcG9ydCB0aGUgc2Vjb25kIHBhcmFtZXRlciBvZiBgY2xhc3NMaXN0LnRvZ2dsZWBcblxuXG4gICAgaWYgKGFkZGVkKSB7XG4gICAgICBhZGRDbGFzcyhlbGVtZW50LCB2YWx1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlbW92ZUNsYXNzKGVsZW1lbnQsIHZhbHVlKTtcbiAgICB9XG4gIH1cbiAgdmFyIFJFR0VYUF9IWVBIRU5BVEUgPSAvKFthLXpcXGRdKShbQS1aXSkvZztcbiAgLyoqXG4gICAqIFRyYW5zZm9ybSB0aGUgZ2l2ZW4gc3RyaW5nIGZyb20gY2FtZWxDYXNlIHRvIGtlYmFiLWNhc2VcbiAgICogQHBhcmFtIHtzdHJpbmd9IHZhbHVlIC0gVGhlIHZhbHVlIHRvIHRyYW5zZm9ybS5cbiAgICogQHJldHVybnMge3N0cmluZ30gVGhlIHRyYW5zZm9ybWVkIHZhbHVlLlxuICAgKi9cblxuICBmdW5jdGlvbiBoeXBoZW5hdGUodmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWUucmVwbGFjZShSRUdFWFBfSFlQSEVOQVRFLCAnJDEtJDInKS50b0xvd2VyQ2FzZSgpO1xuICB9XG4gIC8qKlxuICAgKiBHZXQgZGF0YSBmcm9tIHRoZSBnaXZlbiBlbGVtZW50LlxuICAgKiBAcGFyYW0ge0VsZW1lbnR9IGVsZW1lbnQgLSBUaGUgdGFyZ2V0IGVsZW1lbnQuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIC0gVGhlIGRhdGEga2V5IHRvIGdldC5cbiAgICogQHJldHVybnMge3N0cmluZ30gVGhlIGRhdGEgdmFsdWUuXG4gICAqL1xuXG4gIGZ1bmN0aW9uIGdldERhdGEoZWxlbWVudCwgbmFtZSkge1xuICAgIGlmIChpc09iamVjdChlbGVtZW50W25hbWVdKSkge1xuICAgICAgcmV0dXJuIGVsZW1lbnRbbmFtZV07XG4gICAgfVxuXG4gICAgaWYgKGVsZW1lbnQuZGF0YXNldCkge1xuICAgICAgcmV0dXJuIGVsZW1lbnQuZGF0YXNldFtuYW1lXTtcbiAgICB9XG5cbiAgICByZXR1cm4gZWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJkYXRhLVwiLmNvbmNhdChoeXBoZW5hdGUobmFtZSkpKTtcbiAgfVxuICAvKipcbiAgICogU2V0IGRhdGEgdG8gdGhlIGdpdmVuIGVsZW1lbnQuXG4gICAqIEBwYXJhbSB7RWxlbWVudH0gZWxlbWVudCAtIFRoZSB0YXJnZXQgZWxlbWVudC5cbiAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWUgLSBUaGUgZGF0YSBrZXkgdG8gc2V0LlxuICAgKiBAcGFyYW0ge3N0cmluZ30gZGF0YSAtIFRoZSBkYXRhIHZhbHVlLlxuICAgKi9cblxuICBmdW5jdGlvbiBzZXREYXRhKGVsZW1lbnQsIG5hbWUsIGRhdGEpIHtcbiAgICBpZiAoaXNPYmplY3QoZGF0YSkpIHtcbiAgICAgIGVsZW1lbnRbbmFtZV0gPSBkYXRhO1xuICAgIH0gZWxzZSBpZiAoZWxlbWVudC5kYXRhc2V0KSB7XG4gICAgICBlbGVtZW50LmRhdGFzZXRbbmFtZV0gPSBkYXRhO1xuICAgIH0gZWxzZSB7XG4gICAgICBlbGVtZW50LnNldEF0dHJpYnV0ZShcImRhdGEtXCIuY29uY2F0KGh5cGhlbmF0ZShuYW1lKSksIGRhdGEpO1xuICAgIH1cbiAgfVxuXG4gIHZhciBvbmNlU3VwcG9ydGVkID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBzdXBwb3J0ZWQgPSBmYWxzZTtcblxuICAgIGlmIChJU19CUk9XU0VSKSB7XG4gICAgICB2YXIgb25jZSA9IGZhbHNlO1xuXG4gICAgICB2YXIgbGlzdGVuZXIgPSBmdW5jdGlvbiBsaXN0ZW5lcigpIHt9O1xuXG4gICAgICB2YXIgb3B0aW9ucyA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh7fSwgJ29uY2UnLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgIHN1cHBvcnRlZCA9IHRydWU7XG4gICAgICAgICAgcmV0dXJuIG9uY2U7XG4gICAgICAgIH0sXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoaXMgc2V0dGVyIGNhbiBmaXggYSBgVHlwZUVycm9yYCBpbiBzdHJpY3QgbW9kZVxuICAgICAgICAgKiB7QGxpbmsgaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvRXJyb3JzL0dldHRlcl9vbmx5fVxuICAgICAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IHZhbHVlIC0gVGhlIHZhbHVlIHRvIHNldFxuICAgICAgICAgKi9cbiAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodmFsdWUpIHtcbiAgICAgICAgICBvbmNlID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgV0lORE9XLmFkZEV2ZW50TGlzdGVuZXIoJ3Rlc3QnLCBsaXN0ZW5lciwgb3B0aW9ucyk7XG4gICAgICBXSU5ET1cucmVtb3ZlRXZlbnRMaXN0ZW5lcigndGVzdCcsIGxpc3RlbmVyLCBvcHRpb25zKTtcbiAgICB9XG5cbiAgICByZXR1cm4gc3VwcG9ydGVkO1xuICB9KCk7XG4gIC8qKlxuICAgKiBSZW1vdmUgZXZlbnQgbGlzdGVuZXIgZnJvbSB0aGUgdGFyZ2V0IGVsZW1lbnQuXG4gICAqIEBwYXJhbSB7RWxlbWVudH0gZWxlbWVudCAtIFRoZSBldmVudCB0YXJnZXQuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIC0gVGhlIGV2ZW50IHR5cGUocykuXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IGxpc3RlbmVyIC0gVGhlIGV2ZW50IGxpc3RlbmVyLlxuICAgKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucyAtIFRoZSBldmVudCBvcHRpb25zLlxuICAgKi9cblxuXG4gIGZ1bmN0aW9uIHJlbW92ZUxpc3RlbmVyKGVsZW1lbnQsIHR5cGUsIGxpc3RlbmVyKSB7XG4gICAgdmFyIG9wdGlvbnMgPSBhcmd1bWVudHMubGVuZ3RoID4gMyAmJiBhcmd1bWVudHNbM10gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1szXSA6IHt9O1xuICAgIHZhciBoYW5kbGVyID0gbGlzdGVuZXI7XG4gICAgdHlwZS50cmltKCkuc3BsaXQoUkVHRVhQX1NQQUNFUykuZm9yRWFjaChmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgIGlmICghb25jZVN1cHBvcnRlZCkge1xuICAgICAgICB2YXIgbGlzdGVuZXJzID0gZWxlbWVudC5saXN0ZW5lcnM7XG5cbiAgICAgICAgaWYgKGxpc3RlbmVycyAmJiBsaXN0ZW5lcnNbZXZlbnRdICYmIGxpc3RlbmVyc1tldmVudF1bbGlzdGVuZXJdKSB7XG4gICAgICAgICAgaGFuZGxlciA9IGxpc3RlbmVyc1tldmVudF1bbGlzdGVuZXJdO1xuICAgICAgICAgIGRlbGV0ZSBsaXN0ZW5lcnNbZXZlbnRdW2xpc3RlbmVyXTtcblxuICAgICAgICAgIGlmIChPYmplY3Qua2V5cyhsaXN0ZW5lcnNbZXZlbnRdKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIGRlbGV0ZSBsaXN0ZW5lcnNbZXZlbnRdO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmIChPYmplY3Qua2V5cyhsaXN0ZW5lcnMpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgZGVsZXRlIGVsZW1lbnQubGlzdGVuZXJzO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBlbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnQsIGhhbmRsZXIsIG9wdGlvbnMpO1xuICAgIH0pO1xuICB9XG4gIC8qKlxuICAgKiBBZGQgZXZlbnQgbGlzdGVuZXIgdG8gdGhlIHRhcmdldCBlbGVtZW50LlxuICAgKiBAcGFyYW0ge0VsZW1lbnR9IGVsZW1lbnQgLSBUaGUgZXZlbnQgdGFyZ2V0LlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdHlwZSAtIFRoZSBldmVudCB0eXBlKHMpLlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBsaXN0ZW5lciAtIFRoZSBldmVudCBsaXN0ZW5lci5cbiAgICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMgLSBUaGUgZXZlbnQgb3B0aW9ucy5cbiAgICovXG5cbiAgZnVuY3Rpb24gYWRkTGlzdGVuZXIoZWxlbWVudCwgdHlwZSwgbGlzdGVuZXIpIHtcbiAgICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAzICYmIGFyZ3VtZW50c1szXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzNdIDoge307XG4gICAgdmFyIF9oYW5kbGVyID0gbGlzdGVuZXI7XG4gICAgdHlwZS50cmltKCkuc3BsaXQoUkVHRVhQX1NQQUNFUykuZm9yRWFjaChmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgIGlmIChvcHRpb25zLm9uY2UgJiYgIW9uY2VTdXBwb3J0ZWQpIHtcbiAgICAgICAgdmFyIF9lbGVtZW50JGxpc3RlbmVycyA9IGVsZW1lbnQubGlzdGVuZXJzLFxuICAgICAgICAgICAgbGlzdGVuZXJzID0gX2VsZW1lbnQkbGlzdGVuZXJzID09PSB2b2lkIDAgPyB7fSA6IF9lbGVtZW50JGxpc3RlbmVycztcblxuICAgICAgICBfaGFuZGxlciA9IGZ1bmN0aW9uIGhhbmRsZXIoKSB7XG4gICAgICAgICAgZGVsZXRlIGxpc3RlbmVyc1tldmVudF1bbGlzdGVuZXJdO1xuICAgICAgICAgIGVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudCwgX2hhbmRsZXIsIG9wdGlvbnMpO1xuXG4gICAgICAgICAgZm9yICh2YXIgX2xlbjIgPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4yKSwgX2tleTIgPSAwOyBfa2V5MiA8IF9sZW4yOyBfa2V5MisrKSB7XG4gICAgICAgICAgICBhcmdzW19rZXkyXSA9IGFyZ3VtZW50c1tfa2V5Ml07XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgbGlzdGVuZXIuYXBwbHkoZWxlbWVudCwgYXJncyk7XG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKCFsaXN0ZW5lcnNbZXZlbnRdKSB7XG4gICAgICAgICAgbGlzdGVuZXJzW2V2ZW50XSA9IHt9O1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGxpc3RlbmVyc1tldmVudF1bbGlzdGVuZXJdKSB7XG4gICAgICAgICAgZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50LCBsaXN0ZW5lcnNbZXZlbnRdW2xpc3RlbmVyXSwgb3B0aW9ucyk7XG4gICAgICAgIH1cblxuICAgICAgICBsaXN0ZW5lcnNbZXZlbnRdW2xpc3RlbmVyXSA9IF9oYW5kbGVyO1xuICAgICAgICBlbGVtZW50Lmxpc3RlbmVycyA9IGxpc3RlbmVycztcbiAgICAgIH1cblxuICAgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKGV2ZW50LCBfaGFuZGxlciwgb3B0aW9ucyk7XG4gICAgfSk7XG4gIH1cbiAgLyoqXG4gICAqIERpc3BhdGNoIGV2ZW50IG9uIHRoZSB0YXJnZXQgZWxlbWVudC5cbiAgICogQHBhcmFtIHtFbGVtZW50fSBlbGVtZW50IC0gVGhlIGV2ZW50IHRhcmdldC5cbiAgICogQHBhcmFtIHtzdHJpbmd9IHR5cGUgLSBUaGUgZXZlbnQgdHlwZShzKS5cbiAgICogQHBhcmFtIHtPYmplY3R9IGRhdGEgLSBUaGUgYWRkaXRpb25hbCBldmVudCBkYXRhLlxuICAgKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucyAtIFRoZSBhZGRpdGlvbmFsIGV2ZW50IG9wdGlvbnMuXG4gICAqIEByZXR1cm5zIHtib29sZWFufSBJbmRpY2F0ZSBpZiB0aGUgZXZlbnQgaXMgZGVmYXVsdCBwcmV2ZW50ZWQgb3Igbm90LlxuICAgKi9cblxuICBmdW5jdGlvbiBkaXNwYXRjaEV2ZW50KGVsZW1lbnQsIHR5cGUsIGRhdGEsIG9wdGlvbnMpIHtcbiAgICB2YXIgZXZlbnQ7IC8vIEV2ZW50IGFuZCBDdXN0b21FdmVudCBvbiBJRTktMTEgYXJlIGdsb2JhbCBvYmplY3RzLCBub3QgY29uc3RydWN0b3JzXG5cbiAgICBpZiAoaXNGdW5jdGlvbihFdmVudCkgJiYgaXNGdW5jdGlvbihDdXN0b21FdmVudCkpIHtcbiAgICAgIGV2ZW50ID0gbmV3IEN1c3RvbUV2ZW50KHR5cGUsIF9vYmplY3RTcHJlYWQyKHtcbiAgICAgICAgYnViYmxlczogdHJ1ZSxcbiAgICAgICAgY2FuY2VsYWJsZTogdHJ1ZSxcbiAgICAgICAgZGV0YWlsOiBkYXRhXG4gICAgICB9LCBvcHRpb25zKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGV2ZW50ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ0N1c3RvbUV2ZW50Jyk7XG4gICAgICBldmVudC5pbml0Q3VzdG9tRXZlbnQodHlwZSwgdHJ1ZSwgdHJ1ZSwgZGF0YSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGVsZW1lbnQuZGlzcGF0Y2hFdmVudChldmVudCk7XG4gIH1cbiAgLyoqXG4gICAqIEdldCB0aGUgb2Zmc2V0IGJhc2Ugb24gdGhlIGRvY3VtZW50LlxuICAgKiBAcGFyYW0ge0VsZW1lbnR9IGVsZW1lbnQgLSBUaGUgdGFyZ2V0IGVsZW1lbnQuXG4gICAqIEByZXR1cm5zIHtPYmplY3R9IFRoZSBvZmZzZXQgZGF0YS5cbiAgICovXG5cbiAgZnVuY3Rpb24gZ2V0T2Zmc2V0KGVsZW1lbnQpIHtcbiAgICB2YXIgYm94ID0gZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICByZXR1cm4ge1xuICAgICAgbGVmdDogYm94LmxlZnQgKyAod2luZG93LnBhZ2VYT2Zmc2V0IC0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudExlZnQpLFxuICAgICAgdG9wOiBib3gudG9wICsgKHdpbmRvdy5wYWdlWU9mZnNldCAtIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRUb3ApXG4gICAgfTtcbiAgfVxuICAvKipcbiAgICogR2V0IHRyYW5zZm9ybXMgYmFzZSBvbiB0aGUgZ2l2ZW4gb2JqZWN0LlxuICAgKiBAcGFyYW0ge09iamVjdH0gb2JqIC0gVGhlIHRhcmdldCBvYmplY3QuXG4gICAqIEByZXR1cm5zIHtzdHJpbmd9IEEgc3RyaW5nIGNvbnRhaW5zIHRyYW5zZm9ybSB2YWx1ZXMuXG4gICAqL1xuXG4gIGZ1bmN0aW9uIGdldFRyYW5zZm9ybXMoX3JlZikge1xuICAgIHZhciByb3RhdGUgPSBfcmVmLnJvdGF0ZSxcbiAgICAgICAgc2NhbGVYID0gX3JlZi5zY2FsZVgsXG4gICAgICAgIHNjYWxlWSA9IF9yZWYuc2NhbGVZLFxuICAgICAgICB0cmFuc2xhdGVYID0gX3JlZi50cmFuc2xhdGVYLFxuICAgICAgICB0cmFuc2xhdGVZID0gX3JlZi50cmFuc2xhdGVZO1xuICAgIHZhciB2YWx1ZXMgPSBbXTtcblxuICAgIGlmIChpc051bWJlcih0cmFuc2xhdGVYKSAmJiB0cmFuc2xhdGVYICE9PSAwKSB7XG4gICAgICB2YWx1ZXMucHVzaChcInRyYW5zbGF0ZVgoXCIuY29uY2F0KHRyYW5zbGF0ZVgsIFwicHgpXCIpKTtcbiAgICB9XG5cbiAgICBpZiAoaXNOdW1iZXIodHJhbnNsYXRlWSkgJiYgdHJhbnNsYXRlWSAhPT0gMCkge1xuICAgICAgdmFsdWVzLnB1c2goXCJ0cmFuc2xhdGVZKFwiLmNvbmNhdCh0cmFuc2xhdGVZLCBcInB4KVwiKSk7XG4gICAgfSAvLyBSb3RhdGUgc2hvdWxkIGNvbWUgZmlyc3QgYmVmb3JlIHNjYWxlIHRvIG1hdGNoIG9yaWVudGF0aW9uIHRyYW5zZm9ybVxuXG5cbiAgICBpZiAoaXNOdW1iZXIocm90YXRlKSAmJiByb3RhdGUgIT09IDApIHtcbiAgICAgIHZhbHVlcy5wdXNoKFwicm90YXRlKFwiLmNvbmNhdChyb3RhdGUsIFwiZGVnKVwiKSk7XG4gICAgfVxuXG4gICAgaWYgKGlzTnVtYmVyKHNjYWxlWCkgJiYgc2NhbGVYICE9PSAxKSB7XG4gICAgICB2YWx1ZXMucHVzaChcInNjYWxlWChcIi5jb25jYXQoc2NhbGVYLCBcIilcIikpO1xuICAgIH1cblxuICAgIGlmIChpc051bWJlcihzY2FsZVkpICYmIHNjYWxlWSAhPT0gMSkge1xuICAgICAgdmFsdWVzLnB1c2goXCJzY2FsZVkoXCIuY29uY2F0KHNjYWxlWSwgXCIpXCIpKTtcbiAgICB9XG5cbiAgICB2YXIgdHJhbnNmb3JtID0gdmFsdWVzLmxlbmd0aCA/IHZhbHVlcy5qb2luKCcgJykgOiAnbm9uZSc7XG4gICAgcmV0dXJuIHtcbiAgICAgIFdlYmtpdFRyYW5zZm9ybTogdHJhbnNmb3JtLFxuICAgICAgbXNUcmFuc2Zvcm06IHRyYW5zZm9ybSxcbiAgICAgIHRyYW5zZm9ybTogdHJhbnNmb3JtXG4gICAgfTtcbiAgfVxuICAvKipcbiAgICogR2V0IGFuIGltYWdlIG5hbWUgZnJvbSBhbiBpbWFnZSB1cmwuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSB1cmwgLSBUaGUgdGFyZ2V0IHVybC5cbiAgICogQGV4YW1wbGVcbiAgICogLy8gcGljdHVyZS5qcGdcbiAgICogZ2V0SW1hZ2VOYW1lRnJvbVVSTCgnaHR0cHM6Ly9kb21haW4uY29tL3BhdGgvdG8vcGljdHVyZS5qcGc/c2l6ZT0xMjgww5c5NjAnKVxuICAgKiBAcmV0dXJucyB7c3RyaW5nfSBBIHN0cmluZyBjb250YWlucyB0aGUgaW1hZ2UgbmFtZS5cbiAgICovXG5cbiAgZnVuY3Rpb24gZ2V0SW1hZ2VOYW1lRnJvbVVSTCh1cmwpIHtcbiAgICByZXR1cm4gaXNTdHJpbmcodXJsKSA/IGRlY29kZVVSSUNvbXBvbmVudCh1cmwucmVwbGFjZSgvXi4qXFwvLywgJycpLnJlcGxhY2UoL1s/JiNdLiokLywgJycpKSA6ICcnO1xuICB9XG4gIHZhciBJU19TQUZBUkkgPSBXSU5ET1cubmF2aWdhdG9yICYmIC8oTWFjaW50b3NofGlQaG9uZXxpUG9kfGlQYWQpLipBcHBsZVdlYktpdC9pLnRlc3QoV0lORE9XLm5hdmlnYXRvci51c2VyQWdlbnQpO1xuICAvKipcbiAgICogR2V0IGFuIGltYWdlJ3MgbmF0dXJhbCBzaXplcy5cbiAgICogQHBhcmFtIHtzdHJpbmd9IGltYWdlIC0gVGhlIHRhcmdldCBpbWFnZS5cbiAgICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMgLSBUaGUgdmlld2VyIG9wdGlvbnMuXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIC0gVGhlIGNhbGxiYWNrIGZ1bmN0aW9uLlxuICAgKiBAcmV0dXJucyB7SFRNTEltYWdlRWxlbWVudH0gVGhlIG5ldyBpbWFnZS5cbiAgICovXG5cbiAgZnVuY3Rpb24gZ2V0SW1hZ2VOYXR1cmFsU2l6ZXMoaW1hZ2UsIG9wdGlvbnMsIGNhbGxiYWNrKSB7XG4gICAgdmFyIG5ld0ltYWdlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7IC8vIE1vZGVybiBicm93c2VycyAoZXhjZXB0IFNhZmFyaSlcblxuICAgIGlmIChpbWFnZS5uYXR1cmFsV2lkdGggJiYgIUlTX1NBRkFSSSkge1xuICAgICAgY2FsbGJhY2soaW1hZ2UubmF0dXJhbFdpZHRoLCBpbWFnZS5uYXR1cmFsSGVpZ2h0KTtcbiAgICAgIHJldHVybiBuZXdJbWFnZTtcbiAgICB9XG5cbiAgICB2YXIgYm9keSA9IGRvY3VtZW50LmJvZHkgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50O1xuXG4gICAgbmV3SW1hZ2Uub25sb2FkID0gZnVuY3Rpb24gKCkge1xuICAgICAgY2FsbGJhY2sobmV3SW1hZ2Uud2lkdGgsIG5ld0ltYWdlLmhlaWdodCk7XG5cbiAgICAgIGlmICghSVNfU0FGQVJJKSB7XG4gICAgICAgIGJvZHkucmVtb3ZlQ2hpbGQobmV3SW1hZ2UpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBmb3JFYWNoKG9wdGlvbnMuaW5oZXJpdGVkQXR0cmlidXRlcywgZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgIHZhciB2YWx1ZSA9IGltYWdlLmdldEF0dHJpYnV0ZShuYW1lKTtcblxuICAgICAgaWYgKHZhbHVlICE9PSBudWxsKSB7XG4gICAgICAgIG5ld0ltYWdlLnNldEF0dHJpYnV0ZShuYW1lLCB2YWx1ZSk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgbmV3SW1hZ2Uuc3JjID0gaW1hZ2Uuc3JjOyAvLyBpT1MgU2FmYXJpIHdpbGwgY29udmVydCB0aGUgaW1hZ2UgYXV0b21hdGljYWxseVxuICAgIC8vIHdpdGggaXRzIG9yaWVudGF0aW9uIG9uY2UgYXBwZW5kIGl0IGludG8gRE9NXG5cbiAgICBpZiAoIUlTX1NBRkFSSSkge1xuICAgICAgbmV3SW1hZ2Uuc3R5bGUuY3NzVGV4dCA9ICdsZWZ0OjA7JyArICdtYXgtaGVpZ2h0Om5vbmUhaW1wb3J0YW50OycgKyAnbWF4LXdpZHRoOm5vbmUhaW1wb3J0YW50OycgKyAnbWluLWhlaWdodDowIWltcG9ydGFudDsnICsgJ21pbi13aWR0aDowIWltcG9ydGFudDsnICsgJ29wYWNpdHk6MDsnICsgJ3Bvc2l0aW9uOmFic29sdXRlOycgKyAndG9wOjA7JyArICd6LWluZGV4Oi0xOyc7XG4gICAgICBib2R5LmFwcGVuZENoaWxkKG5ld0ltYWdlKTtcbiAgICB9XG5cbiAgICByZXR1cm4gbmV3SW1hZ2U7XG4gIH1cbiAgLyoqXG4gICAqIEdldCB0aGUgcmVsYXRlZCBjbGFzcyBuYW1lIG9mIGEgcmVzcG9uc2l2ZSB0eXBlIG51bWJlci5cbiAgICogQHBhcmFtIHtzdHJpbmd9IHR5cGUgLSBUaGUgcmVzcG9uc2l2ZSB0eXBlLlxuICAgKiBAcmV0dXJucyB7c3RyaW5nfSBUaGUgcmVsYXRlZCBjbGFzcyBuYW1lLlxuICAgKi9cblxuICBmdW5jdGlvbiBnZXRSZXNwb25zaXZlQ2xhc3ModHlwZSkge1xuICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgY2FzZSAyOlxuICAgICAgICByZXR1cm4gQ0xBU1NfSElERV9YU19ET1dOO1xuXG4gICAgICBjYXNlIDM6XG4gICAgICAgIHJldHVybiBDTEFTU19ISURFX1NNX0RPV047XG5cbiAgICAgIGNhc2UgNDpcbiAgICAgICAgcmV0dXJuIENMQVNTX0hJREVfTURfRE9XTjtcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuICcnO1xuICAgIH1cbiAgfVxuICAvKipcbiAgICogR2V0IHRoZSBtYXggcmF0aW8gb2YgYSBncm91cCBvZiBwb2ludGVycy5cbiAgICogQHBhcmFtIHtzdHJpbmd9IHBvaW50ZXJzIC0gVGhlIHRhcmdldCBwb2ludGVycy5cbiAgICogQHJldHVybnMge251bWJlcn0gVGhlIHJlc3VsdCByYXRpby5cbiAgICovXG5cbiAgZnVuY3Rpb24gZ2V0TWF4Wm9vbVJhdGlvKHBvaW50ZXJzKSB7XG4gICAgdmFyIHBvaW50ZXJzMiA9IF9vYmplY3RTcHJlYWQyKHt9LCBwb2ludGVycyk7XG5cbiAgICB2YXIgcmF0aW9zID0gW107XG4gICAgZm9yRWFjaChwb2ludGVycywgZnVuY3Rpb24gKHBvaW50ZXIsIHBvaW50ZXJJZCkge1xuICAgICAgZGVsZXRlIHBvaW50ZXJzMltwb2ludGVySWRdO1xuICAgICAgZm9yRWFjaChwb2ludGVyczIsIGZ1bmN0aW9uIChwb2ludGVyMikge1xuICAgICAgICB2YXIgeDEgPSBNYXRoLmFicyhwb2ludGVyLnN0YXJ0WCAtIHBvaW50ZXIyLnN0YXJ0WCk7XG4gICAgICAgIHZhciB5MSA9IE1hdGguYWJzKHBvaW50ZXIuc3RhcnRZIC0gcG9pbnRlcjIuc3RhcnRZKTtcbiAgICAgICAgdmFyIHgyID0gTWF0aC5hYnMocG9pbnRlci5lbmRYIC0gcG9pbnRlcjIuZW5kWCk7XG4gICAgICAgIHZhciB5MiA9IE1hdGguYWJzKHBvaW50ZXIuZW5kWSAtIHBvaW50ZXIyLmVuZFkpO1xuICAgICAgICB2YXIgejEgPSBNYXRoLnNxcnQoeDEgKiB4MSArIHkxICogeTEpO1xuICAgICAgICB2YXIgejIgPSBNYXRoLnNxcnQoeDIgKiB4MiArIHkyICogeTIpO1xuICAgICAgICB2YXIgcmF0aW8gPSAoejIgLSB6MSkgLyB6MTtcbiAgICAgICAgcmF0aW9zLnB1c2gocmF0aW8pO1xuICAgICAgfSk7XG4gICAgfSk7XG4gICAgcmF0aW9zLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgIHJldHVybiBNYXRoLmFicyhhKSA8IE1hdGguYWJzKGIpO1xuICAgIH0pO1xuICAgIHJldHVybiByYXRpb3NbMF07XG4gIH1cbiAgLyoqXG4gICAqIEdldCBhIHBvaW50ZXIgZnJvbSBhbiBldmVudCBvYmplY3QuXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBldmVudCAtIFRoZSB0YXJnZXQgZXZlbnQgb2JqZWN0LlxuICAgKiBAcGFyYW0ge2Jvb2xlYW59IGVuZE9ubHkgLSBJbmRpY2F0ZXMgaWYgb25seSByZXR1cm5zIHRoZSBlbmQgcG9pbnQgY29vcmRpbmF0ZSBvciBub3QuXG4gICAqIEByZXR1cm5zIHtPYmplY3R9IFRoZSByZXN1bHQgcG9pbnRlciBjb250YWlucyBzdGFydCBhbmQvb3IgZW5kIHBvaW50IGNvb3JkaW5hdGVzLlxuICAgKi9cblxuICBmdW5jdGlvbiBnZXRQb2ludGVyKF9yZWYyLCBlbmRPbmx5KSB7XG4gICAgdmFyIHBhZ2VYID0gX3JlZjIucGFnZVgsXG4gICAgICAgIHBhZ2VZID0gX3JlZjIucGFnZVk7XG4gICAgdmFyIGVuZCA9IHtcbiAgICAgIGVuZFg6IHBhZ2VYLFxuICAgICAgZW5kWTogcGFnZVlcbiAgICB9O1xuICAgIHJldHVybiBlbmRPbmx5ID8gZW5kIDogX29iamVjdFNwcmVhZDIoe1xuICAgICAgdGltZVN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgc3RhcnRYOiBwYWdlWCxcbiAgICAgIHN0YXJ0WTogcGFnZVlcbiAgICB9LCBlbmQpO1xuICB9XG4gIC8qKlxuICAgKiBHZXQgdGhlIGNlbnRlciBwb2ludCBjb29yZGluYXRlIG9mIGEgZ3JvdXAgb2YgcG9pbnRlcnMuXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBwb2ludGVycyAtIFRoZSB0YXJnZXQgcG9pbnRlcnMuXG4gICAqIEByZXR1cm5zIHtPYmplY3R9IFRoZSBjZW50ZXIgcG9pbnQgY29vcmRpbmF0ZS5cbiAgICovXG5cbiAgZnVuY3Rpb24gZ2V0UG9pbnRlcnNDZW50ZXIocG9pbnRlcnMpIHtcbiAgICB2YXIgcGFnZVggPSAwO1xuICAgIHZhciBwYWdlWSA9IDA7XG4gICAgdmFyIGNvdW50ID0gMDtcbiAgICBmb3JFYWNoKHBvaW50ZXJzLCBmdW5jdGlvbiAoX3JlZjMpIHtcbiAgICAgIHZhciBzdGFydFggPSBfcmVmMy5zdGFydFgsXG4gICAgICAgICAgc3RhcnRZID0gX3JlZjMuc3RhcnRZO1xuICAgICAgcGFnZVggKz0gc3RhcnRYO1xuICAgICAgcGFnZVkgKz0gc3RhcnRZO1xuICAgICAgY291bnQgKz0gMTtcbiAgICB9KTtcbiAgICBwYWdlWCAvPSBjb3VudDtcbiAgICBwYWdlWSAvPSBjb3VudDtcbiAgICByZXR1cm4ge1xuICAgICAgcGFnZVg6IHBhZ2VYLFxuICAgICAgcGFnZVk6IHBhZ2VZXG4gICAgfTtcbiAgfVxuXG4gIHZhciByZW5kZXIgPSB7XG4gICAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIoKSB7XG4gICAgICB0aGlzLmluaXRDb250YWluZXIoKTtcbiAgICAgIHRoaXMuaW5pdFZpZXdlcigpO1xuICAgICAgdGhpcy5pbml0TGlzdCgpO1xuICAgICAgdGhpcy5yZW5kZXJWaWV3ZXIoKTtcbiAgICB9LFxuICAgIGluaXRCb2R5OiBmdW5jdGlvbiBpbml0Qm9keSgpIHtcbiAgICAgIHZhciBvd25lckRvY3VtZW50ID0gdGhpcy5lbGVtZW50Lm93bmVyRG9jdW1lbnQ7XG4gICAgICB2YXIgYm9keSA9IG93bmVyRG9jdW1lbnQuYm9keSB8fCBvd25lckRvY3VtZW50LmRvY3VtZW50RWxlbWVudDtcbiAgICAgIHRoaXMuYm9keSA9IGJvZHk7XG4gICAgICB0aGlzLnNjcm9sbGJhcldpZHRoID0gd2luZG93LmlubmVyV2lkdGggLSBvd25lckRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aDtcbiAgICAgIHRoaXMuaW5pdGlhbEJvZHlQYWRkaW5nUmlnaHQgPSBib2R5LnN0eWxlLnBhZGRpbmdSaWdodDtcbiAgICAgIHRoaXMuaW5pdGlhbEJvZHlDb21wdXRlZFBhZGRpbmdSaWdodCA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGJvZHkpLnBhZGRpbmdSaWdodDtcbiAgICB9LFxuICAgIGluaXRDb250YWluZXI6IGZ1bmN0aW9uIGluaXRDb250YWluZXIoKSB7XG4gICAgICB0aGlzLmNvbnRhaW5lckRhdGEgPSB7XG4gICAgICAgIHdpZHRoOiB3aW5kb3cuaW5uZXJXaWR0aCxcbiAgICAgICAgaGVpZ2h0OiB3aW5kb3cuaW5uZXJIZWlnaHRcbiAgICAgIH07XG4gICAgfSxcbiAgICBpbml0Vmlld2VyOiBmdW5jdGlvbiBpbml0Vmlld2VyKCkge1xuICAgICAgdmFyIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnMsXG4gICAgICAgICAgcGFyZW50ID0gdGhpcy5wYXJlbnQ7XG4gICAgICB2YXIgdmlld2VyRGF0YTtcblxuICAgICAgaWYgKG9wdGlvbnMuaW5saW5lKSB7XG4gICAgICAgIHZpZXdlckRhdGEgPSB7XG4gICAgICAgICAgd2lkdGg6IE1hdGgubWF4KHBhcmVudC5vZmZzZXRXaWR0aCwgb3B0aW9ucy5taW5XaWR0aCksXG4gICAgICAgICAgaGVpZ2h0OiBNYXRoLm1heChwYXJlbnQub2Zmc2V0SGVpZ2h0LCBvcHRpb25zLm1pbkhlaWdodClcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5wYXJlbnREYXRhID0gdmlld2VyRGF0YTtcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMuZnVsbGVkIHx8ICF2aWV3ZXJEYXRhKSB7XG4gICAgICAgIHZpZXdlckRhdGEgPSB0aGlzLmNvbnRhaW5lckRhdGE7XG4gICAgICB9XG5cbiAgICAgIHRoaXMudmlld2VyRGF0YSA9IGFzc2lnbih7fSwgdmlld2VyRGF0YSk7XG4gICAgfSxcbiAgICByZW5kZXJWaWV3ZXI6IGZ1bmN0aW9uIHJlbmRlclZpZXdlcigpIHtcbiAgICAgIGlmICh0aGlzLm9wdGlvbnMuaW5saW5lICYmICF0aGlzLmZ1bGxlZCkge1xuICAgICAgICBzZXRTdHlsZSh0aGlzLnZpZXdlciwgdGhpcy52aWV3ZXJEYXRhKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIGluaXRMaXN0OiBmdW5jdGlvbiBpbml0TGlzdCgpIHtcbiAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICAgIHZhciBlbGVtZW50ID0gdGhpcy5lbGVtZW50LFxuICAgICAgICAgIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnMsXG4gICAgICAgICAgbGlzdCA9IHRoaXMubGlzdDtcbiAgICAgIHZhciBpdGVtcyA9IFtdOyAvLyBpbml0TGlzdCBtYXkgYmUgY2FsbGVkIGluIHRoaXMudXBkYXRlLCBzbyBzaG91bGQga2VlcCBpZGVtcG90ZW50XG5cbiAgICAgIGxpc3QuaW5uZXJIVE1MID0gJyc7XG4gICAgICBmb3JFYWNoKHRoaXMuaW1hZ2VzLCBmdW5jdGlvbiAoaW1hZ2UsIGluZGV4KSB7XG4gICAgICAgIHZhciBzcmMgPSBpbWFnZS5zcmM7XG4gICAgICAgIHZhciBhbHQgPSBpbWFnZS5hbHQgfHwgZ2V0SW1hZ2VOYW1lRnJvbVVSTChzcmMpO1xuXG4gICAgICAgIHZhciB1cmwgPSBfdGhpcy5nZXRJbWFnZVVSTChpbWFnZSk7XG5cbiAgICAgICAgaWYgKHNyYyB8fCB1cmwpIHtcbiAgICAgICAgICB2YXIgaXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XG4gICAgICAgICAgdmFyIGltZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xuICAgICAgICAgIGZvckVhY2gob3B0aW9ucy5pbmhlcml0ZWRBdHRyaWJ1dGVzLCBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICAgICAgdmFyIHZhbHVlID0gaW1hZ2UuZ2V0QXR0cmlidXRlKG5hbWUpO1xuXG4gICAgICAgICAgICBpZiAodmFsdWUgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgaW1nLnNldEF0dHJpYnV0ZShuYW1lLCB2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgaW1nLnNyYyA9IHNyYyB8fCB1cmw7XG4gICAgICAgICAgaW1nLmFsdCA9IGFsdDtcbiAgICAgICAgICBpbWcuc2V0QXR0cmlidXRlKCdkYXRhLW9yaWdpbmFsLXVybCcsIHVybCB8fCBzcmMpO1xuICAgICAgICAgIGl0ZW0uc2V0QXR0cmlidXRlKCdkYXRhLWluZGV4JywgaW5kZXgpO1xuICAgICAgICAgIGl0ZW0uc2V0QXR0cmlidXRlKCdkYXRhLXZpZXdlci1hY3Rpb24nLCAndmlldycpO1xuICAgICAgICAgIGl0ZW0uc2V0QXR0cmlidXRlKCdyb2xlJywgJ2J1dHRvbicpO1xuXG4gICAgICAgICAgaWYgKG9wdGlvbnMua2V5Ym9hcmQpIHtcbiAgICAgICAgICAgIGl0ZW0uc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsIDApO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGl0ZW0uYXBwZW5kQ2hpbGQoaW1nKTtcbiAgICAgICAgICBsaXN0LmFwcGVuZENoaWxkKGl0ZW0pO1xuICAgICAgICAgIGl0ZW1zLnB1c2goaXRlbSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgdGhpcy5pdGVtcyA9IGl0ZW1zO1xuICAgICAgZm9yRWFjaChpdGVtcywgZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgdmFyIGltYWdlID0gaXRlbS5maXJzdEVsZW1lbnRDaGlsZDtcbiAgICAgICAgc2V0RGF0YShpbWFnZSwgJ2ZpbGxlZCcsIHRydWUpO1xuXG4gICAgICAgIGlmIChvcHRpb25zLmxvYWRpbmcpIHtcbiAgICAgICAgICBhZGRDbGFzcyhpdGVtLCBDTEFTU19MT0FESU5HKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGFkZExpc3RlbmVyKGltYWdlLCBFVkVOVF9MT0FELCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICBpZiAob3B0aW9ucy5sb2FkaW5nKSB7XG4gICAgICAgICAgICByZW1vdmVDbGFzcyhpdGVtLCBDTEFTU19MT0FESU5HKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBfdGhpcy5sb2FkSW1hZ2UoZXZlbnQpO1xuICAgICAgICB9LCB7XG4gICAgICAgICAgb25jZTogdHJ1ZVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuXG4gICAgICBpZiAob3B0aW9ucy50cmFuc2l0aW9uKSB7XG4gICAgICAgIGFkZExpc3RlbmVyKGVsZW1lbnQsIEVWRU5UX1ZJRVdFRCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGFkZENsYXNzKGxpc3QsIENMQVNTX1RSQU5TSVRJT04pO1xuICAgICAgICB9LCB7XG4gICAgICAgICAgb25jZTogdHJ1ZVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9LFxuICAgIHJlbmRlckxpc3Q6IGZ1bmN0aW9uIHJlbmRlckxpc3QoaW5kZXgpIHtcbiAgICAgIHZhciBpID0gaW5kZXggfHwgdGhpcy5pbmRleDtcbiAgICAgIHZhciB3aWR0aCA9IHRoaXMuaXRlbXNbaV0ub2Zmc2V0V2lkdGggfHwgMzA7XG4gICAgICB2YXIgb3V0ZXJXaWR0aCA9IHdpZHRoICsgMTsgLy8gMSBwaXhlbCBvZiBgbWFyZ2luLWxlZnRgIHdpZHRoXG4gICAgICAvLyBQbGFjZSB0aGUgYWN0aXZlIGl0ZW0gaW4gdGhlIGNlbnRlciBvZiB0aGUgc2NyZWVuXG5cbiAgICAgIHNldFN0eWxlKHRoaXMubGlzdCwgYXNzaWduKHtcbiAgICAgICAgd2lkdGg6IG91dGVyV2lkdGggKiB0aGlzLmxlbmd0aFxuICAgICAgfSwgZ2V0VHJhbnNmb3Jtcyh7XG4gICAgICAgIHRyYW5zbGF0ZVg6ICh0aGlzLnZpZXdlckRhdGEud2lkdGggLSB3aWR0aCkgLyAyIC0gb3V0ZXJXaWR0aCAqIGlcbiAgICAgIH0pKSk7XG4gICAgfSxcbiAgICByZXNldExpc3Q6IGZ1bmN0aW9uIHJlc2V0TGlzdCgpIHtcbiAgICAgIHZhciBsaXN0ID0gdGhpcy5saXN0O1xuICAgICAgbGlzdC5pbm5lckhUTUwgPSAnJztcbiAgICAgIHJlbW92ZUNsYXNzKGxpc3QsIENMQVNTX1RSQU5TSVRJT04pO1xuICAgICAgc2V0U3R5bGUobGlzdCwgZ2V0VHJhbnNmb3Jtcyh7XG4gICAgICAgIHRyYW5zbGF0ZVg6IDBcbiAgICAgIH0pKTtcbiAgICB9LFxuICAgIGluaXRJbWFnZTogZnVuY3Rpb24gaW5pdEltYWdlKGRvbmUpIHtcbiAgICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gICAgICB2YXIgb3B0aW9ucyA9IHRoaXMub3B0aW9ucyxcbiAgICAgICAgICBpbWFnZSA9IHRoaXMuaW1hZ2UsXG4gICAgICAgICAgdmlld2VyRGF0YSA9IHRoaXMudmlld2VyRGF0YTtcbiAgICAgIHZhciBmb290ZXJIZWlnaHQgPSB0aGlzLmZvb3Rlci5vZmZzZXRIZWlnaHQ7XG4gICAgICB2YXIgdmlld2VyV2lkdGggPSB2aWV3ZXJEYXRhLndpZHRoO1xuICAgICAgdmFyIHZpZXdlckhlaWdodCA9IE1hdGgubWF4KHZpZXdlckRhdGEuaGVpZ2h0IC0gZm9vdGVySGVpZ2h0LCBmb290ZXJIZWlnaHQpO1xuICAgICAgdmFyIG9sZEltYWdlRGF0YSA9IHRoaXMuaW1hZ2VEYXRhIHx8IHt9O1xuICAgICAgdmFyIHNpemluZ0ltYWdlO1xuICAgICAgdGhpcy5pbWFnZUluaXRpYWxpemluZyA9IHtcbiAgICAgICAgYWJvcnQ6IGZ1bmN0aW9uIGFib3J0KCkge1xuICAgICAgICAgIHNpemluZ0ltYWdlLm9ubG9hZCA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBzaXppbmdJbWFnZSA9IGdldEltYWdlTmF0dXJhbFNpemVzKGltYWdlLCBvcHRpb25zLCBmdW5jdGlvbiAobmF0dXJhbFdpZHRoLCBuYXR1cmFsSGVpZ2h0KSB7XG4gICAgICAgIHZhciBhc3BlY3RSYXRpbyA9IG5hdHVyYWxXaWR0aCAvIG5hdHVyYWxIZWlnaHQ7XG4gICAgICAgIHZhciB3aWR0aCA9IHZpZXdlcldpZHRoO1xuICAgICAgICB2YXIgaGVpZ2h0ID0gdmlld2VySGVpZ2h0O1xuICAgICAgICBfdGhpczIuaW1hZ2VJbml0aWFsaXppbmcgPSBmYWxzZTtcblxuICAgICAgICBpZiAodmlld2VySGVpZ2h0ICogYXNwZWN0UmF0aW8gPiB2aWV3ZXJXaWR0aCkge1xuICAgICAgICAgIGhlaWdodCA9IHZpZXdlcldpZHRoIC8gYXNwZWN0UmF0aW87XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgd2lkdGggPSB2aWV3ZXJIZWlnaHQgKiBhc3BlY3RSYXRpbztcbiAgICAgICAgfVxuXG4gICAgICAgIHdpZHRoID0gTWF0aC5taW4od2lkdGggKiAwLjksIG5hdHVyYWxXaWR0aCk7XG4gICAgICAgIGhlaWdodCA9IE1hdGgubWluKGhlaWdodCAqIDAuOSwgbmF0dXJhbEhlaWdodCk7XG4gICAgICAgIHZhciBsZWZ0ID0gKHZpZXdlcldpZHRoIC0gd2lkdGgpIC8gMjtcbiAgICAgICAgdmFyIHRvcCA9ICh2aWV3ZXJIZWlnaHQgLSBoZWlnaHQpIC8gMjtcbiAgICAgICAgdmFyIGltYWdlRGF0YSA9IHtcbiAgICAgICAgICBsZWZ0OiBsZWZ0LFxuICAgICAgICAgIHRvcDogdG9wLFxuICAgICAgICAgIHg6IGxlZnQsXG4gICAgICAgICAgeTogdG9wLFxuICAgICAgICAgIHdpZHRoOiB3aWR0aCxcbiAgICAgICAgICBoZWlnaHQ6IGhlaWdodCxcbiAgICAgICAgICByYXRpbzogd2lkdGggLyBuYXR1cmFsV2lkdGgsXG4gICAgICAgICAgYXNwZWN0UmF0aW86IGFzcGVjdFJhdGlvLFxuICAgICAgICAgIG5hdHVyYWxXaWR0aDogbmF0dXJhbFdpZHRoLFxuICAgICAgICAgIG5hdHVyYWxIZWlnaHQ6IG5hdHVyYWxIZWlnaHRcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIGluaXRpYWxJbWFnZURhdGEgPSBhc3NpZ24oe30sIGltYWdlRGF0YSk7XG5cbiAgICAgICAgaWYgKG9wdGlvbnMucm90YXRhYmxlKSB7XG4gICAgICAgICAgaW1hZ2VEYXRhLnJvdGF0ZSA9IG9sZEltYWdlRGF0YS5yb3RhdGUgfHwgMDtcbiAgICAgICAgICBpbml0aWFsSW1hZ2VEYXRhLnJvdGF0ZSA9IDA7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAob3B0aW9ucy5zY2FsYWJsZSkge1xuICAgICAgICAgIGltYWdlRGF0YS5zY2FsZVggPSBvbGRJbWFnZURhdGEuc2NhbGVYIHx8IDE7XG4gICAgICAgICAgaW1hZ2VEYXRhLnNjYWxlWSA9IG9sZEltYWdlRGF0YS5zY2FsZVkgfHwgMTtcbiAgICAgICAgICBpbml0aWFsSW1hZ2VEYXRhLnNjYWxlWCA9IDE7XG4gICAgICAgICAgaW5pdGlhbEltYWdlRGF0YS5zY2FsZVkgPSAxO1xuICAgICAgICB9XG5cbiAgICAgICAgX3RoaXMyLmltYWdlRGF0YSA9IGltYWdlRGF0YTtcbiAgICAgICAgX3RoaXMyLmluaXRpYWxJbWFnZURhdGEgPSBpbml0aWFsSW1hZ2VEYXRhO1xuXG4gICAgICAgIGlmIChkb25lKSB7XG4gICAgICAgICAgZG9uZSgpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9LFxuICAgIHJlbmRlckltYWdlOiBmdW5jdGlvbiByZW5kZXJJbWFnZShkb25lKSB7XG4gICAgICB2YXIgX3RoaXMzID0gdGhpcztcblxuICAgICAgdmFyIGltYWdlID0gdGhpcy5pbWFnZSxcbiAgICAgICAgICBpbWFnZURhdGEgPSB0aGlzLmltYWdlRGF0YTtcbiAgICAgIHNldFN0eWxlKGltYWdlLCBhc3NpZ24oe1xuICAgICAgICB3aWR0aDogaW1hZ2VEYXRhLndpZHRoLFxuICAgICAgICBoZWlnaHQ6IGltYWdlRGF0YS5oZWlnaHQsXG4gICAgICAgIC8vIFhYWDogTm90IHRvIHVzZSB0cmFuc2xhdGVYL1kgdG8gYXZvaWQgaW1hZ2Ugc2hha2luZyB3aGVuIHpvb21pbmdcbiAgICAgICAgbWFyZ2luTGVmdDogaW1hZ2VEYXRhLngsXG4gICAgICAgIG1hcmdpblRvcDogaW1hZ2VEYXRhLnlcbiAgICAgIH0sIGdldFRyYW5zZm9ybXMoaW1hZ2VEYXRhKSkpO1xuXG4gICAgICBpZiAoZG9uZSkge1xuICAgICAgICBpZiAoKHRoaXMudmlld2luZyB8fCB0aGlzLm1vdmluZyB8fCB0aGlzLnJvdGF0aW5nIHx8IHRoaXMuc2NhbGluZyB8fCB0aGlzLnpvb21pbmcpICYmIHRoaXMub3B0aW9ucy50cmFuc2l0aW9uICYmIGhhc0NsYXNzKGltYWdlLCBDTEFTU19UUkFOU0lUSU9OKSkge1xuICAgICAgICAgIHZhciBvblRyYW5zaXRpb25FbmQgPSBmdW5jdGlvbiBvblRyYW5zaXRpb25FbmQoKSB7XG4gICAgICAgICAgICBfdGhpczMuaW1hZ2VSZW5kZXJpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIGRvbmUoKTtcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgdGhpcy5pbWFnZVJlbmRlcmluZyA9IHtcbiAgICAgICAgICAgIGFib3J0OiBmdW5jdGlvbiBhYm9ydCgpIHtcbiAgICAgICAgICAgICAgcmVtb3ZlTGlzdGVuZXIoaW1hZ2UsIEVWRU5UX1RSQU5TSVRJT05fRU5ELCBvblRyYW5zaXRpb25FbmQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH07XG4gICAgICAgICAgYWRkTGlzdGVuZXIoaW1hZ2UsIEVWRU5UX1RSQU5TSVRJT05fRU5ELCBvblRyYW5zaXRpb25FbmQsIHtcbiAgICAgICAgICAgIG9uY2U6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBkb25lKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuICAgIHJlc2V0SW1hZ2U6IGZ1bmN0aW9uIHJlc2V0SW1hZ2UoKSB7XG4gICAgICAvLyB0aGlzLmltYWdlIG9ubHkgZGVmaW5lZCBhZnRlciB2aWV3ZWRcbiAgICAgIGlmICh0aGlzLnZpZXdpbmcgfHwgdGhpcy52aWV3ZWQpIHtcbiAgICAgICAgdmFyIGltYWdlID0gdGhpcy5pbWFnZTtcblxuICAgICAgICBpZiAodGhpcy52aWV3aW5nKSB7XG4gICAgICAgICAgdGhpcy52aWV3aW5nLmFib3J0KCk7XG4gICAgICAgIH1cblxuICAgICAgICBpbWFnZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGltYWdlKTtcbiAgICAgICAgdGhpcy5pbWFnZSA9IG51bGw7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIHZhciBldmVudHMgPSB7XG4gICAgYmluZDogZnVuY3Rpb24gYmluZCgpIHtcbiAgICAgIHZhciBvcHRpb25zID0gdGhpcy5vcHRpb25zLFxuICAgICAgICAgIHZpZXdlciA9IHRoaXMudmlld2VyLFxuICAgICAgICAgIGNhbnZhcyA9IHRoaXMuY2FudmFzO1xuICAgICAgdmFyIGRvY3VtZW50ID0gdGhpcy5lbGVtZW50Lm93bmVyRG9jdW1lbnQ7XG4gICAgICBhZGRMaXN0ZW5lcih2aWV3ZXIsIEVWRU5UX0NMSUNLLCB0aGlzLm9uQ2xpY2sgPSB0aGlzLmNsaWNrLmJpbmQodGhpcykpO1xuICAgICAgYWRkTGlzdGVuZXIodmlld2VyLCBFVkVOVF9EUkFHX1NUQVJULCB0aGlzLm9uRHJhZ1N0YXJ0ID0gdGhpcy5kcmFnc3RhcnQuYmluZCh0aGlzKSk7XG4gICAgICBhZGRMaXN0ZW5lcihjYW52YXMsIEVWRU5UX1BPSU5URVJfRE9XTiwgdGhpcy5vblBvaW50ZXJEb3duID0gdGhpcy5wb2ludGVyZG93bi5iaW5kKHRoaXMpKTtcbiAgICAgIGFkZExpc3RlbmVyKGRvY3VtZW50LCBFVkVOVF9QT0lOVEVSX01PVkUsIHRoaXMub25Qb2ludGVyTW92ZSA9IHRoaXMucG9pbnRlcm1vdmUuYmluZCh0aGlzKSk7XG4gICAgICBhZGRMaXN0ZW5lcihkb2N1bWVudCwgRVZFTlRfUE9JTlRFUl9VUCwgdGhpcy5vblBvaW50ZXJVcCA9IHRoaXMucG9pbnRlcnVwLmJpbmQodGhpcykpO1xuICAgICAgYWRkTGlzdGVuZXIoZG9jdW1lbnQsIEVWRU5UX0tFWV9ET1dOLCB0aGlzLm9uS2V5RG93biA9IHRoaXMua2V5ZG93bi5iaW5kKHRoaXMpKTtcbiAgICAgIGFkZExpc3RlbmVyKHdpbmRvdywgRVZFTlRfUkVTSVpFLCB0aGlzLm9uUmVzaXplID0gdGhpcy5yZXNpemUuYmluZCh0aGlzKSk7XG5cbiAgICAgIGlmIChvcHRpb25zLnpvb21hYmxlICYmIG9wdGlvbnMuem9vbU9uV2hlZWwpIHtcbiAgICAgICAgYWRkTGlzdGVuZXIodmlld2VyLCBFVkVOVF9XSEVFTCwgdGhpcy5vbldoZWVsID0gdGhpcy53aGVlbC5iaW5kKHRoaXMpLCB7XG4gICAgICAgICAgcGFzc2l2ZTogZmFsc2UsXG4gICAgICAgICAgY2FwdHVyZTogdHJ1ZVxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgaWYgKG9wdGlvbnMudG9nZ2xlT25EYmxjbGljaykge1xuICAgICAgICBhZGRMaXN0ZW5lcihjYW52YXMsIEVWRU5UX0RCTENMSUNLLCB0aGlzLm9uRGJsY2xpY2sgPSB0aGlzLmRibGNsaWNrLmJpbmQodGhpcykpO1xuICAgICAgfVxuICAgIH0sXG4gICAgdW5iaW5kOiBmdW5jdGlvbiB1bmJpbmQoKSB7XG4gICAgICB2YXIgb3B0aW9ucyA9IHRoaXMub3B0aW9ucyxcbiAgICAgICAgICB2aWV3ZXIgPSB0aGlzLnZpZXdlcixcbiAgICAgICAgICBjYW52YXMgPSB0aGlzLmNhbnZhcztcbiAgICAgIHZhciBkb2N1bWVudCA9IHRoaXMuZWxlbWVudC5vd25lckRvY3VtZW50O1xuICAgICAgcmVtb3ZlTGlzdGVuZXIodmlld2VyLCBFVkVOVF9DTElDSywgdGhpcy5vbkNsaWNrKTtcbiAgICAgIHJlbW92ZUxpc3RlbmVyKHZpZXdlciwgRVZFTlRfRFJBR19TVEFSVCwgdGhpcy5vbkRyYWdTdGFydCk7XG4gICAgICByZW1vdmVMaXN0ZW5lcihjYW52YXMsIEVWRU5UX1BPSU5URVJfRE9XTiwgdGhpcy5vblBvaW50ZXJEb3duKTtcbiAgICAgIHJlbW92ZUxpc3RlbmVyKGRvY3VtZW50LCBFVkVOVF9QT0lOVEVSX01PVkUsIHRoaXMub25Qb2ludGVyTW92ZSk7XG4gICAgICByZW1vdmVMaXN0ZW5lcihkb2N1bWVudCwgRVZFTlRfUE9JTlRFUl9VUCwgdGhpcy5vblBvaW50ZXJVcCk7XG4gICAgICByZW1vdmVMaXN0ZW5lcihkb2N1bWVudCwgRVZFTlRfS0VZX0RPV04sIHRoaXMub25LZXlEb3duKTtcbiAgICAgIHJlbW92ZUxpc3RlbmVyKHdpbmRvdywgRVZFTlRfUkVTSVpFLCB0aGlzLm9uUmVzaXplKTtcblxuICAgICAgaWYgKG9wdGlvbnMuem9vbWFibGUgJiYgb3B0aW9ucy56b29tT25XaGVlbCkge1xuICAgICAgICByZW1vdmVMaXN0ZW5lcih2aWV3ZXIsIEVWRU5UX1dIRUVMLCB0aGlzLm9uV2hlZWwsIHtcbiAgICAgICAgICBwYXNzaXZlOiBmYWxzZSxcbiAgICAgICAgICBjYXB0dXJlOiB0cnVlXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBpZiAob3B0aW9ucy50b2dnbGVPbkRibGNsaWNrKSB7XG4gICAgICAgIHJlbW92ZUxpc3RlbmVyKGNhbnZhcywgRVZFTlRfREJMQ0xJQ0ssIHRoaXMub25EYmxjbGljayk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIHZhciBoYW5kbGVycyA9IHtcbiAgICBjbGljazogZnVuY3Rpb24gY2xpY2soZXZlbnQpIHtcbiAgICAgIHZhciBvcHRpb25zID0gdGhpcy5vcHRpb25zLFxuICAgICAgICAgIGltYWdlRGF0YSA9IHRoaXMuaW1hZ2VEYXRhO1xuICAgICAgdmFyIHRhcmdldCA9IGV2ZW50LnRhcmdldDtcbiAgICAgIHZhciBhY3Rpb24gPSBnZXREYXRhKHRhcmdldCwgREFUQV9BQ1RJT04pO1xuXG4gICAgICBpZiAoIWFjdGlvbiAmJiB0YXJnZXQubG9jYWxOYW1lID09PSAnaW1nJyAmJiB0YXJnZXQucGFyZW50RWxlbWVudC5sb2NhbE5hbWUgPT09ICdsaScpIHtcbiAgICAgICAgdGFyZ2V0ID0gdGFyZ2V0LnBhcmVudEVsZW1lbnQ7XG4gICAgICAgIGFjdGlvbiA9IGdldERhdGEodGFyZ2V0LCBEQVRBX0FDVElPTik7XG4gICAgICB9IC8vIENhbmNlbCB0aGUgZW11bGF0ZWQgY2xpY2sgd2hlbiB0aGUgbmF0aXZlIGNsaWNrIGV2ZW50IHdhcyB0cmlnZ2VyZWQuXG5cblxuICAgICAgaWYgKElTX1RPVUNIX0RFVklDRSAmJiBldmVudC5pc1RydXN0ZWQgJiYgdGFyZ2V0ID09PSB0aGlzLmNhbnZhcykge1xuICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5jbGlja0NhbnZhc1RpbWVvdXQpO1xuICAgICAgfVxuXG4gICAgICBzd2l0Y2ggKGFjdGlvbikge1xuICAgICAgICBjYXNlICdtaXgnOlxuICAgICAgICAgIGlmICh0aGlzLnBsYXllZCkge1xuICAgICAgICAgICAgdGhpcy5zdG9wKCk7XG4gICAgICAgICAgfSBlbHNlIGlmIChvcHRpb25zLmlubGluZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuZnVsbGVkKSB7XG4gICAgICAgICAgICAgIHRoaXMuZXhpdCgpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdGhpcy5mdWxsKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuaGlkZSgpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgJ2hpZGUnOlxuICAgICAgICAgIHRoaXMuaGlkZSgpO1xuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgJ3ZpZXcnOlxuICAgICAgICAgIHRoaXMudmlldyhnZXREYXRhKHRhcmdldCwgJ2luZGV4JykpO1xuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgJ3pvb20taW4nOlxuICAgICAgICAgIHRoaXMuem9vbSgwLjEsIHRydWUpO1xuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgJ3pvb20tb3V0JzpcbiAgICAgICAgICB0aGlzLnpvb20oLTAuMSwgdHJ1ZSk7XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSAnb25lLXRvLW9uZSc6XG4gICAgICAgICAgdGhpcy50b2dnbGUoKTtcbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlICdyZXNldCc6XG4gICAgICAgICAgdGhpcy5yZXNldCgpO1xuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgJ3ByZXYnOlxuICAgICAgICAgIHRoaXMucHJldihvcHRpb25zLmxvb3ApO1xuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgJ3BsYXknOlxuICAgICAgICAgIHRoaXMucGxheShvcHRpb25zLmZ1bGxzY3JlZW4pO1xuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgJ25leHQnOlxuICAgICAgICAgIHRoaXMubmV4dChvcHRpb25zLmxvb3ApO1xuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgJ3JvdGF0ZS1sZWZ0JzpcbiAgICAgICAgICB0aGlzLnJvdGF0ZSgtOTApO1xuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgJ3JvdGF0ZS1yaWdodCc6XG4gICAgICAgICAgdGhpcy5yb3RhdGUoOTApO1xuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgJ2ZsaXAtaG9yaXpvbnRhbCc6XG4gICAgICAgICAgdGhpcy5zY2FsZVgoLWltYWdlRGF0YS5zY2FsZVggfHwgLTEpO1xuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgJ2ZsaXAtdmVydGljYWwnOlxuICAgICAgICAgIHRoaXMuc2NhbGVZKC1pbWFnZURhdGEuc2NhbGVZIHx8IC0xKTtcbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIGlmICh0aGlzLnBsYXllZCkge1xuICAgICAgICAgICAgdGhpcy5zdG9wKCk7XG4gICAgICAgICAgfVxuXG4gICAgICB9XG4gICAgfSxcbiAgICBkYmxjbGljazogZnVuY3Rpb24gZGJsY2xpY2soZXZlbnQpIHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgIGlmICh0aGlzLnZpZXdlZCAmJiBldmVudC50YXJnZXQgPT09IHRoaXMuaW1hZ2UpIHtcbiAgICAgICAgLy8gQ2FuY2VsIHRoZSBlbXVsYXRlZCBkb3VibGUgY2xpY2sgd2hlbiB0aGUgbmF0aXZlIGRibGNsaWNrIGV2ZW50IHdhcyB0cmlnZ2VyZWQuXG4gICAgICAgIGlmIChJU19UT1VDSF9ERVZJQ0UgJiYgZXZlbnQuaXNUcnVzdGVkKSB7XG4gICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuZG91YmxlQ2xpY2tJbWFnZVRpbWVvdXQpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy50b2dnbGUoKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIGxvYWQ6IGZ1bmN0aW9uIGxvYWQoKSB7XG4gICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgICBpZiAodGhpcy50aW1lb3V0KSB7XG4gICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVvdXQpO1xuICAgICAgICB0aGlzLnRpbWVvdXQgPSBmYWxzZTtcbiAgICAgIH1cblxuICAgICAgdmFyIGVsZW1lbnQgPSB0aGlzLmVsZW1lbnQsXG4gICAgICAgICAgb3B0aW9ucyA9IHRoaXMub3B0aW9ucyxcbiAgICAgICAgICBpbWFnZSA9IHRoaXMuaW1hZ2UsXG4gICAgICAgICAgaW5kZXggPSB0aGlzLmluZGV4LFxuICAgICAgICAgIHZpZXdlckRhdGEgPSB0aGlzLnZpZXdlckRhdGE7XG4gICAgICByZW1vdmVDbGFzcyhpbWFnZSwgQ0xBU1NfSU5WSVNJQkxFKTtcblxuICAgICAgaWYgKG9wdGlvbnMubG9hZGluZykge1xuICAgICAgICByZW1vdmVDbGFzcyh0aGlzLmNhbnZhcywgQ0xBU1NfTE9BRElORyk7XG4gICAgICB9XG5cbiAgICAgIGltYWdlLnN0eWxlLmNzc1RleHQgPSAnaGVpZ2h0OjA7JyArIFwibWFyZ2luLWxlZnQ6XCIuY29uY2F0KHZpZXdlckRhdGEud2lkdGggLyAyLCBcInB4O1wiKSArIFwibWFyZ2luLXRvcDpcIi5jb25jYXQodmlld2VyRGF0YS5oZWlnaHQgLyAyLCBcInB4O1wiKSArICdtYXgtd2lkdGg6bm9uZSFpbXBvcnRhbnQ7JyArICdwb3NpdGlvbjphYnNvbHV0ZTsnICsgJ3dpZHRoOjA7JztcbiAgICAgIHRoaXMuaW5pdEltYWdlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdG9nZ2xlQ2xhc3MoaW1hZ2UsIENMQVNTX01PVkUsIG9wdGlvbnMubW92YWJsZSk7XG4gICAgICAgIHRvZ2dsZUNsYXNzKGltYWdlLCBDTEFTU19UUkFOU0lUSU9OLCBvcHRpb25zLnRyYW5zaXRpb24pO1xuXG4gICAgICAgIF90aGlzLnJlbmRlckltYWdlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBfdGhpcy52aWV3ZWQgPSB0cnVlO1xuICAgICAgICAgIF90aGlzLnZpZXdpbmcgPSBmYWxzZTtcblxuICAgICAgICAgIGlmIChpc0Z1bmN0aW9uKG9wdGlvbnMudmlld2VkKSkge1xuICAgICAgICAgICAgYWRkTGlzdGVuZXIoZWxlbWVudCwgRVZFTlRfVklFV0VELCBvcHRpb25zLnZpZXdlZCwge1xuICAgICAgICAgICAgICBvbmNlOiB0cnVlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBkaXNwYXRjaEV2ZW50KGVsZW1lbnQsIEVWRU5UX1ZJRVdFRCwge1xuICAgICAgICAgICAgb3JpZ2luYWxJbWFnZTogX3RoaXMuaW1hZ2VzW2luZGV4XSxcbiAgICAgICAgICAgIGluZGV4OiBpbmRleCxcbiAgICAgICAgICAgIGltYWdlOiBpbWFnZVxuICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgIGNhbmNlbGFibGU6IGZhbHNlXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSxcbiAgICBsb2FkSW1hZ2U6IGZ1bmN0aW9uIGxvYWRJbWFnZShldmVudCkge1xuICAgICAgdmFyIGltYWdlID0gZXZlbnQudGFyZ2V0O1xuICAgICAgdmFyIHBhcmVudCA9IGltYWdlLnBhcmVudE5vZGU7XG4gICAgICB2YXIgcGFyZW50V2lkdGggPSBwYXJlbnQub2Zmc2V0V2lkdGggfHwgMzA7XG4gICAgICB2YXIgcGFyZW50SGVpZ2h0ID0gcGFyZW50Lm9mZnNldEhlaWdodCB8fCA1MDtcbiAgICAgIHZhciBmaWxsZWQgPSAhIWdldERhdGEoaW1hZ2UsICdmaWxsZWQnKTtcbiAgICAgIGdldEltYWdlTmF0dXJhbFNpemVzKGltYWdlLCB0aGlzLm9wdGlvbnMsIGZ1bmN0aW9uIChuYXR1cmFsV2lkdGgsIG5hdHVyYWxIZWlnaHQpIHtcbiAgICAgICAgdmFyIGFzcGVjdFJhdGlvID0gbmF0dXJhbFdpZHRoIC8gbmF0dXJhbEhlaWdodDtcbiAgICAgICAgdmFyIHdpZHRoID0gcGFyZW50V2lkdGg7XG4gICAgICAgIHZhciBoZWlnaHQgPSBwYXJlbnRIZWlnaHQ7XG5cbiAgICAgICAgaWYgKHBhcmVudEhlaWdodCAqIGFzcGVjdFJhdGlvID4gcGFyZW50V2lkdGgpIHtcbiAgICAgICAgICBpZiAoZmlsbGVkKSB7XG4gICAgICAgICAgICB3aWR0aCA9IHBhcmVudEhlaWdodCAqIGFzcGVjdFJhdGlvO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBoZWlnaHQgPSBwYXJlbnRXaWR0aCAvIGFzcGVjdFJhdGlvO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChmaWxsZWQpIHtcbiAgICAgICAgICBoZWlnaHQgPSBwYXJlbnRXaWR0aCAvIGFzcGVjdFJhdGlvO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHdpZHRoID0gcGFyZW50SGVpZ2h0ICogYXNwZWN0UmF0aW87XG4gICAgICAgIH1cblxuICAgICAgICBzZXRTdHlsZShpbWFnZSwgYXNzaWduKHtcbiAgICAgICAgICB3aWR0aDogd2lkdGgsXG4gICAgICAgICAgaGVpZ2h0OiBoZWlnaHRcbiAgICAgICAgfSwgZ2V0VHJhbnNmb3Jtcyh7XG4gICAgICAgICAgdHJhbnNsYXRlWDogKHBhcmVudFdpZHRoIC0gd2lkdGgpIC8gMixcbiAgICAgICAgICB0cmFuc2xhdGVZOiAocGFyZW50SGVpZ2h0IC0gaGVpZ2h0KSAvIDJcbiAgICAgICAgfSkpKTtcbiAgICAgIH0pO1xuICAgIH0sXG4gICAga2V5ZG93bjogZnVuY3Rpb24ga2V5ZG93bihldmVudCkge1xuICAgICAgdmFyIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnM7XG5cbiAgICAgIGlmICghb3B0aW9ucy5rZXlib2FyZCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHZhciBrZXlDb2RlID0gZXZlbnQua2V5Q29kZSB8fCBldmVudC53aGljaCB8fCBldmVudC5jaGFyQ29kZTtcblxuICAgICAgc3dpdGNoIChrZXlDb2RlKSB7XG4gICAgICAgIC8vIEVudGVyXG4gICAgICAgIGNhc2UgMTM6XG4gICAgICAgICAgaWYgKHRoaXMudmlld2VyLmNvbnRhaW5zKGV2ZW50LnRhcmdldCkpIHtcbiAgICAgICAgICAgIHRoaXMuY2xpY2soZXZlbnQpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGJyZWFrO1xuICAgICAgfVxuXG4gICAgICBpZiAoIXRoaXMuZnVsbGVkKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgc3dpdGNoIChrZXlDb2RlKSB7XG4gICAgICAgIC8vIEVzY2FwZVxuICAgICAgICBjYXNlIDI3OlxuICAgICAgICAgIGlmICh0aGlzLnBsYXllZCkge1xuICAgICAgICAgICAgdGhpcy5zdG9wKCk7XG4gICAgICAgICAgfSBlbHNlIGlmIChvcHRpb25zLmlubGluZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuZnVsbGVkKSB7XG4gICAgICAgICAgICAgIHRoaXMuZXhpdCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmhpZGUoKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBicmVhaztcbiAgICAgICAgLy8gU3BhY2VcblxuICAgICAgICBjYXNlIDMyOlxuICAgICAgICAgIGlmICh0aGlzLnBsYXllZCkge1xuICAgICAgICAgICAgdGhpcy5zdG9wKCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIC8vIEFycm93TGVmdFxuXG4gICAgICAgIGNhc2UgMzc6XG4gICAgICAgICAgdGhpcy5wcmV2KG9wdGlvbnMubG9vcCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIC8vIEFycm93VXBcblxuICAgICAgICBjYXNlIDM4OlxuICAgICAgICAgIC8vIFByZXZlbnQgc2Nyb2xsIG9uIEZpcmVmb3hcbiAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOyAvLyBab29tIGluXG5cbiAgICAgICAgICB0aGlzLnpvb20ob3B0aW9ucy56b29tUmF0aW8sIHRydWUpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICAvLyBBcnJvd1JpZ2h0XG5cbiAgICAgICAgY2FzZSAzOTpcbiAgICAgICAgICB0aGlzLm5leHQob3B0aW9ucy5sb29wKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgLy8gQXJyb3dEb3duXG5cbiAgICAgICAgY2FzZSA0MDpcbiAgICAgICAgICAvLyBQcmV2ZW50IHNjcm9sbCBvbiBGaXJlZm94XG4gICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsgLy8gWm9vbSBvdXRcblxuICAgICAgICAgIHRoaXMuem9vbSgtb3B0aW9ucy56b29tUmF0aW8sIHRydWUpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICAvLyBDdHJsICsgMFxuXG4gICAgICAgIGNhc2UgNDg6IC8vIEZhbGwgdGhyb3VnaFxuICAgICAgICAvLyBDdHJsICsgMVxuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tZmFsbHRocm91Z2hcblxuICAgICAgICBjYXNlIDQ5OlxuICAgICAgICAgIGlmIChldmVudC5jdHJsS2V5KSB7XG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgdGhpcy50b2dnbGUoKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9LFxuICAgIGRyYWdzdGFydDogZnVuY3Rpb24gZHJhZ3N0YXJ0KGV2ZW50KSB7XG4gICAgICBpZiAoZXZlbnQudGFyZ2V0LmxvY2FsTmFtZSA9PT0gJ2ltZycpIHtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIHBvaW50ZXJkb3duOiBmdW5jdGlvbiBwb2ludGVyZG93bihldmVudCkge1xuICAgICAgdmFyIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnMsXG4gICAgICAgICAgcG9pbnRlcnMgPSB0aGlzLnBvaW50ZXJzO1xuICAgICAgdmFyIGJ1dHRvbnMgPSBldmVudC5idXR0b25zLFxuICAgICAgICAgIGJ1dHRvbiA9IGV2ZW50LmJ1dHRvbjtcblxuICAgICAgaWYgKCF0aGlzLnZpZXdlZCB8fCB0aGlzLnNob3dpbmcgfHwgdGhpcy52aWV3aW5nIHx8IHRoaXMuaGlkaW5nIC8vIEhhbmRsZSBtb3VzZSBldmVudCBhbmQgcG9pbnRlciBldmVudCBhbmQgaWdub3JlIHRvdWNoIGV2ZW50XG4gICAgICB8fCAoZXZlbnQudHlwZSA9PT0gJ21vdXNlZG93bicgfHwgZXZlbnQudHlwZSA9PT0gJ3BvaW50ZXJkb3duJyAmJiBldmVudC5wb2ludGVyVHlwZSA9PT0gJ21vdXNlJykgJiYgKCAvLyBObyBwcmltYXJ5IGJ1dHRvbiAoVXN1YWxseSB0aGUgbGVmdCBidXR0b24pXG4gICAgICBpc051bWJlcihidXR0b25zKSAmJiBidXR0b25zICE9PSAxIHx8IGlzTnVtYmVyKGJ1dHRvbikgJiYgYnV0dG9uICE9PSAwIC8vIE9wZW4gY29udGV4dCBtZW51XG4gICAgICB8fCBldmVudC5jdHJsS2V5KSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9IC8vIFByZXZlbnQgZGVmYXVsdCBiZWhhdmlvdXJzIGFzIHBhZ2Ugem9vbWluZyBpbiB0b3VjaCBkZXZpY2VzLlxuXG5cbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgIGlmIChldmVudC5jaGFuZ2VkVG91Y2hlcykge1xuICAgICAgICBmb3JFYWNoKGV2ZW50LmNoYW5nZWRUb3VjaGVzLCBmdW5jdGlvbiAodG91Y2gpIHtcbiAgICAgICAgICBwb2ludGVyc1t0b3VjaC5pZGVudGlmaWVyXSA9IGdldFBvaW50ZXIodG91Y2gpO1xuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHBvaW50ZXJzW2V2ZW50LnBvaW50ZXJJZCB8fCAwXSA9IGdldFBvaW50ZXIoZXZlbnQpO1xuICAgICAgfVxuXG4gICAgICB2YXIgYWN0aW9uID0gb3B0aW9ucy5tb3ZhYmxlID8gQUNUSU9OX01PVkUgOiBmYWxzZTtcblxuICAgICAgaWYgKG9wdGlvbnMuem9vbU9uVG91Y2ggJiYgb3B0aW9ucy56b29tYWJsZSAmJiBPYmplY3Qua2V5cyhwb2ludGVycykubGVuZ3RoID4gMSkge1xuICAgICAgICBhY3Rpb24gPSBBQ1RJT05fWk9PTTtcbiAgICAgIH0gZWxzZSBpZiAob3B0aW9ucy5zbGlkZU9uVG91Y2ggJiYgKGV2ZW50LnBvaW50ZXJUeXBlID09PSAndG91Y2gnIHx8IGV2ZW50LnR5cGUgPT09ICd0b3VjaHN0YXJ0JykgJiYgdGhpcy5pc1N3aXRjaGFibGUoKSkge1xuICAgICAgICBhY3Rpb24gPSBBQ1RJT05fU1dJVENIO1xuICAgICAgfVxuXG4gICAgICBpZiAob3B0aW9ucy50cmFuc2l0aW9uICYmIChhY3Rpb24gPT09IEFDVElPTl9NT1ZFIHx8IGFjdGlvbiA9PT0gQUNUSU9OX1pPT00pKSB7XG4gICAgICAgIHJlbW92ZUNsYXNzKHRoaXMuaW1hZ2UsIENMQVNTX1RSQU5TSVRJT04pO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmFjdGlvbiA9IGFjdGlvbjtcbiAgICB9LFxuICAgIHBvaW50ZXJtb3ZlOiBmdW5jdGlvbiBwb2ludGVybW92ZShldmVudCkge1xuICAgICAgdmFyIHBvaW50ZXJzID0gdGhpcy5wb2ludGVycyxcbiAgICAgICAgICBhY3Rpb24gPSB0aGlzLmFjdGlvbjtcblxuICAgICAgaWYgKCF0aGlzLnZpZXdlZCB8fCAhYWN0aW9uKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgaWYgKGV2ZW50LmNoYW5nZWRUb3VjaGVzKSB7XG4gICAgICAgIGZvckVhY2goZXZlbnQuY2hhbmdlZFRvdWNoZXMsIGZ1bmN0aW9uICh0b3VjaCkge1xuICAgICAgICAgIGFzc2lnbihwb2ludGVyc1t0b3VjaC5pZGVudGlmaWVyXSB8fCB7fSwgZ2V0UG9pbnRlcih0b3VjaCwgdHJ1ZSkpO1xuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGFzc2lnbihwb2ludGVyc1tldmVudC5wb2ludGVySWQgfHwgMF0gfHwge30sIGdldFBvaW50ZXIoZXZlbnQsIHRydWUpKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5jaGFuZ2UoZXZlbnQpO1xuICAgIH0sXG4gICAgcG9pbnRlcnVwOiBmdW5jdGlvbiBwb2ludGVydXAoZXZlbnQpIHtcbiAgICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gICAgICB2YXIgb3B0aW9ucyA9IHRoaXMub3B0aW9ucyxcbiAgICAgICAgICBhY3Rpb24gPSB0aGlzLmFjdGlvbixcbiAgICAgICAgICBwb2ludGVycyA9IHRoaXMucG9pbnRlcnM7XG4gICAgICB2YXIgcG9pbnRlcjtcblxuICAgICAgaWYgKGV2ZW50LmNoYW5nZWRUb3VjaGVzKSB7XG4gICAgICAgIGZvckVhY2goZXZlbnQuY2hhbmdlZFRvdWNoZXMsIGZ1bmN0aW9uICh0b3VjaCkge1xuICAgICAgICAgIHBvaW50ZXIgPSBwb2ludGVyc1t0b3VjaC5pZGVudGlmaWVyXTtcbiAgICAgICAgICBkZWxldGUgcG9pbnRlcnNbdG91Y2guaWRlbnRpZmllcl07XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcG9pbnRlciA9IHBvaW50ZXJzW2V2ZW50LnBvaW50ZXJJZCB8fCAwXTtcbiAgICAgICAgZGVsZXRlIHBvaW50ZXJzW2V2ZW50LnBvaW50ZXJJZCB8fCAwXTtcbiAgICAgIH1cblxuICAgICAgaWYgKCFhY3Rpb24pIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICBpZiAob3B0aW9ucy50cmFuc2l0aW9uICYmIChhY3Rpb24gPT09IEFDVElPTl9NT1ZFIHx8IGFjdGlvbiA9PT0gQUNUSU9OX1pPT00pKSB7XG4gICAgICAgIGFkZENsYXNzKHRoaXMuaW1hZ2UsIENMQVNTX1RSQU5TSVRJT04pO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmFjdGlvbiA9IGZhbHNlOyAvLyBFbXVsYXRlIGNsaWNrIGFuZCBkb3VibGUgY2xpY2sgaW4gdG91Y2ggZGV2aWNlcyB0byBzdXBwb3J0IGJhY2tkcm9wIGFuZCBpbWFnZSB6b29taW5nICgjMjEwKS5cblxuICAgICAgaWYgKElTX1RPVUNIX0RFVklDRSAmJiBhY3Rpb24gIT09IEFDVElPTl9aT09NICYmIHBvaW50ZXIgJiYgRGF0ZS5ub3coKSAtIHBvaW50ZXIudGltZVN0YW1wIDwgNTAwKSB7XG4gICAgICAgIGNsZWFyVGltZW91dCh0aGlzLmNsaWNrQ2FudmFzVGltZW91dCk7XG4gICAgICAgIGNsZWFyVGltZW91dCh0aGlzLmRvdWJsZUNsaWNrSW1hZ2VUaW1lb3V0KTtcblxuICAgICAgICBpZiAob3B0aW9ucy50b2dnbGVPbkRibGNsaWNrICYmIHRoaXMudmlld2VkICYmIGV2ZW50LnRhcmdldCA9PT0gdGhpcy5pbWFnZSkge1xuICAgICAgICAgIGlmICh0aGlzLmltYWdlQ2xpY2tlZCkge1xuICAgICAgICAgICAgdGhpcy5pbWFnZUNsaWNrZWQgPSBmYWxzZTsgLy8gVGhpcyB0aW1lb3V0IHdpbGwgYmUgY2xlYXJlZCBsYXRlciB3aGVuIGEgbmF0aXZlIGRibGNsaWNrIGV2ZW50IGlzIHRyaWdnZXJpbmdcblxuICAgICAgICAgICAgdGhpcy5kb3VibGVDbGlja0ltYWdlVGltZW91dCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICBkaXNwYXRjaEV2ZW50KF90aGlzMi5pbWFnZSwgRVZFTlRfREJMQ0xJQ0spO1xuICAgICAgICAgICAgfSwgNTApO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmltYWdlQ2xpY2tlZCA9IHRydWU7IC8vIFRoZSBkZWZhdWx0IHRpbWluZyBvZiBhIGRvdWJsZSBjbGljayBpbiBXaW5kb3dzIGlzIDUwMCBtc1xuXG4gICAgICAgICAgICB0aGlzLmRvdWJsZUNsaWNrSW1hZ2VUaW1lb3V0ID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgIF90aGlzMi5pbWFnZUNsaWNrZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIH0sIDUwMCk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMuaW1hZ2VDbGlja2VkID0gZmFsc2U7XG5cbiAgICAgICAgICBpZiAob3B0aW9ucy5iYWNrZHJvcCAmJiBvcHRpb25zLmJhY2tkcm9wICE9PSAnc3RhdGljJyAmJiBldmVudC50YXJnZXQgPT09IHRoaXMuY2FudmFzKSB7XG4gICAgICAgICAgICAvLyBUaGlzIHRpbWVvdXQgd2lsbCBiZSBjbGVhcmVkIGxhdGVyIHdoZW4gYSBuYXRpdmUgY2xpY2sgZXZlbnQgaXMgdHJpZ2dlcmluZ1xuICAgICAgICAgICAgdGhpcy5jbGlja0NhbnZhc1RpbWVvdXQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgZGlzcGF0Y2hFdmVudChfdGhpczIuY2FudmFzLCBFVkVOVF9DTElDSyk7XG4gICAgICAgICAgICB9LCA1MCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcbiAgICByZXNpemU6IGZ1bmN0aW9uIHJlc2l6ZSgpIHtcbiAgICAgIHZhciBfdGhpczMgPSB0aGlzO1xuXG4gICAgICBpZiAoIXRoaXMuaXNTaG93biB8fCB0aGlzLmhpZGluZykge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLmZ1bGxlZCkge1xuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIHRoaXMuaW5pdEJvZHkoKTtcbiAgICAgICAgdGhpcy5vcGVuKCk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuaW5pdENvbnRhaW5lcigpO1xuICAgICAgdGhpcy5pbml0Vmlld2VyKCk7XG4gICAgICB0aGlzLnJlbmRlclZpZXdlcigpO1xuICAgICAgdGhpcy5yZW5kZXJMaXN0KCk7XG5cbiAgICAgIGlmICh0aGlzLnZpZXdlZCkge1xuICAgICAgICB0aGlzLmluaXRJbWFnZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgX3RoaXMzLnJlbmRlckltYWdlKCk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy5wbGF5ZWQpIHtcbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5mdWxsc2NyZWVuICYmIHRoaXMuZnVsbGVkICYmICEoZG9jdW1lbnQuZnVsbHNjcmVlbkVsZW1lbnQgfHwgZG9jdW1lbnQud2Via2l0RnVsbHNjcmVlbkVsZW1lbnQgfHwgZG9jdW1lbnQubW96RnVsbFNjcmVlbkVsZW1lbnQgfHwgZG9jdW1lbnQubXNGdWxsc2NyZWVuRWxlbWVudCkpIHtcbiAgICAgICAgICB0aGlzLnN0b3AoKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBmb3JFYWNoKHRoaXMucGxheWVyLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdpbWcnKSwgZnVuY3Rpb24gKGltYWdlKSB7XG4gICAgICAgICAgYWRkTGlzdGVuZXIoaW1hZ2UsIEVWRU5UX0xPQUQsIF90aGlzMy5sb2FkSW1hZ2UuYmluZChfdGhpczMpLCB7XG4gICAgICAgICAgICBvbmNlOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZGlzcGF0Y2hFdmVudChpbWFnZSwgRVZFTlRfTE9BRCk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0sXG4gICAgd2hlZWw6IGZ1bmN0aW9uIHdoZWVsKGV2ZW50KSB7XG4gICAgICB2YXIgX3RoaXM0ID0gdGhpcztcblxuICAgICAgaWYgKCF0aGlzLnZpZXdlZCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7IC8vIExpbWl0IHdoZWVsIHNwZWVkIHRvIHByZXZlbnQgem9vbSB0b28gZmFzdFxuXG4gICAgICBpZiAodGhpcy53aGVlbGluZykge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHRoaXMud2hlZWxpbmcgPSB0cnVlO1xuICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgIF90aGlzNC53aGVlbGluZyA9IGZhbHNlO1xuICAgICAgfSwgNTApO1xuICAgICAgdmFyIHJhdGlvID0gTnVtYmVyKHRoaXMub3B0aW9ucy56b29tUmF0aW8pIHx8IDAuMTtcbiAgICAgIHZhciBkZWx0YSA9IDE7XG5cbiAgICAgIGlmIChldmVudC5kZWx0YVkpIHtcbiAgICAgICAgZGVsdGEgPSBldmVudC5kZWx0YVkgPiAwID8gMSA6IC0xO1xuICAgICAgfSBlbHNlIGlmIChldmVudC53aGVlbERlbHRhKSB7XG4gICAgICAgIGRlbHRhID0gLWV2ZW50LndoZWVsRGVsdGEgLyAxMjA7XG4gICAgICB9IGVsc2UgaWYgKGV2ZW50LmRldGFpbCkge1xuICAgICAgICBkZWx0YSA9IGV2ZW50LmRldGFpbCA+IDAgPyAxIDogLTE7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuem9vbSgtZGVsdGEgKiByYXRpbywgdHJ1ZSwgZXZlbnQpO1xuICAgIH1cbiAgfTtcblxuICB2YXIgbWV0aG9kcyA9IHtcbiAgICAvKiogU2hvdyB0aGUgdmlld2VyIChvbmx5IGF2YWlsYWJsZSBpbiBtb2RhbCBtb2RlKVxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2ltbWVkaWF0ZT1mYWxzZV0gLSBJbmRpY2F0ZXMgaWYgc2hvdyB0aGUgdmlld2VyIGltbWVkaWF0ZWx5IG9yIG5vdC5cbiAgICAgKiBAcmV0dXJucyB7Vmlld2VyfSB0aGlzXG4gICAgICovXG4gICAgc2hvdzogZnVuY3Rpb24gc2hvdygpIHtcbiAgICAgIHZhciBpbW1lZGlhdGUgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IGZhbHNlO1xuICAgICAgdmFyIGVsZW1lbnQgPSB0aGlzLmVsZW1lbnQsXG4gICAgICAgICAgb3B0aW9ucyA9IHRoaXMub3B0aW9ucztcblxuICAgICAgaWYgKG9wdGlvbnMuaW5saW5lIHx8IHRoaXMuc2hvd2luZyB8fCB0aGlzLmlzU2hvd24gfHwgdGhpcy5zaG93aW5nKSB7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfVxuXG4gICAgICBpZiAoIXRoaXMucmVhZHkpIHtcbiAgICAgICAgdGhpcy5idWlsZCgpO1xuXG4gICAgICAgIGlmICh0aGlzLnJlYWR5KSB7XG4gICAgICAgICAgdGhpcy5zaG93KGltbWVkaWF0ZSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH1cblxuICAgICAgaWYgKGlzRnVuY3Rpb24ob3B0aW9ucy5zaG93KSkge1xuICAgICAgICBhZGRMaXN0ZW5lcihlbGVtZW50LCBFVkVOVF9TSE9XLCBvcHRpb25zLnNob3csIHtcbiAgICAgICAgICBvbmNlOiB0cnVlXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBpZiAoZGlzcGF0Y2hFdmVudChlbGVtZW50LCBFVkVOVF9TSE9XKSA9PT0gZmFsc2UgfHwgIXRoaXMucmVhZHkpIHtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLmhpZGluZykge1xuICAgICAgICB0aGlzLnRyYW5zaXRpb25pbmcuYWJvcnQoKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5zaG93aW5nID0gdHJ1ZTtcbiAgICAgIHRoaXMub3BlbigpO1xuICAgICAgdmFyIHZpZXdlciA9IHRoaXMudmlld2VyO1xuICAgICAgcmVtb3ZlQ2xhc3Modmlld2VyLCBDTEFTU19ISURFKTtcbiAgICAgIHZpZXdlci5zZXRBdHRyaWJ1dGUoJ3JvbGUnLCAnZGlhbG9nJyk7XG4gICAgICB2aWV3ZXIuc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsbGVkYnknLCB0aGlzLnRpdGxlLmlkKTtcbiAgICAgIHZpZXdlci5zZXRBdHRyaWJ1dGUoJ2FyaWEtbW9kYWwnLCB0cnVlKTtcbiAgICAgIHZpZXdlci5yZW1vdmVBdHRyaWJ1dGUoJ2FyaWEtaGlkZGVuJyk7XG5cbiAgICAgIGlmIChvcHRpb25zLnRyYW5zaXRpb24gJiYgIWltbWVkaWF0ZSkge1xuICAgICAgICB2YXIgc2hvd24gPSB0aGlzLnNob3duLmJpbmQodGhpcyk7XG4gICAgICAgIHRoaXMudHJhbnNpdGlvbmluZyA9IHtcbiAgICAgICAgICBhYm9ydDogZnVuY3Rpb24gYWJvcnQoKSB7XG4gICAgICAgICAgICByZW1vdmVMaXN0ZW5lcih2aWV3ZXIsIEVWRU5UX1RSQU5TSVRJT05fRU5ELCBzaG93bik7XG4gICAgICAgICAgICByZW1vdmVDbGFzcyh2aWV3ZXIsIENMQVNTX0lOKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGFkZENsYXNzKHZpZXdlciwgQ0xBU1NfVFJBTlNJVElPTik7IC8vIEZvcmNlIHJlZmxvdyB0byBlbmFibGUgQ1NTMyB0cmFuc2l0aW9uXG5cbiAgICAgICAgdmlld2VyLmluaXRpYWxPZmZzZXRXaWR0aCA9IHZpZXdlci5vZmZzZXRXaWR0aDtcbiAgICAgICAgYWRkTGlzdGVuZXIodmlld2VyLCBFVkVOVF9UUkFOU0lUSU9OX0VORCwgc2hvd24sIHtcbiAgICAgICAgICBvbmNlOiB0cnVlXG4gICAgICAgIH0pO1xuICAgICAgICBhZGRDbGFzcyh2aWV3ZXIsIENMQVNTX0lOKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGFkZENsYXNzKHZpZXdlciwgQ0xBU1NfSU4pO1xuICAgICAgICB0aGlzLnNob3duKCk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBIaWRlIHRoZSB2aWV3ZXIgKG9ubHkgYXZhaWxhYmxlIGluIG1vZGFsIG1vZGUpXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbaW1tZWRpYXRlPWZhbHNlXSAtIEluZGljYXRlcyBpZiBoaWRlIHRoZSB2aWV3ZXIgaW1tZWRpYXRlbHkgb3Igbm90LlxuICAgICAqIEByZXR1cm5zIHtWaWV3ZXJ9IHRoaXNcbiAgICAgKi9cbiAgICBoaWRlOiBmdW5jdGlvbiBoaWRlKCkge1xuICAgICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgICAgdmFyIGltbWVkaWF0ZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogZmFsc2U7XG4gICAgICB2YXIgZWxlbWVudCA9IHRoaXMuZWxlbWVudCxcbiAgICAgICAgICBvcHRpb25zID0gdGhpcy5vcHRpb25zO1xuXG4gICAgICBpZiAob3B0aW9ucy5pbmxpbmUgfHwgdGhpcy5oaWRpbmcgfHwgISh0aGlzLmlzU2hvd24gfHwgdGhpcy5zaG93aW5nKSkge1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH1cblxuICAgICAgaWYgKGlzRnVuY3Rpb24ob3B0aW9ucy5oaWRlKSkge1xuICAgICAgICBhZGRMaXN0ZW5lcihlbGVtZW50LCBFVkVOVF9ISURFLCBvcHRpb25zLmhpZGUsIHtcbiAgICAgICAgICBvbmNlOiB0cnVlXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBpZiAoZGlzcGF0Y2hFdmVudChlbGVtZW50LCBFVkVOVF9ISURFKSA9PT0gZmFsc2UpIHtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLnNob3dpbmcpIHtcbiAgICAgICAgdGhpcy50cmFuc2l0aW9uaW5nLmFib3J0KCk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuaGlkaW5nID0gdHJ1ZTtcblxuICAgICAgaWYgKHRoaXMucGxheWVkKSB7XG4gICAgICAgIHRoaXMuc3RvcCgpO1xuICAgICAgfSBlbHNlIGlmICh0aGlzLnZpZXdpbmcpIHtcbiAgICAgICAgdGhpcy52aWV3aW5nLmFib3J0KCk7XG4gICAgICB9XG5cbiAgICAgIHZhciB2aWV3ZXIgPSB0aGlzLnZpZXdlcixcbiAgICAgICAgICBpbWFnZSA9IHRoaXMuaW1hZ2U7XG5cbiAgICAgIHZhciBoaWRlSW1tZWRpYXRlbHkgPSBmdW5jdGlvbiBoaWRlSW1tZWRpYXRlbHkoKSB7XG4gICAgICAgIHJlbW92ZUNsYXNzKHZpZXdlciwgQ0xBU1NfSU4pO1xuXG4gICAgICAgIF90aGlzLmhpZGRlbigpO1xuICAgICAgfTtcblxuICAgICAgaWYgKG9wdGlvbnMudHJhbnNpdGlvbiAmJiAhaW1tZWRpYXRlKSB7XG4gICAgICAgIHZhciBvblZpZXdlclRyYW5zaXRpb25FbmQgPSBmdW5jdGlvbiBvblZpZXdlclRyYW5zaXRpb25FbmQoZXZlbnQpIHtcbiAgICAgICAgICAvLyBJZ25vcmUgYWxsIHByb3BhZ2F0aW5nIGB0cmFuc2l0aW9uZW5kYCBldmVudHMgKCMyNzUpLlxuICAgICAgICAgIGlmIChldmVudCAmJiBldmVudC50YXJnZXQgPT09IHZpZXdlcikge1xuICAgICAgICAgICAgcmVtb3ZlTGlzdGVuZXIodmlld2VyLCBFVkVOVF9UUkFOU0lUSU9OX0VORCwgb25WaWV3ZXJUcmFuc2l0aW9uRW5kKTtcblxuICAgICAgICAgICAgX3RoaXMuaGlkZGVuKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBvbkltYWdlVHJhbnNpdGlvbkVuZCA9IGZ1bmN0aW9uIG9uSW1hZ2VUcmFuc2l0aW9uRW5kKCkge1xuICAgICAgICAgIC8vIEluIGNhc2Ugb2Ygc2hvdyB0aGUgdmlld2VyIGJ5IGB2aWV3ZXIuc2hvdyh0cnVlKWAgcHJldmlvdXNseSAoIzQwNykuXG4gICAgICAgICAgaWYgKGhhc0NsYXNzKHZpZXdlciwgQ0xBU1NfVFJBTlNJVElPTikpIHtcbiAgICAgICAgICAgIGFkZExpc3RlbmVyKHZpZXdlciwgRVZFTlRfVFJBTlNJVElPTl9FTkQsIG9uVmlld2VyVHJhbnNpdGlvbkVuZCk7XG4gICAgICAgICAgICByZW1vdmVDbGFzcyh2aWV3ZXIsIENMQVNTX0lOKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaGlkZUltbWVkaWF0ZWx5KCk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIHRoaXMudHJhbnNpdGlvbmluZyA9IHtcbiAgICAgICAgICBhYm9ydDogZnVuY3Rpb24gYWJvcnQoKSB7XG4gICAgICAgICAgICBpZiAoX3RoaXMudmlld2VkICYmIGhhc0NsYXNzKGltYWdlLCBDTEFTU19UUkFOU0lUSU9OKSkge1xuICAgICAgICAgICAgICByZW1vdmVMaXN0ZW5lcihpbWFnZSwgRVZFTlRfVFJBTlNJVElPTl9FTkQsIG9uSW1hZ2VUcmFuc2l0aW9uRW5kKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaGFzQ2xhc3Modmlld2VyLCBDTEFTU19UUkFOU0lUSU9OKSkge1xuICAgICAgICAgICAgICByZW1vdmVMaXN0ZW5lcih2aWV3ZXIsIEVWRU5UX1RSQU5TSVRJT05fRU5ELCBvblZpZXdlclRyYW5zaXRpb25FbmQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfTsgLy8gSW4gY2FzZSBvZiBoaWRpbmcgdGhlIHZpZXdlciB3aGVuIGhvbGRpbmcgb24gdGhlIGltYWdlICgjMjU1KSxcbiAgICAgICAgLy8gbm90ZSB0aGF0IHRoZSBgQ0xBU1NfVFJBTlNJVElPTmAgY2xhc3Mgd2lsbCBiZSByZW1vdmVkIG9uIHBvaW50ZXIgZG93bi5cblxuICAgICAgICBpZiAodGhpcy52aWV3ZWQgJiYgaGFzQ2xhc3MoaW1hZ2UsIENMQVNTX1RSQU5TSVRJT04pKSB7XG4gICAgICAgICAgYWRkTGlzdGVuZXIoaW1hZ2UsIEVWRU5UX1RSQU5TSVRJT05fRU5ELCBvbkltYWdlVHJhbnNpdGlvbkVuZCwge1xuICAgICAgICAgICAgb25jZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIHRoaXMuem9vbVRvKDAsIGZhbHNlLCBmYWxzZSwgdHJ1ZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgb25JbWFnZVRyYW5zaXRpb25FbmQoKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaGlkZUltbWVkaWF0ZWx5KCk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBWaWV3IG9uZSBvZiB0aGUgaW1hZ2VzIHdpdGggaW1hZ2UncyBpbmRleFxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBpbmRleCAtIFRoZSBpbmRleCBvZiB0aGUgaW1hZ2UgdG8gdmlldy5cbiAgICAgKiBAcmV0dXJucyB7Vmlld2VyfSB0aGlzXG4gICAgICovXG4gICAgdmlldzogZnVuY3Rpb24gdmlldygpIHtcbiAgICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gICAgICB2YXIgaW5kZXggPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHRoaXMub3B0aW9ucy5pbml0aWFsVmlld0luZGV4O1xuICAgICAgaW5kZXggPSBOdW1iZXIoaW5kZXgpIHx8IDA7XG5cbiAgICAgIGlmICh0aGlzLmhpZGluZyB8fCB0aGlzLnBsYXllZCB8fCBpbmRleCA8IDAgfHwgaW5kZXggPj0gdGhpcy5sZW5ndGggfHwgdGhpcy52aWV3ZWQgJiYgaW5kZXggPT09IHRoaXMuaW5kZXgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9XG5cbiAgICAgIGlmICghdGhpcy5pc1Nob3duKSB7XG4gICAgICAgIHRoaXMuaW5kZXggPSBpbmRleDtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2hvdygpO1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy52aWV3aW5nKSB7XG4gICAgICAgIHRoaXMudmlld2luZy5hYm9ydCgpO1xuICAgICAgfVxuXG4gICAgICB2YXIgZWxlbWVudCA9IHRoaXMuZWxlbWVudCxcbiAgICAgICAgICBvcHRpb25zID0gdGhpcy5vcHRpb25zLFxuICAgICAgICAgIHRpdGxlID0gdGhpcy50aXRsZSxcbiAgICAgICAgICBjYW52YXMgPSB0aGlzLmNhbnZhcztcbiAgICAgIHZhciBpdGVtID0gdGhpcy5pdGVtc1tpbmRleF07XG4gICAgICB2YXIgaW1nID0gaXRlbS5xdWVyeVNlbGVjdG9yKCdpbWcnKTtcbiAgICAgIHZhciB1cmwgPSBnZXREYXRhKGltZywgJ29yaWdpbmFsVXJsJyk7XG4gICAgICB2YXIgYWx0ID0gaW1nLmdldEF0dHJpYnV0ZSgnYWx0Jyk7XG4gICAgICB2YXIgaW1hZ2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKTtcbiAgICAgIGZvckVhY2gob3B0aW9ucy5pbmhlcml0ZWRBdHRyaWJ1dGVzLCBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICB2YXIgdmFsdWUgPSBpbWcuZ2V0QXR0cmlidXRlKG5hbWUpO1xuXG4gICAgICAgIGlmICh2YWx1ZSAhPT0gbnVsbCkge1xuICAgICAgICAgIGltYWdlLnNldEF0dHJpYnV0ZShuYW1lLCB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgaW1hZ2Uuc3JjID0gdXJsO1xuICAgICAgaW1hZ2UuYWx0ID0gYWx0O1xuXG4gICAgICBpZiAoaXNGdW5jdGlvbihvcHRpb25zLnZpZXcpKSB7XG4gICAgICAgIGFkZExpc3RlbmVyKGVsZW1lbnQsIEVWRU5UX1ZJRVcsIG9wdGlvbnMudmlldywge1xuICAgICAgICAgIG9uY2U6IHRydWVcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChkaXNwYXRjaEV2ZW50KGVsZW1lbnQsIEVWRU5UX1ZJRVcsIHtcbiAgICAgICAgb3JpZ2luYWxJbWFnZTogdGhpcy5pbWFnZXNbaW5kZXhdLFxuICAgICAgICBpbmRleDogaW5kZXgsXG4gICAgICAgIGltYWdlOiBpbWFnZVxuICAgICAgfSkgPT09IGZhbHNlIHx8ICF0aGlzLmlzU2hvd24gfHwgdGhpcy5oaWRpbmcgfHwgdGhpcy5wbGF5ZWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9XG5cbiAgICAgIHZhciBhY3RpdmVJdGVtID0gdGhpcy5pdGVtc1t0aGlzLmluZGV4XTtcbiAgICAgIHJlbW92ZUNsYXNzKGFjdGl2ZUl0ZW0sIENMQVNTX0FDVElWRSk7XG4gICAgICBhY3RpdmVJdGVtLnJlbW92ZUF0dHJpYnV0ZSgnYXJpYS1zZWxlY3RlZCcpO1xuICAgICAgYWRkQ2xhc3MoaXRlbSwgQ0xBU1NfQUNUSVZFKTtcbiAgICAgIGl0ZW0uc2V0QXR0cmlidXRlKCdhcmlhLXNlbGVjdGVkJywgdHJ1ZSk7XG5cbiAgICAgIGlmIChvcHRpb25zLmZvY3VzKSB7XG4gICAgICAgIGl0ZW0uZm9jdXMoKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5pbWFnZSA9IGltYWdlO1xuICAgICAgdGhpcy52aWV3ZWQgPSBmYWxzZTtcbiAgICAgIHRoaXMuaW5kZXggPSBpbmRleDtcbiAgICAgIHRoaXMuaW1hZ2VEYXRhID0ge307XG4gICAgICBhZGRDbGFzcyhpbWFnZSwgQ0xBU1NfSU5WSVNJQkxFKTtcblxuICAgICAgaWYgKG9wdGlvbnMubG9hZGluZykge1xuICAgICAgICBhZGRDbGFzcyhjYW52YXMsIENMQVNTX0xPQURJTkcpO1xuICAgICAgfVxuXG4gICAgICBjYW52YXMuaW5uZXJIVE1MID0gJyc7XG4gICAgICBjYW52YXMuYXBwZW5kQ2hpbGQoaW1hZ2UpOyAvLyBDZW50ZXIgY3VycmVudCBpdGVtXG5cbiAgICAgIHRoaXMucmVuZGVyTGlzdCgpOyAvLyBDbGVhciB0aXRsZVxuXG4gICAgICB0aXRsZS5pbm5lckhUTUwgPSAnJzsgLy8gR2VuZXJhdGUgdGl0bGUgYWZ0ZXIgdmlld2VkXG5cbiAgICAgIHZhciBvblZpZXdlZCA9IGZ1bmN0aW9uIG9uVmlld2VkKCkge1xuICAgICAgICB2YXIgaW1hZ2VEYXRhID0gX3RoaXMyLmltYWdlRGF0YTtcbiAgICAgICAgdmFyIHJlbmRlciA9IEFycmF5LmlzQXJyYXkob3B0aW9ucy50aXRsZSkgPyBvcHRpb25zLnRpdGxlWzFdIDogb3B0aW9ucy50aXRsZTtcbiAgICAgICAgdGl0bGUuaW5uZXJIVE1MID0gZXNjYXBlSFRNTEVudGl0aWVzKGlzRnVuY3Rpb24ocmVuZGVyKSA/IHJlbmRlci5jYWxsKF90aGlzMiwgaW1hZ2UsIGltYWdlRGF0YSkgOiBcIlwiLmNvbmNhdChhbHQsIFwiIChcIikuY29uY2F0KGltYWdlRGF0YS5uYXR1cmFsV2lkdGgsIFwiIFxceEQ3IFwiKS5jb25jYXQoaW1hZ2VEYXRhLm5hdHVyYWxIZWlnaHQsIFwiKVwiKSk7XG4gICAgICB9O1xuXG4gICAgICB2YXIgb25Mb2FkO1xuICAgICAgYWRkTGlzdGVuZXIoZWxlbWVudCwgRVZFTlRfVklFV0VELCBvblZpZXdlZCwge1xuICAgICAgICBvbmNlOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIHRoaXMudmlld2luZyA9IHtcbiAgICAgICAgYWJvcnQ6IGZ1bmN0aW9uIGFib3J0KCkge1xuICAgICAgICAgIHJlbW92ZUxpc3RlbmVyKGVsZW1lbnQsIEVWRU5UX1ZJRVdFRCwgb25WaWV3ZWQpO1xuXG4gICAgICAgICAgaWYgKGltYWdlLmNvbXBsZXRlKSB7XG4gICAgICAgICAgICBpZiAoX3RoaXMyLmltYWdlUmVuZGVyaW5nKSB7XG4gICAgICAgICAgICAgIF90aGlzMi5pbWFnZVJlbmRlcmluZy5hYm9ydCgpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChfdGhpczIuaW1hZ2VJbml0aWFsaXppbmcpIHtcbiAgICAgICAgICAgICAgX3RoaXMyLmltYWdlSW5pdGlhbGl6aW5nLmFib3J0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIENhbmNlbCBkb3dubG9hZCB0byBzYXZlIGJhbmR3aWR0aC5cbiAgICAgICAgICAgIGltYWdlLnNyYyA9ICcnO1xuICAgICAgICAgICAgcmVtb3ZlTGlzdGVuZXIoaW1hZ2UsIEVWRU5UX0xPQUQsIG9uTG9hZCk7XG5cbiAgICAgICAgICAgIGlmIChfdGhpczIudGltZW91dCkge1xuICAgICAgICAgICAgICBjbGVhclRpbWVvdXQoX3RoaXMyLnRpbWVvdXQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgaWYgKGltYWdlLmNvbXBsZXRlKSB7XG4gICAgICAgIHRoaXMubG9hZCgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYWRkTGlzdGVuZXIoaW1hZ2UsIEVWRU5UX0xPQUQsIG9uTG9hZCA9IHRoaXMubG9hZC5iaW5kKHRoaXMpLCB7XG4gICAgICAgICAgb25jZTogdHJ1ZVxuICAgICAgICB9KTtcblxuICAgICAgICBpZiAodGhpcy50aW1lb3V0KSB7XG4gICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZW91dCk7XG4gICAgICAgIH0gLy8gTWFrZSB0aGUgaW1hZ2UgdmlzaWJsZSBpZiBpdCBmYWlscyB0byBsb2FkIHdpdGhpbiAxc1xuXG5cbiAgICAgICAgdGhpcy50aW1lb3V0ID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgcmVtb3ZlQ2xhc3MoaW1hZ2UsIENMQVNTX0lOVklTSUJMRSk7XG4gICAgICAgICAgX3RoaXMyLnRpbWVvdXQgPSBmYWxzZTtcbiAgICAgICAgfSwgMTAwMCk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBWaWV3IHRoZSBwcmV2aW91cyBpbWFnZVxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2xvb3A9ZmFsc2VdIC0gSW5kaWNhdGUgaWYgdmlldyB0aGUgbGFzdCBvbmVcbiAgICAgKiB3aGVuIGl0IGlzIHRoZSBmaXJzdCBvbmUgYXQgcHJlc2VudC5cbiAgICAgKiBAcmV0dXJucyB7Vmlld2VyfSB0aGlzXG4gICAgICovXG4gICAgcHJldjogZnVuY3Rpb24gcHJldigpIHtcbiAgICAgIHZhciBsb29wID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBmYWxzZTtcbiAgICAgIHZhciBpbmRleCA9IHRoaXMuaW5kZXggLSAxO1xuXG4gICAgICBpZiAoaW5kZXggPCAwKSB7XG4gICAgICAgIGluZGV4ID0gbG9vcCA/IHRoaXMubGVuZ3RoIC0gMSA6IDA7XG4gICAgICB9XG5cbiAgICAgIHRoaXMudmlldyhpbmRleCk7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogVmlldyB0aGUgbmV4dCBpbWFnZVxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2xvb3A9ZmFsc2VdIC0gSW5kaWNhdGUgaWYgdmlldyB0aGUgZmlyc3Qgb25lXG4gICAgICogd2hlbiBpdCBpcyB0aGUgbGFzdCBvbmUgYXQgcHJlc2VudC5cbiAgICAgKiBAcmV0dXJucyB7Vmlld2VyfSB0aGlzXG4gICAgICovXG4gICAgbmV4dDogZnVuY3Rpb24gbmV4dCgpIHtcbiAgICAgIHZhciBsb29wID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBmYWxzZTtcbiAgICAgIHZhciBtYXhJbmRleCA9IHRoaXMubGVuZ3RoIC0gMTtcbiAgICAgIHZhciBpbmRleCA9IHRoaXMuaW5kZXggKyAxO1xuXG4gICAgICBpZiAoaW5kZXggPiBtYXhJbmRleCkge1xuICAgICAgICBpbmRleCA9IGxvb3AgPyAwIDogbWF4SW5kZXg7XG4gICAgICB9XG5cbiAgICAgIHRoaXMudmlldyhpbmRleCk7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogTW92ZSB0aGUgaW1hZ2Ugd2l0aCByZWxhdGl2ZSBvZmZzZXRzLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSB4IC0gVGhlIG1vdmluZyBkaXN0YW5jZSBpbiB0aGUgaG9yaXpvbnRhbCBkaXJlY3Rpb24uXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IFt5PXhdIFRoZSBtb3ZpbmcgZGlzdGFuY2UgaW4gdGhlIHZlcnRpY2FsIGRpcmVjdGlvbi5cbiAgICAgKiBAcmV0dXJucyB7Vmlld2VyfSB0aGlzXG4gICAgICovXG4gICAgbW92ZTogZnVuY3Rpb24gbW92ZSh4KSB7XG4gICAgICB2YXIgeSA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogeDtcbiAgICAgIHZhciBpbWFnZURhdGEgPSB0aGlzLmltYWdlRGF0YTtcbiAgICAgIHRoaXMubW92ZVRvKGlzVW5kZWZpbmVkKHgpID8geCA6IGltYWdlRGF0YS54ICsgTnVtYmVyKHgpLCBpc1VuZGVmaW5lZCh5KSA/IHkgOiBpbWFnZURhdGEueSArIE51bWJlcih5KSk7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogTW92ZSB0aGUgaW1hZ2UgdG8gYW4gYWJzb2x1dGUgcG9pbnQuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHggLSBUaGUgbmV3IHBvc2l0aW9uIGluIHRoZSBob3Jpem9udGFsIGRpcmVjdGlvbi5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW3k9eF0gLSBUaGUgbmV3IHBvc2l0aW9uIGluIHRoZSB2ZXJ0aWNhbCBkaXJlY3Rpb24uXG4gICAgICogQHBhcmFtIHtFdmVudH0gW19vcmlnaW5hbEV2ZW50PW51bGxdIC0gVGhlIG9yaWdpbmFsIGV2ZW50IGlmIGFueS5cbiAgICAgKiBAcmV0dXJucyB7Vmlld2VyfSB0aGlzXG4gICAgICovXG4gICAgbW92ZVRvOiBmdW5jdGlvbiBtb3ZlVG8oeCkge1xuICAgICAgdmFyIF90aGlzMyA9IHRoaXM7XG5cbiAgICAgIHZhciB5ID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiB4O1xuXG4gICAgICB2YXIgX29yaWdpbmFsRXZlbnQgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IG51bGw7XG5cbiAgICAgIHZhciBlbGVtZW50ID0gdGhpcy5lbGVtZW50LFxuICAgICAgICAgIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnMsXG4gICAgICAgICAgaW1hZ2VEYXRhID0gdGhpcy5pbWFnZURhdGE7XG4gICAgICB4ID0gTnVtYmVyKHgpO1xuICAgICAgeSA9IE51bWJlcih5KTtcblxuICAgICAgaWYgKHRoaXMudmlld2VkICYmICF0aGlzLnBsYXllZCAmJiBvcHRpb25zLm1vdmFibGUpIHtcbiAgICAgICAgdmFyIG9sZFggPSBpbWFnZURhdGEueDtcbiAgICAgICAgdmFyIG9sZFkgPSBpbWFnZURhdGEueTtcbiAgICAgICAgdmFyIGNoYW5nZWQgPSBmYWxzZTtcblxuICAgICAgICBpZiAoaXNOdW1iZXIoeCkpIHtcbiAgICAgICAgICBjaGFuZ2VkID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB4ID0gb2xkWDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChpc051bWJlcih5KSkge1xuICAgICAgICAgIGNoYW5nZWQgPSB0cnVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHkgPSBvbGRZO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGNoYW5nZWQpIHtcbiAgICAgICAgICBpZiAoaXNGdW5jdGlvbihvcHRpb25zLm1vdmUpKSB7XG4gICAgICAgICAgICBhZGRMaXN0ZW5lcihlbGVtZW50LCBFVkVOVF9NT1ZFLCBvcHRpb25zLm1vdmUsIHtcbiAgICAgICAgICAgICAgb25jZTogdHJ1ZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKGRpc3BhdGNoRXZlbnQoZWxlbWVudCwgRVZFTlRfTU9WRSwge1xuICAgICAgICAgICAgeDogeCxcbiAgICAgICAgICAgIHk6IHksXG4gICAgICAgICAgICBvbGRYOiBvbGRYLFxuICAgICAgICAgICAgb2xkWTogb2xkWSxcbiAgICAgICAgICAgIG9yaWdpbmFsRXZlbnQ6IF9vcmlnaW5hbEV2ZW50XG4gICAgICAgICAgfSkgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpbWFnZURhdGEueCA9IHg7XG4gICAgICAgICAgaW1hZ2VEYXRhLnkgPSB5O1xuICAgICAgICAgIGltYWdlRGF0YS5sZWZ0ID0geDtcbiAgICAgICAgICBpbWFnZURhdGEudG9wID0geTtcbiAgICAgICAgICB0aGlzLm1vdmluZyA9IHRydWU7XG4gICAgICAgICAgdGhpcy5yZW5kZXJJbWFnZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBfdGhpczMubW92aW5nID0gZmFsc2U7XG5cbiAgICAgICAgICAgIGlmIChpc0Z1bmN0aW9uKG9wdGlvbnMubW92ZWQpKSB7XG4gICAgICAgICAgICAgIGFkZExpc3RlbmVyKGVsZW1lbnQsIEVWRU5UX01PVkVELCBvcHRpb25zLm1vdmVkLCB7XG4gICAgICAgICAgICAgICAgb25jZTogdHJ1ZVxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZGlzcGF0Y2hFdmVudChlbGVtZW50LCBFVkVOVF9NT1ZFRCwge1xuICAgICAgICAgICAgICB4OiB4LFxuICAgICAgICAgICAgICB5OiB5LFxuICAgICAgICAgICAgICBvbGRYOiBvbGRYLFxuICAgICAgICAgICAgICBvbGRZOiBvbGRZLFxuICAgICAgICAgICAgICBvcmlnaW5hbEV2ZW50OiBfb3JpZ2luYWxFdmVudFxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICBjYW5jZWxhYmxlOiBmYWxzZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFJvdGF0ZSB0aGUgaW1hZ2Ugd2l0aCBhIHJlbGF0aXZlIGRlZ3JlZS5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gZGVncmVlIC0gVGhlIHJvdGF0ZSBkZWdyZWUuXG4gICAgICogQHJldHVybnMge1ZpZXdlcn0gdGhpc1xuICAgICAqL1xuICAgIHJvdGF0ZTogZnVuY3Rpb24gcm90YXRlKGRlZ3JlZSkge1xuICAgICAgdGhpcy5yb3RhdGVUbygodGhpcy5pbWFnZURhdGEucm90YXRlIHx8IDApICsgTnVtYmVyKGRlZ3JlZSkpO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFJvdGF0ZSB0aGUgaW1hZ2UgdG8gYW4gYWJzb2x1dGUgZGVncmVlLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBkZWdyZWUgLSBUaGUgcm90YXRlIGRlZ3JlZS5cbiAgICAgKiBAcmV0dXJucyB7Vmlld2VyfSB0aGlzXG4gICAgICovXG4gICAgcm90YXRlVG86IGZ1bmN0aW9uIHJvdGF0ZVRvKGRlZ3JlZSkge1xuICAgICAgdmFyIF90aGlzNCA9IHRoaXM7XG5cbiAgICAgIHZhciBlbGVtZW50ID0gdGhpcy5lbGVtZW50LFxuICAgICAgICAgIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnMsXG4gICAgICAgICAgaW1hZ2VEYXRhID0gdGhpcy5pbWFnZURhdGE7XG4gICAgICBkZWdyZWUgPSBOdW1iZXIoZGVncmVlKTtcblxuICAgICAgaWYgKGlzTnVtYmVyKGRlZ3JlZSkgJiYgdGhpcy52aWV3ZWQgJiYgIXRoaXMucGxheWVkICYmIG9wdGlvbnMucm90YXRhYmxlKSB7XG4gICAgICAgIHZhciBvbGREZWdyZWUgPSBpbWFnZURhdGEucm90YXRlO1xuXG4gICAgICAgIGlmIChpc0Z1bmN0aW9uKG9wdGlvbnMucm90YXRlKSkge1xuICAgICAgICAgIGFkZExpc3RlbmVyKGVsZW1lbnQsIEVWRU5UX1JPVEFURSwgb3B0aW9ucy5yb3RhdGUsIHtcbiAgICAgICAgICAgIG9uY2U6IHRydWVcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChkaXNwYXRjaEV2ZW50KGVsZW1lbnQsIEVWRU5UX1JPVEFURSwge1xuICAgICAgICAgIGRlZ3JlZTogZGVncmVlLFxuICAgICAgICAgIG9sZERlZ3JlZTogb2xkRGVncmVlXG4gICAgICAgIH0pID09PSBmYWxzZSkge1xuICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG5cbiAgICAgICAgaW1hZ2VEYXRhLnJvdGF0ZSA9IGRlZ3JlZTtcbiAgICAgICAgdGhpcy5yb3RhdGluZyA9IHRydWU7XG4gICAgICAgIHRoaXMucmVuZGVySW1hZ2UoZnVuY3Rpb24gKCkge1xuICAgICAgICAgIF90aGlzNC5yb3RhdGluZyA9IGZhbHNlO1xuXG4gICAgICAgICAgaWYgKGlzRnVuY3Rpb24ob3B0aW9ucy5yb3RhdGVkKSkge1xuICAgICAgICAgICAgYWRkTGlzdGVuZXIoZWxlbWVudCwgRVZFTlRfUk9UQVRFRCwgb3B0aW9ucy5yb3RhdGVkLCB7XG4gICAgICAgICAgICAgIG9uY2U6IHRydWVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGRpc3BhdGNoRXZlbnQoZWxlbWVudCwgRVZFTlRfUk9UQVRFRCwge1xuICAgICAgICAgICAgZGVncmVlOiBkZWdyZWUsXG4gICAgICAgICAgICBvbGREZWdyZWU6IG9sZERlZ3JlZVxuICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgIGNhbmNlbGFibGU6IGZhbHNlXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogU2NhbGUgdGhlIGltYWdlIG9uIHRoZSB4LWF4aXMuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHNjYWxlWCAtIFRoZSBzY2FsZSByYXRpbyBvbiB0aGUgeC1heGlzLlxuICAgICAqIEByZXR1cm5zIHtWaWV3ZXJ9IHRoaXNcbiAgICAgKi9cbiAgICBzY2FsZVg6IGZ1bmN0aW9uIHNjYWxlWChfc2NhbGVYKSB7XG4gICAgICB0aGlzLnNjYWxlKF9zY2FsZVgsIHRoaXMuaW1hZ2VEYXRhLnNjYWxlWSk7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogU2NhbGUgdGhlIGltYWdlIG9uIHRoZSB5LWF4aXMuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHNjYWxlWSAtIFRoZSBzY2FsZSByYXRpbyBvbiB0aGUgeS1heGlzLlxuICAgICAqIEByZXR1cm5zIHtWaWV3ZXJ9IHRoaXNcbiAgICAgKi9cbiAgICBzY2FsZVk6IGZ1bmN0aW9uIHNjYWxlWShfc2NhbGVZKSB7XG4gICAgICB0aGlzLnNjYWxlKHRoaXMuaW1hZ2VEYXRhLnNjYWxlWCwgX3NjYWxlWSk7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuXG4gICAgLyoqXG4gICAgICogU2NhbGUgdGhlIGltYWdlLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzY2FsZVggLSBUaGUgc2NhbGUgcmF0aW8gb24gdGhlIHgtYXhpcy5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gW3NjYWxlWT1zY2FsZVhdIC0gVGhlIHNjYWxlIHJhdGlvIG9uIHRoZSB5LWF4aXMuXG4gICAgICogQHJldHVybnMge1ZpZXdlcn0gdGhpc1xuICAgICAqL1xuICAgIHNjYWxlOiBmdW5jdGlvbiBzY2FsZShzY2FsZVgpIHtcbiAgICAgIHZhciBfdGhpczUgPSB0aGlzO1xuXG4gICAgICB2YXIgc2NhbGVZID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBzY2FsZVg7XG4gICAgICB2YXIgZWxlbWVudCA9IHRoaXMuZWxlbWVudCxcbiAgICAgICAgICBvcHRpb25zID0gdGhpcy5vcHRpb25zLFxuICAgICAgICAgIGltYWdlRGF0YSA9IHRoaXMuaW1hZ2VEYXRhO1xuICAgICAgc2NhbGVYID0gTnVtYmVyKHNjYWxlWCk7XG4gICAgICBzY2FsZVkgPSBOdW1iZXIoc2NhbGVZKTtcblxuICAgICAgaWYgKHRoaXMudmlld2VkICYmICF0aGlzLnBsYXllZCAmJiBvcHRpb25zLnNjYWxhYmxlKSB7XG4gICAgICAgIHZhciBvbGRTY2FsZVggPSBpbWFnZURhdGEuc2NhbGVYO1xuICAgICAgICB2YXIgb2xkU2NhbGVZID0gaW1hZ2VEYXRhLnNjYWxlWTtcbiAgICAgICAgdmFyIGNoYW5nZWQgPSBmYWxzZTtcblxuICAgICAgICBpZiAoaXNOdW1iZXIoc2NhbGVYKSkge1xuICAgICAgICAgIGNoYW5nZWQgPSB0cnVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHNjYWxlWCA9IG9sZFNjYWxlWDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChpc051bWJlcihzY2FsZVkpKSB7XG4gICAgICAgICAgY2hhbmdlZCA9IHRydWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc2NhbGVZID0gb2xkU2NhbGVZO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGNoYW5nZWQpIHtcbiAgICAgICAgICBpZiAoaXNGdW5jdGlvbihvcHRpb25zLnNjYWxlKSkge1xuICAgICAgICAgICAgYWRkTGlzdGVuZXIoZWxlbWVudCwgRVZFTlRfU0NBTEUsIG9wdGlvbnMuc2NhbGUsIHtcbiAgICAgICAgICAgICAgb25jZTogdHJ1ZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKGRpc3BhdGNoRXZlbnQoZWxlbWVudCwgRVZFTlRfU0NBTEUsIHtcbiAgICAgICAgICAgIHNjYWxlWDogc2NhbGVYLFxuICAgICAgICAgICAgc2NhbGVZOiBzY2FsZVksXG4gICAgICAgICAgICBvbGRTY2FsZVg6IG9sZFNjYWxlWCxcbiAgICAgICAgICAgIG9sZFNjYWxlWTogb2xkU2NhbGVZXG4gICAgICAgICAgfSkgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpbWFnZURhdGEuc2NhbGVYID0gc2NhbGVYO1xuICAgICAgICAgIGltYWdlRGF0YS5zY2FsZVkgPSBzY2FsZVk7XG4gICAgICAgICAgdGhpcy5zY2FsaW5nID0gdHJ1ZTtcbiAgICAgICAgICB0aGlzLnJlbmRlckltYWdlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIF90aGlzNS5zY2FsaW5nID0gZmFsc2U7XG5cbiAgICAgICAgICAgIGlmIChpc0Z1bmN0aW9uKG9wdGlvbnMuc2NhbGVkKSkge1xuICAgICAgICAgICAgICBhZGRMaXN0ZW5lcihlbGVtZW50LCBFVkVOVF9TQ0FMRUQsIG9wdGlvbnMuc2NhbGVkLCB7XG4gICAgICAgICAgICAgICAgb25jZTogdHJ1ZVxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZGlzcGF0Y2hFdmVudChlbGVtZW50LCBFVkVOVF9TQ0FMRUQsIHtcbiAgICAgICAgICAgICAgc2NhbGVYOiBzY2FsZVgsXG4gICAgICAgICAgICAgIHNjYWxlWTogc2NhbGVZLFxuICAgICAgICAgICAgICBvbGRTY2FsZVg6IG9sZFNjYWxlWCxcbiAgICAgICAgICAgICAgb2xkU2NhbGVZOiBvbGRTY2FsZVlcbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgY2FuY2VsYWJsZTogZmFsc2VcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBab29tIHRoZSBpbWFnZSB3aXRoIGEgcmVsYXRpdmUgcmF0aW8uXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHJhdGlvIC0gVGhlIHRhcmdldCByYXRpby5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtoYXNUb29sdGlwPWZhbHNlXSAtIEluZGljYXRlcyBpZiBpdCBoYXMgYSB0b29sdGlwIG9yIG5vdC5cbiAgICAgKiBAcGFyYW0ge0V2ZW50fSBbX29yaWdpbmFsRXZlbnQ9bnVsbF0gLSBUaGUgb3JpZ2luYWwgZXZlbnQgaWYgYW55LlxuICAgICAqIEByZXR1cm5zIHtWaWV3ZXJ9IHRoaXNcbiAgICAgKi9cbiAgICB6b29tOiBmdW5jdGlvbiB6b29tKHJhdGlvKSB7XG4gICAgICB2YXIgaGFzVG9vbHRpcCA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogZmFsc2U7XG5cbiAgICAgIHZhciBfb3JpZ2luYWxFdmVudCA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogbnVsbDtcblxuICAgICAgdmFyIGltYWdlRGF0YSA9IHRoaXMuaW1hZ2VEYXRhO1xuICAgICAgcmF0aW8gPSBOdW1iZXIocmF0aW8pO1xuXG4gICAgICBpZiAocmF0aW8gPCAwKSB7XG4gICAgICAgIHJhdGlvID0gMSAvICgxIC0gcmF0aW8pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmF0aW8gPSAxICsgcmF0aW87XG4gICAgICB9XG5cbiAgICAgIHRoaXMuem9vbVRvKGltYWdlRGF0YS53aWR0aCAqIHJhdGlvIC8gaW1hZ2VEYXRhLm5hdHVyYWxXaWR0aCwgaGFzVG9vbHRpcCwgX29yaWdpbmFsRXZlbnQpO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcblxuICAgIC8qKlxuICAgICAqIFpvb20gdGhlIGltYWdlIHRvIGFuIGFic29sdXRlIHJhdGlvLlxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSByYXRpbyAtIFRoZSB0YXJnZXQgcmF0aW8uXG4gICAgICogQHBhcmFtIHtib29sZWFufSBbaGFzVG9vbHRpcD1mYWxzZV0gLSBJbmRpY2F0ZXMgaWYgaXQgaGFzIGEgdG9vbHRpcCBvciBub3QuXG4gICAgICogQHBhcmFtIHtFdmVudH0gW19vcmlnaW5hbEV2ZW50PW51bGxdIC0gVGhlIG9yaWdpbmFsIGV2ZW50IGlmIGFueS5cbiAgICAgKiBAcGFyYW0ge0V2ZW50fSBbX3pvb21hYmxlPWZhbHNlXSAtIEluZGljYXRlcyBpZiB0aGUgY3VycmVudCB6b29tIGlzIGF2YWlsYWJsZSBvciBub3QuXG4gICAgICogQHJldHVybnMge1ZpZXdlcn0gdGhpc1xuICAgICAqL1xuICAgIHpvb21UbzogZnVuY3Rpb24gem9vbVRvKHJhdGlvKSB7XG4gICAgICB2YXIgX3RoaXM2ID0gdGhpcztcblxuICAgICAgdmFyIGhhc1Rvb2x0aXAgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IGZhbHNlO1xuXG4gICAgICB2YXIgX29yaWdpbmFsRXZlbnQgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IG51bGw7XG5cbiAgICAgIHZhciBfem9vbWFibGUgPSBhcmd1bWVudHMubGVuZ3RoID4gMyAmJiBhcmd1bWVudHNbM10gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1szXSA6IGZhbHNlO1xuXG4gICAgICB2YXIgZWxlbWVudCA9IHRoaXMuZWxlbWVudCxcbiAgICAgICAgICBvcHRpb25zID0gdGhpcy5vcHRpb25zLFxuICAgICAgICAgIHBvaW50ZXJzID0gdGhpcy5wb2ludGVycyxcbiAgICAgICAgICBpbWFnZURhdGEgPSB0aGlzLmltYWdlRGF0YTtcbiAgICAgIHZhciB4ID0gaW1hZ2VEYXRhLngsXG4gICAgICAgICAgeSA9IGltYWdlRGF0YS55LFxuICAgICAgICAgIHdpZHRoID0gaW1hZ2VEYXRhLndpZHRoLFxuICAgICAgICAgIGhlaWdodCA9IGltYWdlRGF0YS5oZWlnaHQsXG4gICAgICAgICAgbmF0dXJhbFdpZHRoID0gaW1hZ2VEYXRhLm5hdHVyYWxXaWR0aCxcbiAgICAgICAgICBuYXR1cmFsSGVpZ2h0ID0gaW1hZ2VEYXRhLm5hdHVyYWxIZWlnaHQ7XG4gICAgICByYXRpbyA9IE1hdGgubWF4KDAsIHJhdGlvKTtcblxuICAgICAgaWYgKGlzTnVtYmVyKHJhdGlvKSAmJiB0aGlzLnZpZXdlZCAmJiAhdGhpcy5wbGF5ZWQgJiYgKF96b29tYWJsZSB8fCBvcHRpb25zLnpvb21hYmxlKSkge1xuICAgICAgICBpZiAoIV96b29tYWJsZSkge1xuICAgICAgICAgIHZhciBtaW5ab29tUmF0aW8gPSBNYXRoLm1heCgwLjAxLCBvcHRpb25zLm1pblpvb21SYXRpbyk7XG4gICAgICAgICAgdmFyIG1heFpvb21SYXRpbyA9IE1hdGgubWluKDEwMCwgb3B0aW9ucy5tYXhab29tUmF0aW8pO1xuICAgICAgICAgIHJhdGlvID0gTWF0aC5taW4oTWF0aC5tYXgocmF0aW8sIG1pblpvb21SYXRpbyksIG1heFpvb21SYXRpbyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoX29yaWdpbmFsRXZlbnQgJiYgb3B0aW9ucy56b29tUmF0aW8gPj0gMC4wNTUgJiYgcmF0aW8gPiAwLjk1ICYmIHJhdGlvIDwgMS4wNSkge1xuICAgICAgICAgIHJhdGlvID0gMTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBuZXdXaWR0aCA9IG5hdHVyYWxXaWR0aCAqIHJhdGlvO1xuICAgICAgICB2YXIgbmV3SGVpZ2h0ID0gbmF0dXJhbEhlaWdodCAqIHJhdGlvO1xuICAgICAgICB2YXIgb2Zmc2V0V2lkdGggPSBuZXdXaWR0aCAtIHdpZHRoO1xuICAgICAgICB2YXIgb2Zmc2V0SGVpZ2h0ID0gbmV3SGVpZ2h0IC0gaGVpZ2h0O1xuICAgICAgICB2YXIgb2xkUmF0aW8gPSB3aWR0aCAvIG5hdHVyYWxXaWR0aDtcblxuICAgICAgICBpZiAoaXNGdW5jdGlvbihvcHRpb25zLnpvb20pKSB7XG4gICAgICAgICAgYWRkTGlzdGVuZXIoZWxlbWVudCwgRVZFTlRfWk9PTSwgb3B0aW9ucy56b29tLCB7XG4gICAgICAgICAgICBvbmNlOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZGlzcGF0Y2hFdmVudChlbGVtZW50LCBFVkVOVF9aT09NLCB7XG4gICAgICAgICAgcmF0aW86IHJhdGlvLFxuICAgICAgICAgIG9sZFJhdGlvOiBvbGRSYXRpbyxcbiAgICAgICAgICBvcmlnaW5hbEV2ZW50OiBfb3JpZ2luYWxFdmVudFxuICAgICAgICB9KSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuem9vbWluZyA9IHRydWU7XG5cbiAgICAgICAgaWYgKF9vcmlnaW5hbEV2ZW50KSB7XG4gICAgICAgICAgdmFyIG9mZnNldCA9IGdldE9mZnNldCh0aGlzLnZpZXdlcik7XG4gICAgICAgICAgdmFyIGNlbnRlciA9IHBvaW50ZXJzICYmIE9iamVjdC5rZXlzKHBvaW50ZXJzKS5sZW5ndGggPyBnZXRQb2ludGVyc0NlbnRlcihwb2ludGVycykgOiB7XG4gICAgICAgICAgICBwYWdlWDogX29yaWdpbmFsRXZlbnQucGFnZVgsXG4gICAgICAgICAgICBwYWdlWTogX29yaWdpbmFsRXZlbnQucGFnZVlcbiAgICAgICAgICB9OyAvLyBab29tIGZyb20gdGhlIHRyaWdnZXJpbmcgcG9pbnQgb2YgdGhlIGV2ZW50XG5cbiAgICAgICAgICBpbWFnZURhdGEueCAtPSBvZmZzZXRXaWR0aCAqICgoY2VudGVyLnBhZ2VYIC0gb2Zmc2V0LmxlZnQgLSB4KSAvIHdpZHRoKTtcbiAgICAgICAgICBpbWFnZURhdGEueSAtPSBvZmZzZXRIZWlnaHQgKiAoKGNlbnRlci5wYWdlWSAtIG9mZnNldC50b3AgLSB5KSAvIGhlaWdodCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gWm9vbSBmcm9tIHRoZSBjZW50ZXIgb2YgdGhlIGltYWdlXG4gICAgICAgICAgaW1hZ2VEYXRhLnggLT0gb2Zmc2V0V2lkdGggLyAyO1xuICAgICAgICAgIGltYWdlRGF0YS55IC09IG9mZnNldEhlaWdodCAvIDI7XG4gICAgICAgIH1cblxuICAgICAgICBpbWFnZURhdGEubGVmdCA9IGltYWdlRGF0YS54O1xuICAgICAgICBpbWFnZURhdGEudG9wID0gaW1hZ2VEYXRhLnk7XG4gICAgICAgIGltYWdlRGF0YS53aWR0aCA9IG5ld1dpZHRoO1xuICAgICAgICBpbWFnZURhdGEuaGVpZ2h0ID0gbmV3SGVpZ2h0O1xuICAgICAgICBpbWFnZURhdGEucmF0aW8gPSByYXRpbztcbiAgICAgICAgdGhpcy5yZW5kZXJJbWFnZShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgX3RoaXM2Lnpvb21pbmcgPSBmYWxzZTtcblxuICAgICAgICAgIGlmIChpc0Z1bmN0aW9uKG9wdGlvbnMuem9vbWVkKSkge1xuICAgICAgICAgICAgYWRkTGlzdGVuZXIoZWxlbWVudCwgRVZFTlRfWk9PTUVELCBvcHRpb25zLnpvb21lZCwge1xuICAgICAgICAgICAgICBvbmNlOiB0cnVlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBkaXNwYXRjaEV2ZW50KGVsZW1lbnQsIEVWRU5UX1pPT01FRCwge1xuICAgICAgICAgICAgcmF0aW86IHJhdGlvLFxuICAgICAgICAgICAgb2xkUmF0aW86IG9sZFJhdGlvLFxuICAgICAgICAgICAgb3JpZ2luYWxFdmVudDogX29yaWdpbmFsRXZlbnRcbiAgICAgICAgICB9LCB7XG4gICAgICAgICAgICBjYW5jZWxhYmxlOiBmYWxzZVxuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICBpZiAoaGFzVG9vbHRpcCkge1xuICAgICAgICAgIHRoaXMudG9vbHRpcCgpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG5cbiAgICAvKipcbiAgICAgKiBQbGF5IHRoZSBpbWFnZXNcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtmdWxsc2NyZWVuPWZhbHNlXSAtIEluZGljYXRlIGlmIHJlcXVlc3QgZnVsbHNjcmVlbiBvciBub3QuXG4gICAgICogQHJldHVybnMge1ZpZXdlcn0gdGhpc1xuICAgICAqL1xuICAgIHBsYXk6IGZ1bmN0aW9uIHBsYXkoKSB7XG4gICAgICB2YXIgX3RoaXM3ID0gdGhpcztcblxuICAgICAgdmFyIGZ1bGxzY3JlZW4gPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IGZhbHNlO1xuXG4gICAgICBpZiAoIXRoaXMuaXNTaG93biB8fCB0aGlzLnBsYXllZCkge1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH1cblxuICAgICAgdmFyIGVsZW1lbnQgPSB0aGlzLmVsZW1lbnQsXG4gICAgICAgICAgb3B0aW9ucyA9IHRoaXMub3B0aW9ucztcblxuICAgICAgaWYgKGlzRnVuY3Rpb24ob3B0aW9ucy5wbGF5KSkge1xuICAgICAgICBhZGRMaXN0ZW5lcihlbGVtZW50LCBFVkVOVF9QTEFZLCBvcHRpb25zLnBsYXksIHtcbiAgICAgICAgICBvbmNlOiB0cnVlXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBpZiAoZGlzcGF0Y2hFdmVudChlbGVtZW50LCBFVkVOVF9QTEFZKSA9PT0gZmFsc2UpIHtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9XG5cbiAgICAgIHZhciBwbGF5ZXIgPSB0aGlzLnBsYXllcjtcbiAgICAgIHZhciBvbkxvYWQgPSB0aGlzLmxvYWRJbWFnZS5iaW5kKHRoaXMpO1xuICAgICAgdmFyIGxpc3QgPSBbXTtcbiAgICAgIHZhciB0b3RhbCA9IDA7XG4gICAgICB2YXIgaW5kZXggPSAwO1xuICAgICAgdGhpcy5wbGF5ZWQgPSB0cnVlO1xuICAgICAgdGhpcy5vbkxvYWRXaGVuUGxheSA9IG9uTG9hZDtcblxuICAgICAgaWYgKGZ1bGxzY3JlZW4pIHtcbiAgICAgICAgdGhpcy5yZXF1ZXN0RnVsbHNjcmVlbigpO1xuICAgICAgfVxuXG4gICAgICBhZGRDbGFzcyhwbGF5ZXIsIENMQVNTX1NIT1cpO1xuICAgICAgZm9yRWFjaCh0aGlzLml0ZW1zLCBmdW5jdGlvbiAoaXRlbSwgaSkge1xuICAgICAgICB2YXIgaW1nID0gaXRlbS5xdWVyeVNlbGVjdG9yKCdpbWcnKTtcbiAgICAgICAgdmFyIGltYWdlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7XG4gICAgICAgIGltYWdlLnNyYyA9IGdldERhdGEoaW1nLCAnb3JpZ2luYWxVcmwnKTtcbiAgICAgICAgaW1hZ2UuYWx0ID0gaW1nLmdldEF0dHJpYnV0ZSgnYWx0Jyk7XG4gICAgICAgIGltYWdlLnJlZmVycmVyUG9saWN5ID0gaW1nLnJlZmVycmVyUG9saWN5O1xuICAgICAgICB0b3RhbCArPSAxO1xuICAgICAgICBhZGRDbGFzcyhpbWFnZSwgQ0xBU1NfRkFERSk7XG4gICAgICAgIHRvZ2dsZUNsYXNzKGltYWdlLCBDTEFTU19UUkFOU0lUSU9OLCBvcHRpb25zLnRyYW5zaXRpb24pO1xuXG4gICAgICAgIGlmIChoYXNDbGFzcyhpdGVtLCBDTEFTU19BQ1RJVkUpKSB7XG4gICAgICAgICAgYWRkQ2xhc3MoaW1hZ2UsIENMQVNTX0lOKTtcbiAgICAgICAgICBpbmRleCA9IGk7XG4gICAgICAgIH1cblxuICAgICAgICBsaXN0LnB1c2goaW1hZ2UpO1xuICAgICAgICBhZGRMaXN0ZW5lcihpbWFnZSwgRVZFTlRfTE9BRCwgb25Mb2FkLCB7XG4gICAgICAgICAgb25jZTogdHJ1ZVxuICAgICAgICB9KTtcbiAgICAgICAgcGxheWVyLmFwcGVuZENoaWxkKGltYWdlKTtcbiAgICAgIH0pO1xuXG4gICAgICBpZiAoaXNOdW1iZXIob3B0aW9ucy5pbnRlcnZhbCkgJiYgb3B0aW9ucy5pbnRlcnZhbCA+IDApIHtcbiAgICAgICAgdmFyIHBsYXkgPSBmdW5jdGlvbiBwbGF5KCkge1xuICAgICAgICAgIF90aGlzNy5wbGF5aW5nID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZW1vdmVDbGFzcyhsaXN0W2luZGV4XSwgQ0xBU1NfSU4pO1xuICAgICAgICAgICAgaW5kZXggKz0gMTtcbiAgICAgICAgICAgIGluZGV4ID0gaW5kZXggPCB0b3RhbCA/IGluZGV4IDogMDtcbiAgICAgICAgICAgIGFkZENsYXNzKGxpc3RbaW5kZXhdLCBDTEFTU19JTik7XG4gICAgICAgICAgICBwbGF5KCk7XG4gICAgICAgICAgfSwgb3B0aW9ucy5pbnRlcnZhbCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKHRvdGFsID4gMSkge1xuICAgICAgICAgIHBsYXkoKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuICAgIC8vIFN0b3AgcGxheVxuICAgIHN0b3A6IGZ1bmN0aW9uIHN0b3AoKSB7XG4gICAgICB2YXIgX3RoaXM4ID0gdGhpcztcblxuICAgICAgaWYgKCF0aGlzLnBsYXllZCkge1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH1cblxuICAgICAgdmFyIGVsZW1lbnQgPSB0aGlzLmVsZW1lbnQsXG4gICAgICAgICAgb3B0aW9ucyA9IHRoaXMub3B0aW9ucztcblxuICAgICAgaWYgKGlzRnVuY3Rpb24ob3B0aW9ucy5zdG9wKSkge1xuICAgICAgICBhZGRMaXN0ZW5lcihlbGVtZW50LCBFVkVOVF9TVE9QLCBvcHRpb25zLnN0b3AsIHtcbiAgICAgICAgICBvbmNlOiB0cnVlXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBpZiAoZGlzcGF0Y2hFdmVudChlbGVtZW50LCBFVkVOVF9TVE9QKSA9PT0gZmFsc2UpIHtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9XG5cbiAgICAgIHZhciBwbGF5ZXIgPSB0aGlzLnBsYXllcjtcbiAgICAgIHRoaXMucGxheWVkID0gZmFsc2U7XG4gICAgICBjbGVhclRpbWVvdXQodGhpcy5wbGF5aW5nKTtcbiAgICAgIGZvckVhY2gocGxheWVyLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdpbWcnKSwgZnVuY3Rpb24gKGltYWdlKSB7XG4gICAgICAgIHJlbW92ZUxpc3RlbmVyKGltYWdlLCBFVkVOVF9MT0FELCBfdGhpczgub25Mb2FkV2hlblBsYXkpO1xuICAgICAgfSk7XG4gICAgICByZW1vdmVDbGFzcyhwbGF5ZXIsIENMQVNTX1NIT1cpO1xuICAgICAgcGxheWVyLmlubmVySFRNTCA9ICcnO1xuICAgICAgdGhpcy5leGl0RnVsbHNjcmVlbigpO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcbiAgICAvLyBFbnRlciBtb2RhbCBtb2RlIChvbmx5IGF2YWlsYWJsZSBpbiBpbmxpbmUgbW9kZSlcbiAgICBmdWxsOiBmdW5jdGlvbiBmdWxsKCkge1xuICAgICAgdmFyIF90aGlzOSA9IHRoaXM7XG5cbiAgICAgIHZhciBvcHRpb25zID0gdGhpcy5vcHRpb25zLFxuICAgICAgICAgIHZpZXdlciA9IHRoaXMudmlld2VyLFxuICAgICAgICAgIGltYWdlID0gdGhpcy5pbWFnZSxcbiAgICAgICAgICBsaXN0ID0gdGhpcy5saXN0O1xuXG4gICAgICBpZiAoIXRoaXMuaXNTaG93biB8fCB0aGlzLnBsYXllZCB8fCB0aGlzLmZ1bGxlZCB8fCAhb3B0aW9ucy5pbmxpbmUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuZnVsbGVkID0gdHJ1ZTtcbiAgICAgIHRoaXMub3BlbigpO1xuICAgICAgYWRkQ2xhc3ModGhpcy5idXR0b24sIENMQVNTX0ZVTExTQ1JFRU5fRVhJVCk7XG5cbiAgICAgIGlmIChvcHRpb25zLnRyYW5zaXRpb24pIHtcbiAgICAgICAgcmVtb3ZlQ2xhc3MobGlzdCwgQ0xBU1NfVFJBTlNJVElPTik7XG5cbiAgICAgICAgaWYgKHRoaXMudmlld2VkKSB7XG4gICAgICAgICAgcmVtb3ZlQ2xhc3MoaW1hZ2UsIENMQVNTX1RSQU5TSVRJT04pO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGFkZENsYXNzKHZpZXdlciwgQ0xBU1NfRklYRUQpO1xuICAgICAgdmlld2VyLnNldEF0dHJpYnV0ZSgncm9sZScsICdkaWFsb2cnKTtcbiAgICAgIHZpZXdlci5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWxsZWRieScsIHRoaXMudGl0bGUuaWQpO1xuICAgICAgdmlld2VyLnNldEF0dHJpYnV0ZSgnYXJpYS1tb2RhbCcsIHRydWUpO1xuICAgICAgdmlld2VyLnJlbW92ZUF0dHJpYnV0ZSgnc3R5bGUnKTtcbiAgICAgIHNldFN0eWxlKHZpZXdlciwge1xuICAgICAgICB6SW5kZXg6IG9wdGlvbnMuekluZGV4XG4gICAgICB9KTtcblxuICAgICAgaWYgKG9wdGlvbnMuZm9jdXMpIHtcbiAgICAgICAgdGhpcy5lbmZvcmNlRm9jdXMoKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5pbml0Q29udGFpbmVyKCk7XG4gICAgICB0aGlzLnZpZXdlckRhdGEgPSBhc3NpZ24oe30sIHRoaXMuY29udGFpbmVyRGF0YSk7XG4gICAgICB0aGlzLnJlbmRlckxpc3QoKTtcblxuICAgICAgaWYgKHRoaXMudmlld2VkKSB7XG4gICAgICAgIHRoaXMuaW5pdEltYWdlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBfdGhpczkucmVuZGVySW1hZ2UoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKG9wdGlvbnMudHJhbnNpdGlvbikge1xuICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBhZGRDbGFzcyhpbWFnZSwgQ0xBU1NfVFJBTlNJVElPTik7XG4gICAgICAgICAgICAgICAgYWRkQ2xhc3MobGlzdCwgQ0xBU1NfVFJBTlNJVElPTik7XG4gICAgICAgICAgICAgIH0sIDApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcbiAgICAvLyBFeGl0IG1vZGFsIG1vZGUgKG9ubHkgYXZhaWxhYmxlIGluIGlubGluZSBtb2RlKVxuICAgIGV4aXQ6IGZ1bmN0aW9uIGV4aXQoKSB7XG4gICAgICB2YXIgX3RoaXMxMCA9IHRoaXM7XG5cbiAgICAgIHZhciBvcHRpb25zID0gdGhpcy5vcHRpb25zLFxuICAgICAgICAgIHZpZXdlciA9IHRoaXMudmlld2VyLFxuICAgICAgICAgIGltYWdlID0gdGhpcy5pbWFnZSxcbiAgICAgICAgICBsaXN0ID0gdGhpcy5saXN0O1xuXG4gICAgICBpZiAoIXRoaXMuaXNTaG93biB8fCB0aGlzLnBsYXllZCB8fCAhdGhpcy5mdWxsZWQgfHwgIW9wdGlvbnMuaW5saW5lKSB7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmZ1bGxlZCA9IGZhbHNlO1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgcmVtb3ZlQ2xhc3ModGhpcy5idXR0b24sIENMQVNTX0ZVTExTQ1JFRU5fRVhJVCk7XG5cbiAgICAgIGlmIChvcHRpb25zLnRyYW5zaXRpb24pIHtcbiAgICAgICAgcmVtb3ZlQ2xhc3MobGlzdCwgQ0xBU1NfVFJBTlNJVElPTik7XG5cbiAgICAgICAgaWYgKHRoaXMudmlld2VkKSB7XG4gICAgICAgICAgcmVtb3ZlQ2xhc3MoaW1hZ2UsIENMQVNTX1RSQU5TSVRJT04pO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmIChvcHRpb25zLmZvY3VzKSB7XG4gICAgICAgIHRoaXMuY2xlYXJFbmZvcmNlRm9jdXMoKTtcbiAgICAgIH1cblxuICAgICAgdmlld2VyLnJlbW92ZUF0dHJpYnV0ZSgncm9sZScpO1xuICAgICAgdmlld2VyLnJlbW92ZUF0dHJpYnV0ZSgnYXJpYS1sYWJlbGxlZGJ5Jyk7XG4gICAgICB2aWV3ZXIucmVtb3ZlQXR0cmlidXRlKCdhcmlhLW1vZGFsJyk7XG4gICAgICByZW1vdmVDbGFzcyh2aWV3ZXIsIENMQVNTX0ZJWEVEKTtcbiAgICAgIHNldFN0eWxlKHZpZXdlciwge1xuICAgICAgICB6SW5kZXg6IG9wdGlvbnMuekluZGV4SW5saW5lXG4gICAgICB9KTtcbiAgICAgIHRoaXMudmlld2VyRGF0YSA9IGFzc2lnbih7fSwgdGhpcy5wYXJlbnREYXRhKTtcbiAgICAgIHRoaXMucmVuZGVyVmlld2VyKCk7XG4gICAgICB0aGlzLnJlbmRlckxpc3QoKTtcblxuICAgICAgaWYgKHRoaXMudmlld2VkKSB7XG4gICAgICAgIHRoaXMuaW5pdEltYWdlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBfdGhpczEwLnJlbmRlckltYWdlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmIChvcHRpb25zLnRyYW5zaXRpb24pIHtcbiAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgYWRkQ2xhc3MoaW1hZ2UsIENMQVNTX1RSQU5TSVRJT04pO1xuICAgICAgICAgICAgICAgIGFkZENsYXNzKGxpc3QsIENMQVNTX1RSQU5TSVRJT04pO1xuICAgICAgICAgICAgICB9LCAwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG4gICAgLy8gU2hvdyB0aGUgY3VycmVudCByYXRpbyBvZiB0aGUgaW1hZ2Ugd2l0aCBwZXJjZW50YWdlXG4gICAgdG9vbHRpcDogZnVuY3Rpb24gdG9vbHRpcCgpIHtcbiAgICAgIHZhciBfdGhpczExID0gdGhpcztcblxuICAgICAgdmFyIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnMsXG4gICAgICAgICAgdG9vbHRpcEJveCA9IHRoaXMudG9vbHRpcEJveCxcbiAgICAgICAgICBpbWFnZURhdGEgPSB0aGlzLmltYWdlRGF0YTtcblxuICAgICAgaWYgKCF0aGlzLnZpZXdlZCB8fCB0aGlzLnBsYXllZCB8fCAhb3B0aW9ucy50b29sdGlwKSB7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfVxuXG4gICAgICB0b29sdGlwQm94LnRleHRDb250ZW50ID0gXCJcIi5jb25jYXQoTWF0aC5yb3VuZChpbWFnZURhdGEucmF0aW8gKiAxMDApLCBcIiVcIik7XG5cbiAgICAgIGlmICghdGhpcy50b29sdGlwcGluZykge1xuICAgICAgICBpZiAob3B0aW9ucy50cmFuc2l0aW9uKSB7XG4gICAgICAgICAgaWYgKHRoaXMuZmFkaW5nKSB7XG4gICAgICAgICAgICBkaXNwYXRjaEV2ZW50KHRvb2x0aXBCb3gsIEVWRU5UX1RSQU5TSVRJT05fRU5EKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBhZGRDbGFzcyh0b29sdGlwQm94LCBDTEFTU19TSE9XKTtcbiAgICAgICAgICBhZGRDbGFzcyh0b29sdGlwQm94LCBDTEFTU19GQURFKTtcbiAgICAgICAgICBhZGRDbGFzcyh0b29sdGlwQm94LCBDTEFTU19UUkFOU0lUSU9OKTtcbiAgICAgICAgICB0b29sdGlwQm94LnJlbW92ZUF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nKTsgLy8gRm9yY2UgcmVmbG93IHRvIGVuYWJsZSBDU1MzIHRyYW5zaXRpb25cblxuICAgICAgICAgIHRvb2x0aXBCb3guaW5pdGlhbE9mZnNldFdpZHRoID0gdG9vbHRpcEJveC5vZmZzZXRXaWR0aDtcbiAgICAgICAgICBhZGRDbGFzcyh0b29sdGlwQm94LCBDTEFTU19JTik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgYWRkQ2xhc3ModG9vbHRpcEJveCwgQ0xBU1NfU0hPVyk7XG4gICAgICAgICAgdG9vbHRpcEJveC5yZW1vdmVBdHRyaWJ1dGUoJ2FyaWEtaGlkZGVuJyk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRvb2x0aXBwaW5nKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy50b29sdGlwcGluZyA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAob3B0aW9ucy50cmFuc2l0aW9uKSB7XG4gICAgICAgICAgYWRkTGlzdGVuZXIodG9vbHRpcEJveCwgRVZFTlRfVFJBTlNJVElPTl9FTkQsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJlbW92ZUNsYXNzKHRvb2x0aXBCb3gsIENMQVNTX1NIT1cpO1xuICAgICAgICAgICAgcmVtb3ZlQ2xhc3ModG9vbHRpcEJveCwgQ0xBU1NfRkFERSk7XG4gICAgICAgICAgICByZW1vdmVDbGFzcyh0b29sdGlwQm94LCBDTEFTU19UUkFOU0lUSU9OKTtcbiAgICAgICAgICAgIHRvb2x0aXBCb3guc2V0QXR0cmlidXRlKCdhcmlhLWhpZGRlbicsIHRydWUpO1xuICAgICAgICAgICAgX3RoaXMxMS5mYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICB9LCB7XG4gICAgICAgICAgICBvbmNlOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgcmVtb3ZlQ2xhc3ModG9vbHRpcEJveCwgQ0xBU1NfSU4pO1xuICAgICAgICAgIF90aGlzMTEuZmFkaW5nID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZW1vdmVDbGFzcyh0b29sdGlwQm94LCBDTEFTU19TSE9XKTtcbiAgICAgICAgICB0b29sdGlwQm94LnNldEF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nLCB0cnVlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIF90aGlzMTEudG9vbHRpcHBpbmcgPSBmYWxzZTtcbiAgICAgIH0sIDEwMDApO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcbiAgICAvLyBUb2dnbGUgdGhlIGltYWdlIHNpemUgYmV0d2VlbiBpdHMgbmF0dXJhbCBzaXplIGFuZCBpbml0aWFsIHNpemVcbiAgICB0b2dnbGU6IGZ1bmN0aW9uIHRvZ2dsZSgpIHtcbiAgICAgIGlmICh0aGlzLmltYWdlRGF0YS5yYXRpbyA9PT0gMSkge1xuICAgICAgICB0aGlzLnpvb21Ubyh0aGlzLmluaXRpYWxJbWFnZURhdGEucmF0aW8sIHRydWUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy56b29tVG8oMSwgdHJ1ZSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG4gICAgLy8gUmVzZXQgdGhlIGltYWdlIHRvIGl0cyBpbml0aWFsIHN0YXRlXG4gICAgcmVzZXQ6IGZ1bmN0aW9uIHJlc2V0KCkge1xuICAgICAgaWYgKHRoaXMudmlld2VkICYmICF0aGlzLnBsYXllZCkge1xuICAgICAgICB0aGlzLmltYWdlRGF0YSA9IGFzc2lnbih7fSwgdGhpcy5pbml0aWFsSW1hZ2VEYXRhKTtcbiAgICAgICAgdGhpcy5yZW5kZXJJbWFnZSgpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9LFxuICAgIC8vIFVwZGF0ZSB2aWV3ZXIgd2hlbiBpbWFnZXMgY2hhbmdlZFxuICAgIHVwZGF0ZTogZnVuY3Rpb24gdXBkYXRlKCkge1xuICAgICAgdmFyIF90aGlzMTIgPSB0aGlzO1xuXG4gICAgICB2YXIgZWxlbWVudCA9IHRoaXMuZWxlbWVudCxcbiAgICAgICAgICBvcHRpb25zID0gdGhpcy5vcHRpb25zLFxuICAgICAgICAgIGlzSW1nID0gdGhpcy5pc0ltZzsgLy8gRGVzdHJveSB2aWV3ZXIgaWYgdGhlIHRhcmdldCBpbWFnZSB3YXMgZGVsZXRlZFxuXG4gICAgICBpZiAoaXNJbWcgJiYgIWVsZW1lbnQucGFyZW50Tm9kZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5kZXN0cm95KCk7XG4gICAgICB9XG5cbiAgICAgIHZhciBpbWFnZXMgPSBbXTtcbiAgICAgIGZvckVhY2goaXNJbWcgPyBbZWxlbWVudF0gOiBlbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2ltZycpLCBmdW5jdGlvbiAoaW1hZ2UpIHtcbiAgICAgICAgaWYgKGlzRnVuY3Rpb24ob3B0aW9ucy5maWx0ZXIpKSB7XG4gICAgICAgICAgaWYgKG9wdGlvbnMuZmlsdGVyLmNhbGwoX3RoaXMxMiwgaW1hZ2UpKSB7XG4gICAgICAgICAgICBpbWFnZXMucHVzaChpbWFnZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKF90aGlzMTIuZ2V0SW1hZ2VVUkwoaW1hZ2UpKSB7XG4gICAgICAgICAgaW1hZ2VzLnB1c2goaW1hZ2UpO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgaWYgKCFpbWFnZXMubGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmltYWdlcyA9IGltYWdlcztcbiAgICAgIHRoaXMubGVuZ3RoID0gaW1hZ2VzLmxlbmd0aDtcblxuICAgICAgaWYgKHRoaXMucmVhZHkpIHtcbiAgICAgICAgdmFyIGNoYW5nZWRJbmRleGVzID0gW107XG4gICAgICAgIGZvckVhY2godGhpcy5pdGVtcywgZnVuY3Rpb24gKGl0ZW0sIGkpIHtcbiAgICAgICAgICB2YXIgaW1nID0gaXRlbS5xdWVyeVNlbGVjdG9yKCdpbWcnKTtcbiAgICAgICAgICB2YXIgaW1hZ2UgPSBpbWFnZXNbaV07XG5cbiAgICAgICAgICBpZiAoaW1hZ2UgJiYgaW1nKSB7XG4gICAgICAgICAgICBpZiAoaW1hZ2Uuc3JjICE9PSBpbWcuc3JjIC8vIFRpdGxlIGNoYW5nZWQgKCM0MDgpXG4gICAgICAgICAgICB8fCBpbWFnZS5hbHQgIT09IGltZy5hbHQpIHtcbiAgICAgICAgICAgICAgY2hhbmdlZEluZGV4ZXMucHVzaChpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2hhbmdlZEluZGV4ZXMucHVzaChpKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBzZXRTdHlsZSh0aGlzLmxpc3QsIHtcbiAgICAgICAgICB3aWR0aDogJ2F1dG8nXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmluaXRMaXN0KCk7XG5cbiAgICAgICAgaWYgKHRoaXMuaXNTaG93bikge1xuICAgICAgICAgIGlmICh0aGlzLmxlbmd0aCkge1xuICAgICAgICAgICAgaWYgKHRoaXMudmlld2VkKSB7XG4gICAgICAgICAgICAgIHZhciBjaGFuZ2VkSW5kZXggPSBjaGFuZ2VkSW5kZXhlcy5pbmRleE9mKHRoaXMuaW5kZXgpO1xuXG4gICAgICAgICAgICAgIGlmIChjaGFuZ2VkSW5kZXggPj0gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMudmlld2VkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpcy52aWV3KE1hdGgubWF4KE1hdGgubWluKHRoaXMuaW5kZXggLSBjaGFuZ2VkSW5kZXgsIHRoaXMubGVuZ3RoIC0gMSksIDApKTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgYWN0aXZlSXRlbSA9IHRoaXMuaXRlbXNbdGhpcy5pbmRleF07IC8vIFJlYWN0aXZhdGUgdGhlIGN1cnJlbnQgdmlld2luZyBpdGVtIGFmdGVyIHJlc2V0IHRoZSBsaXN0LlxuXG4gICAgICAgICAgICAgICAgYWRkQ2xhc3MoYWN0aXZlSXRlbSwgQ0xBU1NfQUNUSVZFKTtcbiAgICAgICAgICAgICAgICBhY3RpdmVJdGVtLnNldEF0dHJpYnV0ZSgnYXJpYS1zZWxlY3RlZCcsIHRydWUpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuaW1hZ2UgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy52aWV3ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuaW5kZXggPSAwO1xuICAgICAgICAgICAgdGhpcy5pbWFnZURhdGEgPSB7fTtcbiAgICAgICAgICAgIHRoaXMuY2FudmFzLmlubmVySFRNTCA9ICcnO1xuICAgICAgICAgICAgdGhpcy50aXRsZS5pbm5lckhUTUwgPSAnJztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuYnVpbGQoKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSxcbiAgICAvLyBEZXN0cm95IHRoZSB2aWV3ZXJcbiAgICBkZXN0cm95OiBmdW5jdGlvbiBkZXN0cm95KCkge1xuICAgICAgdmFyIGVsZW1lbnQgPSB0aGlzLmVsZW1lbnQsXG4gICAgICAgICAgb3B0aW9ucyA9IHRoaXMub3B0aW9ucztcblxuICAgICAgaWYgKCFlbGVtZW50W05BTUVTUEFDRV0pIHtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuZGVzdHJveWVkID0gdHJ1ZTtcblxuICAgICAgaWYgKHRoaXMucmVhZHkpIHtcbiAgICAgICAgaWYgKHRoaXMucGxheWVkKSB7XG4gICAgICAgICAgdGhpcy5zdG9wKCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAob3B0aW9ucy5pbmxpbmUpIHtcbiAgICAgICAgICBpZiAodGhpcy5mdWxsZWQpIHtcbiAgICAgICAgICAgIHRoaXMuZXhpdCgpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHRoaXMudW5iaW5kKCk7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5pc1Nob3duKSB7XG4gICAgICAgICAgaWYgKHRoaXMudmlld2luZykge1xuICAgICAgICAgICAgaWYgKHRoaXMuaW1hZ2VSZW5kZXJpbmcpIHtcbiAgICAgICAgICAgICAgdGhpcy5pbWFnZVJlbmRlcmluZy5hYm9ydCgpO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmltYWdlSW5pdGlhbGl6aW5nKSB7XG4gICAgICAgICAgICAgIHRoaXMuaW1hZ2VJbml0aWFsaXppbmcuYWJvcnQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAodGhpcy5oaWRpbmcpIHtcbiAgICAgICAgICAgIHRoaXMudHJhbnNpdGlvbmluZy5hYm9ydCgpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHRoaXMuaGlkZGVuKCk7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5zaG93aW5nKSB7XG4gICAgICAgICAgdGhpcy50cmFuc2l0aW9uaW5nLmFib3J0KCk7XG4gICAgICAgICAgdGhpcy5oaWRkZW4oKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMucmVhZHkgPSBmYWxzZTtcbiAgICAgICAgdGhpcy52aWV3ZXIucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLnZpZXdlcik7XG4gICAgICB9IGVsc2UgaWYgKG9wdGlvbnMuaW5saW5lKSB7XG4gICAgICAgIGlmICh0aGlzLmRlbGF5aW5nKSB7XG4gICAgICAgICAgdGhpcy5kZWxheWluZy5hYm9ydCgpO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuaW5pdGlhbGl6aW5nKSB7XG4gICAgICAgICAgdGhpcy5pbml0aWFsaXppbmcuYWJvcnQoKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAoIW9wdGlvbnMuaW5saW5lKSB7XG4gICAgICAgIHJlbW92ZUxpc3RlbmVyKGVsZW1lbnQsIEVWRU5UX0NMSUNLLCB0aGlzLm9uU3RhcnQpO1xuICAgICAgfVxuXG4gICAgICBlbGVtZW50W05BTUVTUEFDRV0gPSB1bmRlZmluZWQ7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gIH07XG5cbiAgdmFyIG90aGVycyA9IHtcbiAgICBnZXRJbWFnZVVSTDogZnVuY3Rpb24gZ2V0SW1hZ2VVUkwoaW1hZ2UpIHtcbiAgICAgIHZhciB1cmwgPSB0aGlzLm9wdGlvbnMudXJsO1xuXG4gICAgICBpZiAoaXNTdHJpbmcodXJsKSkge1xuICAgICAgICB1cmwgPSBpbWFnZS5nZXRBdHRyaWJ1dGUodXJsKTtcbiAgICAgIH0gZWxzZSBpZiAoaXNGdW5jdGlvbih1cmwpKSB7XG4gICAgICAgIHVybCA9IHVybC5jYWxsKHRoaXMsIGltYWdlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHVybCA9ICcnO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdXJsO1xuICAgIH0sXG4gICAgZW5mb3JjZUZvY3VzOiBmdW5jdGlvbiBlbmZvcmNlRm9jdXMoKSB7XG4gICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgICB0aGlzLmNsZWFyRW5mb3JjZUZvY3VzKCk7XG4gICAgICBhZGRMaXN0ZW5lcihkb2N1bWVudCwgRVZFTlRfRk9DVVNJTiwgdGhpcy5vbkZvY3VzaW4gPSBmdW5jdGlvbiAoX3JlZikge1xuICAgICAgICB2YXIgdGFyZ2V0ID0gX3JlZi50YXJnZXQ7XG4gICAgICAgIHZhciB2aWV3ZXIgPSBfdGhpcy52aWV3ZXI7XG5cbiAgICAgICAgaWYgKHRhcmdldCAhPT0gZG9jdW1lbnQgJiYgdGFyZ2V0ICE9PSB2aWV3ZXIgJiYgIXZpZXdlci5jb250YWlucyh0YXJnZXQpKSB7XG4gICAgICAgICAgdmlld2VyLmZvY3VzKCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0sXG4gICAgY2xlYXJFbmZvcmNlRm9jdXM6IGZ1bmN0aW9uIGNsZWFyRW5mb3JjZUZvY3VzKCkge1xuICAgICAgaWYgKHRoaXMub25Gb2N1c2luKSB7XG4gICAgICAgIHJlbW92ZUxpc3RlbmVyKGRvY3VtZW50LCBFVkVOVF9GT0NVU0lOLCB0aGlzLm9uRm9jdXNpbik7XG4gICAgICAgIHRoaXMub25Gb2N1c2luID0gbnVsbDtcbiAgICAgIH1cbiAgICB9LFxuICAgIG9wZW46IGZ1bmN0aW9uIG9wZW4oKSB7XG4gICAgICB2YXIgYm9keSA9IHRoaXMuYm9keTtcbiAgICAgIGFkZENsYXNzKGJvZHksIENMQVNTX09QRU4pO1xuICAgICAgYm9keS5zdHlsZS5wYWRkaW5nUmlnaHQgPSBcIlwiLmNvbmNhdCh0aGlzLnNjcm9sbGJhcldpZHRoICsgKHBhcnNlRmxvYXQodGhpcy5pbml0aWFsQm9keUNvbXB1dGVkUGFkZGluZ1JpZ2h0KSB8fCAwKSwgXCJweFwiKTtcbiAgICB9LFxuICAgIGNsb3NlOiBmdW5jdGlvbiBjbG9zZSgpIHtcbiAgICAgIHZhciBib2R5ID0gdGhpcy5ib2R5O1xuICAgICAgcmVtb3ZlQ2xhc3MoYm9keSwgQ0xBU1NfT1BFTik7XG4gICAgICBib2R5LnN0eWxlLnBhZGRpbmdSaWdodCA9IHRoaXMuaW5pdGlhbEJvZHlQYWRkaW5nUmlnaHQ7XG4gICAgfSxcbiAgICBzaG93bjogZnVuY3Rpb24gc2hvd24oKSB7XG4gICAgICB2YXIgZWxlbWVudCA9IHRoaXMuZWxlbWVudCxcbiAgICAgICAgICBvcHRpb25zID0gdGhpcy5vcHRpb25zLFxuICAgICAgICAgIHZpZXdlciA9IHRoaXMudmlld2VyO1xuICAgICAgdGhpcy5mdWxsZWQgPSB0cnVlO1xuICAgICAgdGhpcy5pc1Nob3duID0gdHJ1ZTtcbiAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgICB0aGlzLmJpbmQoKTtcbiAgICAgIHRoaXMuc2hvd2luZyA9IGZhbHNlO1xuXG4gICAgICBpZiAob3B0aW9ucy5mb2N1cykge1xuICAgICAgICB2aWV3ZXIuZm9jdXMoKTtcbiAgICAgICAgdGhpcy5lbmZvcmNlRm9jdXMoKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGlzRnVuY3Rpb24ob3B0aW9ucy5zaG93bikpIHtcbiAgICAgICAgYWRkTGlzdGVuZXIoZWxlbWVudCwgRVZFTlRfU0hPV04sIG9wdGlvbnMuc2hvd24sIHtcbiAgICAgICAgICBvbmNlOiB0cnVlXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBpZiAoZGlzcGF0Y2hFdmVudChlbGVtZW50LCBFVkVOVF9TSE9XTikgPT09IGZhbHNlKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMucmVhZHkgJiYgdGhpcy5pc1Nob3duICYmICF0aGlzLmhpZGluZykge1xuICAgICAgICB0aGlzLnZpZXcodGhpcy5pbmRleCk7XG4gICAgICB9XG4gICAgfSxcbiAgICBoaWRkZW46IGZ1bmN0aW9uIGhpZGRlbigpIHtcbiAgICAgIHZhciBlbGVtZW50ID0gdGhpcy5lbGVtZW50LFxuICAgICAgICAgIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnMsXG4gICAgICAgICAgdmlld2VyID0gdGhpcy52aWV3ZXI7XG5cbiAgICAgIGlmIChvcHRpb25zLmZ1Y3VzKSB7XG4gICAgICAgIHRoaXMuY2xlYXJFbmZvcmNlRm9jdXMoKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5mdWxsZWQgPSBmYWxzZTtcbiAgICAgIHRoaXMudmlld2VkID0gZmFsc2U7XG4gICAgICB0aGlzLmlzU2hvd24gPSBmYWxzZTtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgIHRoaXMudW5iaW5kKCk7XG4gICAgICBhZGRDbGFzcyh2aWV3ZXIsIENMQVNTX0hJREUpO1xuICAgICAgdmlld2VyLnJlbW92ZUF0dHJpYnV0ZSgncm9sZScpO1xuICAgICAgdmlld2VyLnJlbW92ZUF0dHJpYnV0ZSgnYXJpYS1sYWJlbGxlZGJ5Jyk7XG4gICAgICB2aWV3ZXIucmVtb3ZlQXR0cmlidXRlKCdhcmlhLW1vZGFsJyk7XG4gICAgICB2aWV3ZXIuc2V0QXR0cmlidXRlKCdhcmlhLWhpZGRlbicsIHRydWUpO1xuICAgICAgdGhpcy5yZXNldExpc3QoKTtcbiAgICAgIHRoaXMucmVzZXRJbWFnZSgpO1xuICAgICAgdGhpcy5oaWRpbmcgPSBmYWxzZTtcblxuICAgICAgaWYgKCF0aGlzLmRlc3Ryb3llZCkge1xuICAgICAgICBpZiAoaXNGdW5jdGlvbihvcHRpb25zLmhpZGRlbikpIHtcbiAgICAgICAgICBhZGRMaXN0ZW5lcihlbGVtZW50LCBFVkVOVF9ISURERU4sIG9wdGlvbnMuaGlkZGVuLCB7XG4gICAgICAgICAgICBvbmNlOiB0cnVlXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBkaXNwYXRjaEV2ZW50KGVsZW1lbnQsIEVWRU5UX0hJRERFTiwgbnVsbCwge1xuICAgICAgICAgIGNhbmNlbGFibGU6IGZhbHNlXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0sXG4gICAgcmVxdWVzdEZ1bGxzY3JlZW46IGZ1bmN0aW9uIHJlcXVlc3RGdWxsc2NyZWVuKCkge1xuICAgICAgdmFyIGRvY3VtZW50ID0gdGhpcy5lbGVtZW50Lm93bmVyRG9jdW1lbnQ7XG5cbiAgICAgIGlmICh0aGlzLmZ1bGxlZCAmJiAhKGRvY3VtZW50LmZ1bGxzY3JlZW5FbGVtZW50IHx8IGRvY3VtZW50LndlYmtpdEZ1bGxzY3JlZW5FbGVtZW50IHx8IGRvY3VtZW50Lm1vekZ1bGxTY3JlZW5FbGVtZW50IHx8IGRvY3VtZW50Lm1zRnVsbHNjcmVlbkVsZW1lbnQpKSB7XG4gICAgICAgIHZhciBkb2N1bWVudEVsZW1lbnQgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7IC8vIEVsZW1lbnQucmVxdWVzdEZ1bGxzY3JlZW4oKVxuXG4gICAgICAgIGlmIChkb2N1bWVudEVsZW1lbnQucmVxdWVzdEZ1bGxzY3JlZW4pIHtcbiAgICAgICAgICBkb2N1bWVudEVsZW1lbnQucmVxdWVzdEZ1bGxzY3JlZW4oKTtcbiAgICAgICAgfSBlbHNlIGlmIChkb2N1bWVudEVsZW1lbnQud2Via2l0UmVxdWVzdEZ1bGxzY3JlZW4pIHtcbiAgICAgICAgICBkb2N1bWVudEVsZW1lbnQud2Via2l0UmVxdWVzdEZ1bGxzY3JlZW4oRWxlbWVudC5BTExPV19LRVlCT0FSRF9JTlBVVCk7XG4gICAgICAgIH0gZWxzZSBpZiAoZG9jdW1lbnRFbGVtZW50Lm1velJlcXVlc3RGdWxsU2NyZWVuKSB7XG4gICAgICAgICAgZG9jdW1lbnRFbGVtZW50Lm1velJlcXVlc3RGdWxsU2NyZWVuKCk7XG4gICAgICAgIH0gZWxzZSBpZiAoZG9jdW1lbnRFbGVtZW50Lm1zUmVxdWVzdEZ1bGxzY3JlZW4pIHtcbiAgICAgICAgICBkb2N1bWVudEVsZW1lbnQubXNSZXF1ZXN0RnVsbHNjcmVlbigpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcbiAgICBleGl0RnVsbHNjcmVlbjogZnVuY3Rpb24gZXhpdEZ1bGxzY3JlZW4oKSB7XG4gICAgICB2YXIgZG9jdW1lbnQgPSB0aGlzLmVsZW1lbnQub3duZXJEb2N1bWVudDtcblxuICAgICAgaWYgKHRoaXMuZnVsbGVkICYmIChkb2N1bWVudC5mdWxsc2NyZWVuRWxlbWVudCB8fCBkb2N1bWVudC53ZWJraXRGdWxsc2NyZWVuRWxlbWVudCB8fCBkb2N1bWVudC5tb3pGdWxsU2NyZWVuRWxlbWVudCB8fCBkb2N1bWVudC5tc0Z1bGxzY3JlZW5FbGVtZW50KSkge1xuICAgICAgICAvLyBEb2N1bWVudC5leGl0RnVsbHNjcmVlbigpXG4gICAgICAgIGlmIChkb2N1bWVudC5leGl0RnVsbHNjcmVlbikge1xuICAgICAgICAgIGRvY3VtZW50LmV4aXRGdWxsc2NyZWVuKCk7XG4gICAgICAgIH0gZWxzZSBpZiAoZG9jdW1lbnQud2Via2l0RXhpdEZ1bGxzY3JlZW4pIHtcbiAgICAgICAgICBkb2N1bWVudC53ZWJraXRFeGl0RnVsbHNjcmVlbigpO1xuICAgICAgICB9IGVsc2UgaWYgKGRvY3VtZW50Lm1vekNhbmNlbEZ1bGxTY3JlZW4pIHtcbiAgICAgICAgICBkb2N1bWVudC5tb3pDYW5jZWxGdWxsU2NyZWVuKCk7XG4gICAgICAgIH0gZWxzZSBpZiAoZG9jdW1lbnQubXNFeGl0RnVsbHNjcmVlbikge1xuICAgICAgICAgIGRvY3VtZW50Lm1zRXhpdEZ1bGxzY3JlZW4oKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG4gICAgY2hhbmdlOiBmdW5jdGlvbiBjaGFuZ2UoZXZlbnQpIHtcbiAgICAgIHZhciBvcHRpb25zID0gdGhpcy5vcHRpb25zLFxuICAgICAgICAgIHBvaW50ZXJzID0gdGhpcy5wb2ludGVycztcbiAgICAgIHZhciBwb2ludGVyID0gcG9pbnRlcnNbT2JqZWN0LmtleXMocG9pbnRlcnMpWzBdXTsgLy8gSW4gdGhlIGNhc2Ugb2YgdGhlIGBwb2ludGVyc2Agb2JqZWN0IGlzIGVtcHR5ICgjNDIxKVxuXG4gICAgICBpZiAoIXBvaW50ZXIpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB2YXIgb2Zmc2V0WCA9IHBvaW50ZXIuZW5kWCAtIHBvaW50ZXIuc3RhcnRYO1xuICAgICAgdmFyIG9mZnNldFkgPSBwb2ludGVyLmVuZFkgLSBwb2ludGVyLnN0YXJ0WTtcblxuICAgICAgc3dpdGNoICh0aGlzLmFjdGlvbikge1xuICAgICAgICAvLyBNb3ZlIHRoZSBjdXJyZW50IGltYWdlXG4gICAgICAgIGNhc2UgQUNUSU9OX01PVkU6XG4gICAgICAgICAgdGhpcy5tb3ZlKG9mZnNldFgsIG9mZnNldFksIGV2ZW50KTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgLy8gWm9vbSB0aGUgY3VycmVudCBpbWFnZVxuXG4gICAgICAgIGNhc2UgQUNUSU9OX1pPT006XG4gICAgICAgICAgdGhpcy56b29tKGdldE1heFpvb21SYXRpbyhwb2ludGVycyksIGZhbHNlLCBldmVudCk7XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSBBQ1RJT05fU1dJVENIOlxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuYWN0aW9uID0gJ3N3aXRjaGVkJztcbiAgICAgICAgICAgIHZhciBhYnNvbHV0ZU9mZnNldFggPSBNYXRoLmFicyhvZmZzZXRYKTtcblxuICAgICAgICAgICAgaWYgKGFic29sdXRlT2Zmc2V0WCA+IDEgJiYgYWJzb2x1dGVPZmZzZXRYID4gTWF0aC5hYnMob2Zmc2V0WSkpIHtcbiAgICAgICAgICAgICAgLy8gRW1wdHkgYHBvaW50ZXJzYCBhcyBgdG91Y2hlbmRgIGV2ZW50IHdpbGwgbm90IGJlIGZpcmVkIGFmdGVyIHN3aXBlZCBpbiBpT1MgYnJvd3NlcnMuXG4gICAgICAgICAgICAgIHRoaXMucG9pbnRlcnMgPSB7fTtcblxuICAgICAgICAgICAgICBpZiAob2Zmc2V0WCA+IDEpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByZXYob3B0aW9ucy5sb29wKTtcbiAgICAgICAgICAgICAgfSBlbHNlIGlmIChvZmZzZXRYIDwgLTEpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm5leHQob3B0aW9ucy5sb29wKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICB9IC8vIE92ZXJyaWRlXG5cblxuICAgICAgZm9yRWFjaChwb2ludGVycywgZnVuY3Rpb24gKHApIHtcbiAgICAgICAgcC5zdGFydFggPSBwLmVuZFg7XG4gICAgICAgIHAuc3RhcnRZID0gcC5lbmRZO1xuICAgICAgfSk7XG4gICAgfSxcbiAgICBpc1N3aXRjaGFibGU6IGZ1bmN0aW9uIGlzU3dpdGNoYWJsZSgpIHtcbiAgICAgIHZhciBpbWFnZURhdGEgPSB0aGlzLmltYWdlRGF0YSxcbiAgICAgICAgICB2aWV3ZXJEYXRhID0gdGhpcy52aWV3ZXJEYXRhO1xuICAgICAgcmV0dXJuIHRoaXMubGVuZ3RoID4gMSAmJiBpbWFnZURhdGEueCA+PSAwICYmIGltYWdlRGF0YS55ID49IDAgJiYgaW1hZ2VEYXRhLndpZHRoIDw9IHZpZXdlckRhdGEud2lkdGggJiYgaW1hZ2VEYXRhLmhlaWdodCA8PSB2aWV3ZXJEYXRhLmhlaWdodDtcbiAgICB9XG4gIH07XG5cbiAgdmFyIEFub3RoZXJWaWV3ZXIgPSBXSU5ET1cuVmlld2VyO1xuXG4gIHZhciBnZXRVbmlxdWVJRCA9IGZ1bmN0aW9uIChpZCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICBpZCArPSAxO1xuICAgICAgcmV0dXJuIGlkO1xuICAgIH07XG4gIH0oLTEpO1xuXG4gIHZhciBWaWV3ZXIgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhIG5ldyBWaWV3ZXIuXG4gICAgICogQHBhcmFtIHtFbGVtZW50fSBlbGVtZW50IC0gVGhlIHRhcmdldCBlbGVtZW50IGZvciB2aWV3aW5nLlxuICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9ucz17fV0gLSBUaGUgY29uZmlndXJhdGlvbiBvcHRpb25zLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIFZpZXdlcihlbGVtZW50KSB7XG4gICAgICB2YXIgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge307XG5cbiAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBWaWV3ZXIpO1xuXG4gICAgICBpZiAoIWVsZW1lbnQgfHwgZWxlbWVudC5ub2RlVHlwZSAhPT0gMSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBmaXJzdCBhcmd1bWVudCBpcyByZXF1aXJlZCBhbmQgbXVzdCBiZSBhbiBlbGVtZW50LicpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xuICAgICAgdGhpcy5vcHRpb25zID0gYXNzaWduKHt9LCBERUZBVUxUUywgaXNQbGFpbk9iamVjdChvcHRpb25zKSAmJiBvcHRpb25zKTtcbiAgICAgIHRoaXMuYWN0aW9uID0gZmFsc2U7XG4gICAgICB0aGlzLmZhZGluZyA9IGZhbHNlO1xuICAgICAgdGhpcy5mdWxsZWQgPSBmYWxzZTtcbiAgICAgIHRoaXMuaGlkaW5nID0gZmFsc2U7XG4gICAgICB0aGlzLmltYWdlQ2xpY2tlZCA9IGZhbHNlO1xuICAgICAgdGhpcy5pbWFnZURhdGEgPSB7fTtcbiAgICAgIHRoaXMuaW5kZXggPSB0aGlzLm9wdGlvbnMuaW5pdGlhbFZpZXdJbmRleDtcbiAgICAgIHRoaXMuaXNJbWcgPSBmYWxzZTtcbiAgICAgIHRoaXMuaXNTaG93biA9IGZhbHNlO1xuICAgICAgdGhpcy5sZW5ndGggPSAwO1xuICAgICAgdGhpcy5tb3ZpbmcgPSBmYWxzZTtcbiAgICAgIHRoaXMucGxheWVkID0gZmFsc2U7XG4gICAgICB0aGlzLnBsYXlpbmcgPSBmYWxzZTtcbiAgICAgIHRoaXMucG9pbnRlcnMgPSB7fTtcbiAgICAgIHRoaXMucmVhZHkgPSBmYWxzZTtcbiAgICAgIHRoaXMucm90YXRpbmcgPSBmYWxzZTtcbiAgICAgIHRoaXMuc2NhbGluZyA9IGZhbHNlO1xuICAgICAgdGhpcy5zaG93aW5nID0gZmFsc2U7XG4gICAgICB0aGlzLnRpbWVvdXQgPSBmYWxzZTtcbiAgICAgIHRoaXMudG9vbHRpcHBpbmcgPSBmYWxzZTtcbiAgICAgIHRoaXMudmlld2VkID0gZmFsc2U7XG4gICAgICB0aGlzLnZpZXdpbmcgPSBmYWxzZTtcbiAgICAgIHRoaXMud2hlZWxpbmcgPSBmYWxzZTtcbiAgICAgIHRoaXMuem9vbWluZyA9IGZhbHNlO1xuICAgICAgdGhpcy5pZCA9IGdldFVuaXF1ZUlEKCk7XG4gICAgICB0aGlzLmluaXQoKTtcbiAgICB9XG5cbiAgICBfY3JlYXRlQ2xhc3MoVmlld2VyLCBbe1xuICAgICAga2V5OiBcImluaXRcIixcbiAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgICAgIHZhciBlbGVtZW50ID0gdGhpcy5lbGVtZW50LFxuICAgICAgICAgICAgb3B0aW9ucyA9IHRoaXMub3B0aW9ucztcblxuICAgICAgICBpZiAoZWxlbWVudFtOQU1FU1BBQ0VdKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgZWxlbWVudFtOQU1FU1BBQ0VdID0gdGhpczsgLy8gVGhlIGBmb2N1c2Agb3B0aW9uIHJlcXVpcmVzIHRoZSBga2V5Ym9hcmRgIG9wdGlvbiBzZXQgdG8gYHRydWVgLlxuXG4gICAgICAgIGlmIChvcHRpb25zLmZvY3VzICYmICFvcHRpb25zLmtleWJvYXJkKSB7XG4gICAgICAgICAgb3B0aW9ucy5mb2N1cyA9IGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGlzSW1nID0gZWxlbWVudC5sb2NhbE5hbWUgPT09ICdpbWcnO1xuICAgICAgICB2YXIgaW1hZ2VzID0gW107XG4gICAgICAgIGZvckVhY2goaXNJbWcgPyBbZWxlbWVudF0gOiBlbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2ltZycpLCBmdW5jdGlvbiAoaW1hZ2UpIHtcbiAgICAgICAgICBpZiAoaXNGdW5jdGlvbihvcHRpb25zLmZpbHRlcikpIHtcbiAgICAgICAgICAgIGlmIChvcHRpb25zLmZpbHRlci5jYWxsKF90aGlzLCBpbWFnZSkpIHtcbiAgICAgICAgICAgICAgaW1hZ2VzLnB1c2goaW1hZ2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSBpZiAoX3RoaXMuZ2V0SW1hZ2VVUkwoaW1hZ2UpKSB7XG4gICAgICAgICAgICBpbWFnZXMucHVzaChpbWFnZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5pc0ltZyA9IGlzSW1nO1xuICAgICAgICB0aGlzLmxlbmd0aCA9IGltYWdlcy5sZW5ndGg7XG4gICAgICAgIHRoaXMuaW1hZ2VzID0gaW1hZ2VzO1xuICAgICAgICB0aGlzLmluaXRCb2R5KCk7IC8vIE92ZXJyaWRlIGB0cmFuc2l0aW9uYCBvcHRpb24gaWYgaXQgaXMgbm90IHN1cHBvcnRlZFxuXG4gICAgICAgIGlmIChpc1VuZGVmaW5lZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KE5BTUVTUEFDRSkuc3R5bGUudHJhbnNpdGlvbikpIHtcbiAgICAgICAgICBvcHRpb25zLnRyYW5zaXRpb24gPSBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChvcHRpb25zLmlubGluZSkge1xuICAgICAgICAgIHZhciBjb3VudCA9IDA7XG5cbiAgICAgICAgICB2YXIgcHJvZ3Jlc3MgPSBmdW5jdGlvbiBwcm9ncmVzcygpIHtcbiAgICAgICAgICAgIGNvdW50ICs9IDE7XG5cbiAgICAgICAgICAgIGlmIChjb3VudCA9PT0gX3RoaXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgIHZhciB0aW1lb3V0O1xuICAgICAgICAgICAgICBfdGhpcy5pbml0aWFsaXppbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgX3RoaXMuZGVsYXlpbmcgPSB7XG4gICAgICAgICAgICAgICAgYWJvcnQ6IGZ1bmN0aW9uIGFib3J0KCkge1xuICAgICAgICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfTsgLy8gYnVpbGQgYXN5bmNocm9ub3VzbHkgdG8ga2VlcCBgdGhpcy52aWV3ZXJgIGlzIGFjY2Vzc2libGUgaW4gYHJlYWR5YCBldmVudCBoYW5kbGVyLlxuXG4gICAgICAgICAgICAgIHRpbWVvdXQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5kZWxheWluZyA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgX3RoaXMuYnVpbGQoKTtcbiAgICAgICAgICAgICAgfSwgMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfTtcblxuICAgICAgICAgIHRoaXMuaW5pdGlhbGl6aW5nID0ge1xuICAgICAgICAgICAgYWJvcnQ6IGZ1bmN0aW9uIGFib3J0KCkge1xuICAgICAgICAgICAgICBmb3JFYWNoKGltYWdlcywgZnVuY3Rpb24gKGltYWdlKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFpbWFnZS5jb21wbGV0ZSkge1xuICAgICAgICAgICAgICAgICAgcmVtb3ZlTGlzdGVuZXIoaW1hZ2UsIEVWRU5UX0xPQUQsIHByb2dyZXNzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH07XG4gICAgICAgICAgZm9yRWFjaChpbWFnZXMsIGZ1bmN0aW9uIChpbWFnZSkge1xuICAgICAgICAgICAgaWYgKGltYWdlLmNvbXBsZXRlKSB7XG4gICAgICAgICAgICAgIHByb2dyZXNzKCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBhZGRMaXN0ZW5lcihpbWFnZSwgRVZFTlRfTE9BRCwgcHJvZ3Jlc3MsIHtcbiAgICAgICAgICAgICAgICBvbmNlOiB0cnVlXG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGFkZExpc3RlbmVyKGVsZW1lbnQsIEVWRU5UX0NMSUNLLCB0aGlzLm9uU3RhcnQgPSBmdW5jdGlvbiAoX3JlZikge1xuICAgICAgICAgICAgdmFyIHRhcmdldCA9IF9yZWYudGFyZ2V0O1xuXG4gICAgICAgICAgICBpZiAodGFyZ2V0LmxvY2FsTmFtZSA9PT0gJ2ltZycgJiYgKCFpc0Z1bmN0aW9uKG9wdGlvbnMuZmlsdGVyKSB8fCBvcHRpb25zLmZpbHRlci5jYWxsKF90aGlzLCB0YXJnZXQpKSkge1xuICAgICAgICAgICAgICBfdGhpcy52aWV3KF90aGlzLmltYWdlcy5pbmRleE9mKHRhcmdldCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSwge1xuICAgICAga2V5OiBcImJ1aWxkXCIsXG4gICAgICB2YWx1ZTogZnVuY3Rpb24gYnVpbGQoKSB7XG4gICAgICAgIGlmICh0aGlzLnJlYWR5KSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGVsZW1lbnQgPSB0aGlzLmVsZW1lbnQsXG4gICAgICAgICAgICBvcHRpb25zID0gdGhpcy5vcHRpb25zO1xuICAgICAgICB2YXIgcGFyZW50ID0gZWxlbWVudC5wYXJlbnROb2RlO1xuICAgICAgICB2YXIgdGVtcGxhdGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgdGVtcGxhdGUuaW5uZXJIVE1MID0gVEVNUExBVEU7XG4gICAgICAgIHZhciB2aWV3ZXIgPSB0ZW1wbGF0ZS5xdWVyeVNlbGVjdG9yKFwiLlwiLmNvbmNhdChOQU1FU1BBQ0UsIFwiLWNvbnRhaW5lclwiKSk7XG4gICAgICAgIHZhciB0aXRsZSA9IHZpZXdlci5xdWVyeVNlbGVjdG9yKFwiLlwiLmNvbmNhdChOQU1FU1BBQ0UsIFwiLXRpdGxlXCIpKTtcbiAgICAgICAgdmFyIHRvb2xiYXIgPSB2aWV3ZXIucXVlcnlTZWxlY3RvcihcIi5cIi5jb25jYXQoTkFNRVNQQUNFLCBcIi10b29sYmFyXCIpKTtcbiAgICAgICAgdmFyIG5hdmJhciA9IHZpZXdlci5xdWVyeVNlbGVjdG9yKFwiLlwiLmNvbmNhdChOQU1FU1BBQ0UsIFwiLW5hdmJhclwiKSk7XG4gICAgICAgIHZhciBidXR0b24gPSB2aWV3ZXIucXVlcnlTZWxlY3RvcihcIi5cIi5jb25jYXQoTkFNRVNQQUNFLCBcIi1idXR0b25cIikpO1xuICAgICAgICB2YXIgY2FudmFzID0gdmlld2VyLnF1ZXJ5U2VsZWN0b3IoXCIuXCIuY29uY2F0KE5BTUVTUEFDRSwgXCItY2FudmFzXCIpKTtcbiAgICAgICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG4gICAgICAgIHRoaXMudmlld2VyID0gdmlld2VyO1xuICAgICAgICB0aGlzLnRpdGxlID0gdGl0bGU7XG4gICAgICAgIHRoaXMudG9vbGJhciA9IHRvb2xiYXI7XG4gICAgICAgIHRoaXMubmF2YmFyID0gbmF2YmFyO1xuICAgICAgICB0aGlzLmJ1dHRvbiA9IGJ1dHRvbjtcbiAgICAgICAgdGhpcy5jYW52YXMgPSBjYW52YXM7XG4gICAgICAgIHRoaXMuZm9vdGVyID0gdmlld2VyLnF1ZXJ5U2VsZWN0b3IoXCIuXCIuY29uY2F0KE5BTUVTUEFDRSwgXCItZm9vdGVyXCIpKTtcbiAgICAgICAgdGhpcy50b29sdGlwQm94ID0gdmlld2VyLnF1ZXJ5U2VsZWN0b3IoXCIuXCIuY29uY2F0KE5BTUVTUEFDRSwgXCItdG9vbHRpcFwiKSk7XG4gICAgICAgIHRoaXMucGxheWVyID0gdmlld2VyLnF1ZXJ5U2VsZWN0b3IoXCIuXCIuY29uY2F0KE5BTUVTUEFDRSwgXCItcGxheWVyXCIpKTtcbiAgICAgICAgdGhpcy5saXN0ID0gdmlld2VyLnF1ZXJ5U2VsZWN0b3IoXCIuXCIuY29uY2F0KE5BTUVTUEFDRSwgXCItbGlzdFwiKSk7XG4gICAgICAgIHZpZXdlci5pZCA9IFwiXCIuY29uY2F0KE5BTUVTUEFDRSkuY29uY2F0KHRoaXMuaWQpO1xuICAgICAgICB0aXRsZS5pZCA9IFwiXCIuY29uY2F0KE5BTUVTUEFDRSwgXCJUaXRsZVwiKS5jb25jYXQodGhpcy5pZCk7XG4gICAgICAgIGFkZENsYXNzKHRpdGxlLCAhb3B0aW9ucy50aXRsZSA/IENMQVNTX0hJREUgOiBnZXRSZXNwb25zaXZlQ2xhc3MoQXJyYXkuaXNBcnJheShvcHRpb25zLnRpdGxlKSA/IG9wdGlvbnMudGl0bGVbMF0gOiBvcHRpb25zLnRpdGxlKSk7XG4gICAgICAgIGFkZENsYXNzKG5hdmJhciwgIW9wdGlvbnMubmF2YmFyID8gQ0xBU1NfSElERSA6IGdldFJlc3BvbnNpdmVDbGFzcyhvcHRpb25zLm5hdmJhcikpO1xuICAgICAgICB0b2dnbGVDbGFzcyhidXR0b24sIENMQVNTX0hJREUsICFvcHRpb25zLmJ1dHRvbik7XG5cbiAgICAgICAgaWYgKG9wdGlvbnMua2V5Ym9hcmQpIHtcbiAgICAgICAgICBidXR0b24uc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsIDApO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG9wdGlvbnMuYmFja2Ryb3ApIHtcbiAgICAgICAgICBhZGRDbGFzcyh2aWV3ZXIsIFwiXCIuY29uY2F0KE5BTUVTUEFDRSwgXCItYmFja2Ryb3BcIikpO1xuXG4gICAgICAgICAgaWYgKCFvcHRpb25zLmlubGluZSAmJiBvcHRpb25zLmJhY2tkcm9wICE9PSAnc3RhdGljJykge1xuICAgICAgICAgICAgc2V0RGF0YShjYW52YXMsIERBVEFfQUNUSU9OLCAnaGlkZScpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChpc1N0cmluZyhvcHRpb25zLmNsYXNzTmFtZSkgJiYgb3B0aW9ucy5jbGFzc05hbWUpIHtcbiAgICAgICAgICAvLyBJbiBjYXNlIHRoZXJlIGFyZSBtdWx0aXBsZSBjbGFzcyBuYW1lc1xuICAgICAgICAgIG9wdGlvbnMuY2xhc3NOYW1lLnNwbGl0KFJFR0VYUF9TUEFDRVMpLmZvckVhY2goZnVuY3Rpb24gKGNsYXNzTmFtZSkge1xuICAgICAgICAgICAgYWRkQ2xhc3Modmlld2VyLCBjbGFzc05hbWUpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG9wdGlvbnMudG9vbGJhcikge1xuICAgICAgICAgIHZhciBsaXN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndWwnKTtcbiAgICAgICAgICB2YXIgY3VzdG9tID0gaXNQbGFpbk9iamVjdChvcHRpb25zLnRvb2xiYXIpO1xuICAgICAgICAgIHZhciB6b29tQnV0dG9ucyA9IEJVVFRPTlMuc2xpY2UoMCwgMyk7XG4gICAgICAgICAgdmFyIHJvdGF0ZUJ1dHRvbnMgPSBCVVRUT05TLnNsaWNlKDcsIDkpO1xuICAgICAgICAgIHZhciBzY2FsZUJ1dHRvbnMgPSBCVVRUT05TLnNsaWNlKDkpO1xuXG4gICAgICAgICAgaWYgKCFjdXN0b20pIHtcbiAgICAgICAgICAgIGFkZENsYXNzKHRvb2xiYXIsIGdldFJlc3BvbnNpdmVDbGFzcyhvcHRpb25zLnRvb2xiYXIpKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBmb3JFYWNoKGN1c3RvbSA/IG9wdGlvbnMudG9vbGJhciA6IEJVVFRPTlMsIGZ1bmN0aW9uICh2YWx1ZSwgaW5kZXgpIHtcbiAgICAgICAgICAgIHZhciBkZWVwID0gY3VzdG9tICYmIGlzUGxhaW5PYmplY3QodmFsdWUpO1xuICAgICAgICAgICAgdmFyIG5hbWUgPSBjdXN0b20gPyBoeXBoZW5hdGUoaW5kZXgpIDogdmFsdWU7XG4gICAgICAgICAgICB2YXIgc2hvdyA9IGRlZXAgJiYgIWlzVW5kZWZpbmVkKHZhbHVlLnNob3cpID8gdmFsdWUuc2hvdyA6IHZhbHVlO1xuXG4gICAgICAgICAgICBpZiAoIXNob3cgfHwgIW9wdGlvbnMuem9vbWFibGUgJiYgem9vbUJ1dHRvbnMuaW5kZXhPZihuYW1lKSAhPT0gLTEgfHwgIW9wdGlvbnMucm90YXRhYmxlICYmIHJvdGF0ZUJ1dHRvbnMuaW5kZXhPZihuYW1lKSAhPT0gLTEgfHwgIW9wdGlvbnMuc2NhbGFibGUgJiYgc2NhbGVCdXR0b25zLmluZGV4T2YobmFtZSkgIT09IC0xKSB7XG4gICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHNpemUgPSBkZWVwICYmICFpc1VuZGVmaW5lZCh2YWx1ZS5zaXplKSA/IHZhbHVlLnNpemUgOiB2YWx1ZTtcbiAgICAgICAgICAgIHZhciBjbGljayA9IGRlZXAgJiYgIWlzVW5kZWZpbmVkKHZhbHVlLmNsaWNrKSA/IHZhbHVlLmNsaWNrIDogdmFsdWU7XG4gICAgICAgICAgICB2YXIgaXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XG5cbiAgICAgICAgICAgIGlmIChvcHRpb25zLmtleWJvYXJkKSB7XG4gICAgICAgICAgICAgIGl0ZW0uc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsIDApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpdGVtLnNldEF0dHJpYnV0ZSgncm9sZScsICdidXR0b24nKTtcbiAgICAgICAgICAgIGFkZENsYXNzKGl0ZW0sIFwiXCIuY29uY2F0KE5BTUVTUEFDRSwgXCItXCIpLmNvbmNhdChuYW1lKSk7XG5cbiAgICAgICAgICAgIGlmICghaXNGdW5jdGlvbihjbGljaykpIHtcbiAgICAgICAgICAgICAgc2V0RGF0YShpdGVtLCBEQVRBX0FDVElPTiwgbmFtZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChpc051bWJlcihzaG93KSkge1xuICAgICAgICAgICAgICBhZGRDbGFzcyhpdGVtLCBnZXRSZXNwb25zaXZlQ2xhc3Moc2hvdykpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoWydzbWFsbCcsICdsYXJnZSddLmluZGV4T2Yoc2l6ZSkgIT09IC0xKSB7XG4gICAgICAgICAgICAgIGFkZENsYXNzKGl0ZW0sIFwiXCIuY29uY2F0KE5BTUVTUEFDRSwgXCItXCIpLmNvbmNhdChzaXplKSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKG5hbWUgPT09ICdwbGF5Jykge1xuICAgICAgICAgICAgICBhZGRDbGFzcyhpdGVtLCBcIlwiLmNvbmNhdChOQU1FU1BBQ0UsIFwiLWxhcmdlXCIpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGlzRnVuY3Rpb24oY2xpY2spKSB7XG4gICAgICAgICAgICAgIGFkZExpc3RlbmVyKGl0ZW0sIEVWRU5UX0NMSUNLLCBjbGljayk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGxpc3QuYXBwZW5kQ2hpbGQoaXRlbSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgdG9vbGJhci5hcHBlbmRDaGlsZChsaXN0KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBhZGRDbGFzcyh0b29sYmFyLCBDTEFTU19ISURFKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghb3B0aW9ucy5yb3RhdGFibGUpIHtcbiAgICAgICAgICB2YXIgcm90YXRlcyA9IHRvb2xiYXIucXVlcnlTZWxlY3RvckFsbCgnbGlbY2xhc3MqPVwicm90YXRlXCJdJyk7XG4gICAgICAgICAgYWRkQ2xhc3Mocm90YXRlcywgQ0xBU1NfSU5WSVNJQkxFKTtcbiAgICAgICAgICBmb3JFYWNoKHJvdGF0ZXMsIGZ1bmN0aW9uIChyb3RhdGUpIHtcbiAgICAgICAgICAgIHRvb2xiYXIuYXBwZW5kQ2hpbGQocm90YXRlKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChvcHRpb25zLmlubGluZSkge1xuICAgICAgICAgIGFkZENsYXNzKGJ1dHRvbiwgQ0xBU1NfRlVMTFNDUkVFTik7XG4gICAgICAgICAgc2V0U3R5bGUodmlld2VyLCB7XG4gICAgICAgICAgICB6SW5kZXg6IG9wdGlvbnMuekluZGV4SW5saW5lXG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBpZiAod2luZG93LmdldENvbXB1dGVkU3R5bGUocGFyZW50KS5wb3NpdGlvbiA9PT0gJ3N0YXRpYycpIHtcbiAgICAgICAgICAgIHNldFN0eWxlKHBhcmVudCwge1xuICAgICAgICAgICAgICBwb3NpdGlvbjogJ3JlbGF0aXZlJ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcGFyZW50Lmluc2VydEJlZm9yZSh2aWV3ZXIsIGVsZW1lbnQubmV4dFNpYmxpbmcpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGFkZENsYXNzKGJ1dHRvbiwgQ0xBU1NfQ0xPU0UpO1xuICAgICAgICAgIGFkZENsYXNzKHZpZXdlciwgQ0xBU1NfRklYRUQpO1xuICAgICAgICAgIGFkZENsYXNzKHZpZXdlciwgQ0xBU1NfRkFERSk7XG4gICAgICAgICAgYWRkQ2xhc3Modmlld2VyLCBDTEFTU19ISURFKTtcbiAgICAgICAgICBzZXRTdHlsZSh2aWV3ZXIsIHtcbiAgICAgICAgICAgIHpJbmRleDogb3B0aW9ucy56SW5kZXhcbiAgICAgICAgICB9KTtcbiAgICAgICAgICB2YXIgY29udGFpbmVyID0gb3B0aW9ucy5jb250YWluZXI7XG5cbiAgICAgICAgICBpZiAoaXNTdHJpbmcoY29udGFpbmVyKSkge1xuICAgICAgICAgICAgY29udGFpbmVyID0gZWxlbWVudC5vd25lckRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoIWNvbnRhaW5lcikge1xuICAgICAgICAgICAgY29udGFpbmVyID0gdGhpcy5ib2R5O1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZCh2aWV3ZXIpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG9wdGlvbnMuaW5saW5lKSB7XG4gICAgICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICAgICAgICB0aGlzLmJpbmQoKTtcbiAgICAgICAgICB0aGlzLmlzU2hvd24gPSB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5yZWFkeSA9IHRydWU7XG5cbiAgICAgICAgaWYgKGlzRnVuY3Rpb24ob3B0aW9ucy5yZWFkeSkpIHtcbiAgICAgICAgICBhZGRMaXN0ZW5lcihlbGVtZW50LCBFVkVOVF9SRUFEWSwgb3B0aW9ucy5yZWFkeSwge1xuICAgICAgICAgICAgb25jZTogdHJ1ZVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGRpc3BhdGNoRXZlbnQoZWxlbWVudCwgRVZFTlRfUkVBRFkpID09PSBmYWxzZSkge1xuICAgICAgICAgIHRoaXMucmVhZHkgPSBmYWxzZTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5yZWFkeSAmJiBvcHRpb25zLmlubGluZSkge1xuICAgICAgICAgIHRoaXMudmlldyh0aGlzLmluZGV4KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgLyoqXG4gICAgICAgKiBHZXQgdGhlIG5vIGNvbmZsaWN0IHZpZXdlciBjbGFzcy5cbiAgICAgICAqIEByZXR1cm5zIHtWaWV3ZXJ9IFRoZSB2aWV3ZXIgY2xhc3MuXG4gICAgICAgKi9cblxuICAgIH1dLCBbe1xuICAgICAga2V5OiBcIm5vQ29uZmxpY3RcIixcbiAgICAgIHZhbHVlOiBmdW5jdGlvbiBub0NvbmZsaWN0KCkge1xuICAgICAgICB3aW5kb3cuVmlld2VyID0gQW5vdGhlclZpZXdlcjtcbiAgICAgICAgcmV0dXJuIFZpZXdlcjtcbiAgICAgIH1cbiAgICAgIC8qKlxuICAgICAgICogQ2hhbmdlIHRoZSBkZWZhdWx0IG9wdGlvbnMuXG4gICAgICAgKiBAcGFyYW0ge09iamVjdH0gb3B0aW9ucyAtIFRoZSBuZXcgZGVmYXVsdCBvcHRpb25zLlxuICAgICAgICovXG5cbiAgICB9LCB7XG4gICAgICBrZXk6IFwic2V0RGVmYXVsdHNcIixcbiAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZXREZWZhdWx0cyhvcHRpb25zKSB7XG4gICAgICAgIGFzc2lnbihERUZBVUxUUywgaXNQbGFpbk9iamVjdChvcHRpb25zKSAmJiBvcHRpb25zKTtcbiAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gVmlld2VyO1xuICB9KCk7XG5cbiAgYXNzaWduKFZpZXdlci5wcm90b3R5cGUsIHJlbmRlciwgZXZlbnRzLCBoYW5kbGVycywgbWV0aG9kcywgb3RoZXJzKTtcblxuICByZXR1cm4gVmlld2VyO1xuXG59KSkpO1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/viewerjs/dist/viewer.js\n");

/***/ })

}]);